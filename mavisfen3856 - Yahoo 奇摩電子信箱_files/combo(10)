/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-skin",function(e,t){var n="boundingBox",r="contentBox",i="skin",s=e.ClassNameManager.getClassName;e.Widget.prototype.getSkinName=function(e){var t=this.get(r)||this.get(n),o,u;return e=e||s(i,""),u=new RegExp("\\b"+e+"(\\S+)"),t&&t.ancestor(function(e){return o=e.get("className").match(u),o}),o?o[1]:null}},"3.16.0",{requires:["widget-base"]});
/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-uievents",function(e,t){var n="boundingBox",r=e.Widget,i="render",s=e.Lang,o=":",u=e.Widget._uievts=e.Widget._uievts||{};e.mix(r.prototype,{_destroyUIEvents:function(){var t=e.stamp(this,!0);e.each(u,function(n,r){n.instances[t]&&(delete n.instances[t],e.Object.isEmpty(n.instances)&&(n.handle.detach(),u[r]&&delete u[r]))})},UI_EVENTS:e.Node.DOM_EVENTS,_getUIEventNode:function(){return this.get(n)},_createUIEvent:function(t){var n=this._getUIEventNode(),i=e.stamp(n)+t,s=u[i],o;s||(o=n.delegate(t,function(e){var t=r.getByNode(this);t&&t._filterUIEvent(e)&&t.fire(e.type,{domEvent:e})},"."+e.Widget.getClassName()),u[i]=s={instances:{},handle:o}),s.instances[e.stamp(this)]=1},_filterUIEvent:function(e){return e.currentTarget.compareTo(e.container)||e.container.compareTo(this._getUIEventNode())},_getUIEvent:function(e){if(s.isString(e)){var t=this.parseType(e)[1],n,r;return t&&(n=t.indexOf(o),n>-1&&(t=t.substring(n+o.length)),this.UI_EVENTS[t]&&(r=t)),r}},_initUIEvent:function(e){var t=this._getUIEvent(e),n=this._uiEvtsInitQueue||{};t&&!n[t]&&(this._uiEvtsInitQueue=n[t]=1,this.after(i,function(){this._createUIEvent(t),delete this._uiEvtsInitQueue[t]}))},on:function(e){return this._initUIEvent(e),r.superclass.on.apply(this,arguments)},publish:function(e,t){var n=this._getUIEvent(e);return n&&t&&t.defaultFn&&this._initUIEvent(n),r.superclass.publish.apply(this,arguments)}},!0)},"3.16.0",{requires:["node-event-delegate","widget-base"]});
/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-stdmod",function(e,t){function H(e){}var n=e.Lang,r=e.Node,i=e.UA,s=e.Widget,o="",u="hd",a="bd",f="ft",l="header",c="body",h="footer",p="fillHeight",d="stdmod",v="Node",m="Content",g="firstChild",y="childNodes",b="ownerDocument",w="contentBox",E="height",S="offsetHeight",x="auto",T="headerContentChange",N="bodyContentChange",C="footerContentChange",k="fillHeightChange",L="heightChange",A="contentUpdate",O="renderUI",M="bindUI",_="syncUI",D="_applyParsedConfig",P=e.Widget.UI_SRC;H.HEADER=l,H.BODY=c,H.FOOTER=h,H.AFTER="after",H.BEFORE="before",H.REPLACE="replace";var B=H.HEADER,j=H.BODY,F=H.FOOTER,I=B+m,q=F+m,R=j+m;H.ATTRS={headerContent:{value:null},footerContent:{value:null},bodyContent:{value:null},fillHeight:{value:H.BODY,validator:function(e){return this._validateFillHeight(e)}}},H.HTML_PARSER={headerContent:function(e){return this._parseStdModHTML(B)},bodyContent:function(e){return this._parseStdModHTML(j)},footerContent:function(e){return this._parseStdModHTML(F)}},H.SECTION_CLASS_NAMES={header:s.getClassName(u),body:s.getClassName(a),footer:s.getClassName(f)},H.TEMPLATES={header:'<div class="'+H.SECTION_CLASS_NAMES[B]+'"></div>',body:'<div class="'+H.SECTION_CLASS_NAMES[j]+'"></div>',footer:'<div class="'+H.SECTION_CLASS_NAMES[F]+'"></div>'},H.prototype={initializer:function(){this._stdModNode=this.get(w),e.before(this._renderUIStdMod,this,O),e.before(this._bindUIStdMod,this,M),e.before(this._syncUIStdMod,this,_)},_syncUIStdMod:function(){var e=this._stdModParsed;(!e||!e[I])&&this._uiSetStdMod(B,this.get(I)),(!e||!e[R])&&this._uiSetStdMod(j,this.get(R)),(!e||!e[q])&&this._uiSetStdMod(F,this.get(q)),this._uiSetFillHeight(this.get(p))},_renderUIStdMod:function(){this._stdModNode.addClass(s.getClassName(d)),this._renderStdModSections(),this.after(T,this._afterHeaderChange),this.after(N,this._afterBodyChange),this.after(C,this._afterFooterChange)},_renderStdModSections:function(){n.isValue(this.get(I))&&this._renderStdMod(B),n.isValue(this.get(R))&&this._renderStdMod(j),n.isValue(this.get(q))&&this._renderStdMod(F)},_bindUIStdMod:function(){this.after(k,this._afterFillHeightChange),this.after(L,this._fillHeight),this.after(A,this._fillHeight)},_afterHeaderChange:function(e){e.src!==P&&this._uiSetStdMod(B,e.newVal,e.stdModPosition)},_afterBodyChange:function(e){e.src!==P&&this._uiSetStdMod(j,e.newVal,e.stdModPosition)},_afterFooterChange:function(e){e.src!==P&&this._uiSetStdMod(F,e.newVal,e.stdModPosition)},_afterFillHeightChange:function(e){this._uiSetFillHeight(e.newVal)},_validateFillHeight:function(e){return!e||e==H.BODY||e==H.HEADER||e==H.FOOTER},_uiSetFillHeight:function(e){var t=this.getStdModNode(e),n=this._currFillNode;n&&t!==n&&n.setStyle(E,o),t&&(this._currFillNode=t),this._fillHeight()},_fillHeight:function(){if(this.get(p)){var e=this.get(E);e!=o&&e!=x&&this.fillHeight(this.getStdModNode(this.get(p)))}},_uiSetStdMod:function(e,t,r){if(n.isValue(t)){var i=this.getStdModNode(e,!0);this._addStdModContent(i,t,r),this.set(e+m,this._getStdModContent(e),{src:P})}else this._eraseStdMod(e);this.fire(A)},_renderStdMod:function(e){var t=this.get(w),n=this._findStdModSection(e);return n||(n=this._getStdModTemplate(e)),this._insertStdModSection(t,e,n),this[e+v]=n,this[e+v]},_eraseStdMod:function(e){var t=this.getStdModNode(e);t&&(t.remove(!0),delete this[e+v])},_insertStdModSection:function(e,t,n){var r=e.get(g);if(t===F||!r)e.appendChild(n);else if(t===B)e.insertBefore(n,r);else{var i=this[F+v];i?e.insertBefore(n,i):e.appendChild(n)}},_getStdModTemplate:function(e){return r.create(H.TEMPLATES[e],this._stdModNode.get(b))},_addStdModContent:function(e,t,n){switch(n){case H.BEFORE:n=0;break;case H.AFTER:n=undefined;break;default:n=H.REPLACE}e.insert(t,n)},_getPreciseHeight:function(e){var t=e?e.get(S):0,n="getBoundingClientRect";if(e&&e.hasMethod(n)){var r=e.invoke(n);r&&(t=r.bottom-r.top)}return t},_findStdModSection:function(e){return this.get(w).one("> ."+H.SECTION_CLASS_NAMES[e])},_parseStdModHTML:function(t){var n=this._findStdModSection(t);return n?(this._stdModParsed||(this._stdModParsed={},e.before(this._applyStdModParsedConfig,this,D)),this._stdModParsed[t+m]=1,n.get("innerHTML")):null},_applyStdModParsedConfig:function(e,t,n){var r=this._stdModParsed;r&&(r[I]=!(I in t)&&I in r,r[R]=!(R in t)&&R in r,r[q]=!(q in t)&&q in r)},_getStdModContent:function(e){return this[e+v]?this[e+v].get(y):null},setStdModContent:function(e,t,n){this.set(e+m,t,{stdModPosition:n})},getStdModNode:function(e,t){var n=this[e+v]||null;return!n&&t&&(n=this._renderStdMod(e)),n},fillHeight:function(e){if(e){var t=this.get(w),r=[this.headerNode,this.bodyNode,this.footerNode],s,o,u=0,a=0,f=!1;for(var l=0,c=r.length;l<c;l++)s=r[l],s&&(s!==e?u+=this._getPreciseHeight(s):f=!0);f&&((i.ie||i.opera)&&e.set(S,0),o=t.get(S)-parseInt(t.getComputedStyle("paddingTop"),10)-parseInt(t.getComputedStyle("paddingBottom"),10)-parseInt(t.getComputedStyle("borderBottomWidth"),10)-parseInt(t.getComputedStyle("borderTopWidth"),10),n.isNumber(o)&&(a=o-u,a>=0&&e.set(S,a)))}}},e.WidgetStdMod=H},"3.16.0",{requires:["base-build","widget"]});
/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-position",function(e,t){function d(e){}var n=e.Lang,r=e.Widget,i="xy",s="position",o="positioned",u="boundingBox",a="relative",f="renderUI",l="bindUI",c="syncUI",h=r.UI_SRC,p="xyChange";d.ATTRS={x:{setter:function(e){this._setX(e)},getter:function(){return this._getX()},lazyAdd:!1},y:{setter:function(e){this._setY(e)},getter:function(){return this._getY()},lazyAdd:!1},xy:{value:[0,0],validator:function(e){return this._validateXY(e)}}},d.POSITIONED_CLASS_NAME=r.getClassName(o),d.prototype={initializer:function(){this._posNode=this.get(u),e.after(this._renderUIPosition,this,f),e.after(this._syncUIPosition,this,c),e.after(this._bindUIPosition,this,l)},_renderUIPosition:function(){this._posNode.addClass(d.POSITIONED_CLASS_NAME)},_syncUIPosition:function(){var e=this._posNode;e.getStyle(s)===a&&this.syncXY(),this._uiSetXY(this.get(i))},_bindUIPosition:function(){this.after(p,this._afterXYChange)},move:function(){var e=arguments,t=n.isArray(e[0])?e[0]:[e[0],e[1]];this.set(i,t)},syncXY:function(){this.set(i,this._posNode.getXY(),{src:h})},_validateXY:function(e){return n.isArray(e)&&n.isNumber(e[0])&&n.isNumber(e[1])},_setX:function(e){this.set(i,[e,this.get(i)[1]])},_setY:function(e){this.set(i,[this.get(i)[0],e])},_getX:function(){return this.get(i)[0]},_getY:function(){return this.get(i)[1]},_afterXYChange:function(e){e.src!=h&&this._uiSetXY(e.newVal)},_uiSetXY:function(e){this._posNode.setXY(e)}},e.WidgetPosition=d},"3.16.0",{requires:["base-build","node-screen","widget"]});
/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-position-align",function(e,t){function c(e){}var n=e.Lang,r="align",i="alignOn",s="visible",o="boundingBox",u="offsetWidth",a="offsetHeight",f="region",l="viewportRegion";c.ATTRS={align:{value:null},centered:{setter:"_setAlignCenter",lazyAdd:!1,value:!1},alignOn:{value:[],validator:e.Lang.isArray}},c.TL="tl",c.TR="tr",c.BL="bl",c.BR="br",c.TC="tc",c.RC="rc",c.BC="bc",c.LC="lc",c.CC="cc",c.prototype={initializer:function(){this._posNode||e.error("WidgetPosition needs to be added to the Widget, before WidgetPositionAlign is added"),e.after(this._bindUIPosAlign,this,"bindUI"),e.after(this._syncUIPosAlign,this,"syncUI")},_posAlignUIHandles:null,destructor:function(){this._detachPosAlignUIHandles()},_bindUIPosAlign:function(){this.after("alignChange",this._afterAlignChange),this.after("alignOnChange",this._afterAlignOnChange),this.after("visibleChange",this._syncUIPosAlign)},_syncUIPosAlign:function(){var e=this.get(r);this._uiSetVisiblePosAlign(this.get(s)),e&&this._uiSetAlign(e.node,e.points)},align:function(e,t){return arguments.length?this.set(r,{node:e,points:t}):this._syncUIPosAlign(),this},centered:function(e){return this.align(e,[c.CC,c.CC])},_setAlignCenter:function(e){return e&&this.set(r,{node:e===!0?null:e,points:[c.CC,c.CC]}),e},_uiSetAlign:function(t,r){if(!n.isArray(r)||r.length!==2){e.error("align: Invalid Points Arguments");return}var i=this._getRegion(t),s,o,u;if(!i)return;s=r[0],o=r[1];switch(o){case c.TL:u=[i.left,i.top];break;case c.TR:u=[i.right,i.top];break;case c.BL:u=[i.left,i.bottom];break;case c.BR:u=[i.right,i.bottom];break;case c.TC:u=[i.left+Math.floor(i.width/2),i.top];break;case c.BC:u=[i.left+Math.floor(i.width/2),i.bottom];break;case c.LC:u=[i.left,i.top+Math.floor(i.height/2)];break;case c.RC:u=[i.right,i.top+Math.floor(i.height/2)];break;case c.CC:u=[i.left+Math.floor(i.width/2),i.top+Math.floor(i.height/2)];break;default:}u&&this._doAlign(s,u[0],u[1])},_uiSetVisiblePosAlign:function(e){e?this._attachPosAlignUIHandles():this._detachPosAlignUIHandles()},_attachPosAlignUIHandles:function(){if(this._posAlignUIHandles)return;var t=this.get(o),n=e.bind(this._syncUIPosAlign,this),r=[];e.Array.each(this.get(i),function(i){var s=i.eventName,o=e.one(i.node)||t;s&&r.push(o.on(s,n))}),this._posAlignUIHandles=r},_detachPosAlignUIHandles:function(){var t=this._posAlignUIHandles;t&&((new e.EventHandle(t)).detach(),this._posAlignUIHandles=null)},_doAlign:function(e,t,n){var r=this._posNode,i;switch(e){case c.TL:i=[t,n];break;case c.TR:i=[t-r.get(u),n];break;case c.BL:i=[t,n-r.get(a)];break;case c.BR:i=[t-r.get(u),n-r.get(a)];break;case c.TC:i=[t-r.get(u)/2,n];break;case c.BC:i=[t-r.get(u)/2,n-r.get(a)];break;case c.LC:i=[t,n-r.get(a)/2];break;case c.RC:i=[t-r.get(u),n-r.get(a)/2];break;case c.CC:i=[t-r.get(u)/2,n-r.get(a)/2];break;default:}i&&this.move(i)},_getRegion:function(t){var n;return t?(t=e.Node.one(t),t&&(n=t.get(f))):n=this._posNode.get(l),n},_afterAlignChange:function(e){var t=e.newVal;t&&this._uiSetAlign(t.node,t.points)},_afterAlignOnChange:function(e){this._detachPosAlignUIHandles(),this.get(s)&&this._attachPosAlignUIHandles()}},e.WidgetPositionAlign=c},"3.16.0",{requires:["widget-position"]});
/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-stack",function(e,t){function O(e){}var n=e.Lang,r=e.UA,i=e.Node,s=e.Widget,o="zIndex",u="shim",a="visible",f="boundingBox",l="renderUI",c="bindUI",h="syncUI",p="offsetWidth",d="offsetHeight",v="parentNode",m="firstChild",g="ownerDocument",y="width",b="height",w="px",E="shimdeferred",S="shimresize",x="visibleChange",T="widthChange",N="heightChange",C="shimChange",k="zIndexChange",L="contentUpdate",A="stacked";O.ATTRS={shim:{value:r.ie==6},zIndex:{value:0,setter:"_setZIndex"}},O.HTML_PARSER={zIndex:function(e){return this._parseZIndex(e)}},O.SHIM_CLASS_NAME=s.getClassName(u),O.STACKED_CLASS_NAME=s.getClassName(A),O.SHIM_TEMPLATE='<iframe class="'+O.SHIM_CLASS_NAME+'" frameborder="0" title="Widget Stacking Shim" src="javascript:false" tabindex="-1" role="presentation"></iframe>',O.prototype={initializer:function(){this._stackNode=this.get(f),this._stackHandles={},e.after(this._renderUIStack,this,l),e.after(this._syncUIStack,this,h),e.after(this._bindUIStack,this,c)},_syncUIStack:function(){this._uiSetShim(this.get(u)),this._uiSetZIndex(this.get(o))},_bindUIStack:function(){this.after(C,this._afterShimChange),this.after(k,this._afterZIndexChange)},_renderUIStack:function(){this._stackNode.addClass(O.STACKED_CLASS_NAME)},_parseZIndex:function(e){var t;return!e.inDoc()||e.getStyle("position")==="static"?t="auto":t=e.getComputedStyle("zIndex"),t==="auto"?null:t},_setZIndex:function(e){return n.isString(e)&&(e=parseInt(e,10)),n.isNumber(e)||(e=0),e},_afterShimChange:function(e){this._uiSetShim(e.newVal)},_afterZIndexChange:function(e){this._uiSetZIndex(e.newVal)},_uiSetZIndex:function(e){this._stackNode.setStyle(o,e)},_uiSetShim:function(e){e?(this.get(a)?this._renderShim():this._renderShimDeferred(),r.ie==6&&this._addShimResizeHandlers()):this._destroyShim()},_renderShimDeferred:function(){this._stackHandles[E]=this._stackHandles[E]||[];var e=this._stackHandles[E],t=function(e){e.newVal&&this._renderShim()};e.push(this.on(x,t))},_addShimResizeHandlers:function(){this._stackHandles[S]=this._stackHandles[S]||[];var e=this.sizeShim,t=this._stackHandles[S];t.push(this.after(x,e)),t.push(this.after(T,e)),t.push(this.after(N,e)),t.push(this.after(L,e))},_detachStackHandles:function(e){var t=this._stackHandles[e],n;if(t&&t.length>0)while(n=t.pop())n.detach()},_renderShim:function(){var e=this._shimNode,t=this._stackNode;e||(e=this._shimNode=this._getShimTemplate(),t.insertBefore(e,t.get(m)),this._detachStackHandles(E),this.sizeShim())},_destroyShim:function(){this._shimNode&&(this._shimNode.get(v).removeChild(this._shimNode),this._shimNode=null,this._detachStackHandles(E),this._detachStackHandles(S))},sizeShim:function(){var e=this._shimNode,t=this._stackNode;e&&r.ie===6&&this.get(a)&&(e.setStyle(y,t.get(p)+w),e.setStyle(b,t.get(d)+w))},_getShimTemplate:function(){return i.create(O.SHIM_TEMPLATE,this._stackNode.get(g))}},e.WidgetStack=O},"3.16.0",{requires:["base-build","widget"],skinnable:!0});
/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("widget-position-constrain",function(e,t){function m(e){}var n="constrain",r="constrain|xyChange",i="constrainChange",s="preventOverlap",o="align",u="",a="bindUI",f="xy",l="x",c="y",h=e.Node,p="viewportRegion",d="region",v;m.ATTRS={constrain:{value:null,setter:"_setConstrain"},preventOverlap:{value:!1}},v=m._PREVENT_OVERLAP={x:{tltr:1,blbr:1,brbl:1,trtl:1},y:{trbr:1,tlbl:1,bltl:1,brtr:1}},m.prototype={initializer:function(){this._posNode||e.error("WidgetPosition needs to be added to the Widget, before WidgetPositionConstrain is added"),e.after(this._bindUIPosConstrained,this,a)},getConstrainedXY:function(e,t){t=t||this.get(n);var r=this._getRegion(t===!0?null:t),i=this._posNode.get(d);return[this._constrain(e[0],l,i,r),this._constrain(e[1],c,i,r)]},constrain:function(e,t){var r,i,s=t||this.get(n);s&&(r=e||this.get(f),i=this.getConstrainedXY(r,s),(i[0]!==r[0]||i[1]!==r[1])&&this.set(f,i,{constrained:!0}))},_setConstrain:function(e){return e===!0?e:h.one(e)},_constrain:function(e,t,n,r){if(r){this.get(s)&&(e=this._preventOverlap(e,t,n,r));var i=t==l,o=i?r.width:r.height,u=i?n.width:n.height,a=i?r.left:r.top,f=i?r.right-u:r.bottom-u;if(e<a||e>f)u<o?e<a?e=a:e>f&&(e=f):e=a}return e},_preventOverlap:function(e,t,n,r){var i=this.get(o),s=t===l,a,f,c,h,p,d;return i&&i.points&&v[t][i.points.join(u)]&&(f=this._getRegion(i.node),f&&(a=s?n.width:n.height,c=s?f.left:f.top,h=s?f.right:f.bottom,p=s?f.left-r.left:f.top-r.top,d=s?r.right-f.right:r.bottom-f.bottom),e>c?d<a&&p>a&&(e=c-a):p<a&&d>a&&(e=h)),e},_bindUIPosConstrained:function(){this.after(i,this._afterConstrainChange),this._enableConstraints(this.get(n))},_afterConstrainChange:function(e){this._enableConstraints(e.newVal)},_enableConstraints:function(e){e?(this.constrain(),this._cxyHandle=this._cxyHandle||this.on(r,this._constrainOnXYChange)):this._cxyHandle&&(this._cxyHandle.detach(),this._cxyHandle=null)},_constrainOnXYChange:function(e){e.constrained||(e.newVal=this.getConstrainedXY(e.newVal))},_getRegion:function(e){var t;return e?(e=h.one(e),e&&(t=e.get(d))):t=this._posNode.get(p),t}},e.WidgetPositionConstrain=m},"3.16.0",{requires:["widget-position"]});
/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("overlay",function(e,t){e.Overlay=e.Base.create("overlay",e.Widget,[e.WidgetStdMod,e.WidgetPosition,e.WidgetStack,e.WidgetPositionAlign,e.WidgetPositionConstrain])},"3.16.0",{requires:["widget","widget-stdmod","widget-position","widget-position-align","widget-stack","widget-position-constrain"],skinnable:!0});
YUI.add("comms-ui-autocomplete-plugin",function(C){var B="autocomplete",F=C.Lang,G=C.Array.each,L=C.Plugin,E=L.Base,I="ac",D=13;function J(O,Q){var N="down",P=C.stamp(this)+"|";if(C.UA.gecko>0&&C.UA.gecko<5){N="press";C.on(P+"key",O.raiseFlag,Q,"down",O);}C.on(P+"valueChange",H,Q,O);C.on(P+"key",O.next,Q,N+":40",O);C.on(P+"key",O.previous,Q,N+":38",O);C.on(P+"key",O.close,Q,"down:27",O);Q.on("keyup",function(R){if(R.keyCode===D){R.type="select";this.select.call(O,R);}},O,"select");}function H(O){var N=O.newVal;if(!N&&!(N===""&&this.get("minQueryLength")===0)){this._cachedValue=false;return this.close();}if(N===this._cachedValue||N.length<this.get("minQueryLength")){return false;}this._cachedValue=N;this.fire("ac:query",{value:O.newVal});return true;}function A(N){return function(){if(N){N.setAttribute(B,"on");}N=null;};}function K(N){var P=C.Node.getDOMNode(N),Q=P.getAttribute(B);if((Q&&Q!=="off")||Q===null||Q===undefined){var O=A(P);C.on("beforeunload",O,window);C.on("unload",O,window);}P.setAttribute(B,"off");}function M(){M.superclass.constructor.apply(this,arguments);}C.extend(M,E,{_defaultEventFn:null,initializer:function(){var N=this,O=N.get("host"),P=(!F.isNull(N._defaultEventFn)?N._defaultEventFn:{});J(N,O);G(["query","load","show","hide","next","previous","select"],function(Q){N.publish("ac:"+Q,{broadcast:1,bubbles:1,context:N,preventable:true,prefix:I,defaultFn:P[Q]||null});},N);K(O);},destructor:function(){var N=this;C.detach(C.stamp(N)+"|");N.detachAll();},open:function(){this.fire("ac:show");},next:function(N){if(this.conflictingKeyFlag&&C.UA.gecko){return;}N.preventDefault();this.fire("ac:next");},previous:function(N){if(this.conflictingKeyFlag&&C.UA.gecko){return;}N.preventDefault();this.fire("ac:previous");},raiseFlag:function(O,N){if((O.keyCode===55)||(O.keyCode===57)){N.conflictingKeyFlag=true;}else{N.conflictingKeyFlag=false;}},select:function(N){this.fire("ac:select",N);},hide:function(){},close:function(){this.fire("ac:hide");},reload:function(N){if(N){if(N.length<1){this.set("badResult",this.get("queryValue"));}this.fire("ac:load",{results:N,query:this.get("queryValue")});}}},{NAME:"ACPlugin",NS:I,ATTRS:{queryValue:{getter:function(){return this.get("host").get("value");},setter:function(N){this.get("host").set("value",N);this._cachedValue=N;return this._cachedValue;}},dataSource:{value:[]},minQueryLength:{value:0,validator:F.isNumber},queryTemplate:{value:encodeURIComponent,setter:function(N){return(F.isFunction(N)?N:function(O){return N.replace(/(^|[^\\])((\\{2})*)\{query\}/,"$1$2"+encodeURIComponent(O)).replace(/(^|[^\\])((\\{2})*)\\(\{query\})/,"$1$2$4");});}},alignNode:null,conflictingKeyFlag:false,badResult:{value:false,setter:function(N){return(C.Lang.isString(N))?N:false;}}}});C.namespace("comms.ui");C.comms.ui.AutoCompleteEventsPlugin=M;},"1.0.0",{requires:["node","plugin","event-valuechange","event-key"]});YUI.add("comms-ui-autocomplete",function(C){var H=C.Array.each,F=C.Lang,B=C.Overlay,G="selectedIndex",A="queryValue",J="ac",D="_BOUND",I="_"+G,K="_originalValue";function E(){E.superclass.constructor.apply(this,arguments);this.delegated=false;this.listeners=[];}C.extend(E,B,{initializer:function(){var L=this;L.after({queryChanged:L.drawMarkUp,dataChanged:L.drawMarkUp});L.hide();L.publish(J+":complete",{broadcast:1,bubbles:1,context:L,preventable:true,prefix:J});},renderUI:function(){var M=this.get("ac"),L={"display":"none","overflow":"auto","maxHeight":"300px"};if(!M){return false;}this.get("contentBox").setStyles(L);this.get("contentBox").set("role","listbox");this.setSize();this.set("align",{node:this.get("ac").get("alignNode"),points:[C.WidgetPositionAlign.TL,C.WidgetPositionAlign.BL]});this.get("contentBox").setStyle("display","block");return true;},bind:function(P){var Q=this,L=Q.get("contentBox"),O=Q.get("ac"),N=C.stamp(Q)+"|";if(P&&O!==P&&Q[D]){C.detach(N);Q[D]=0;}P=P||O;if(P&&!Q[D]){var M=[];Q[D]=1;if(!Q.delegated){Q.delegated=true;M.push(L.delegate("click",Q.click,"li",Q));M.push(L.delegate("mouseover",Q.mouseover,"li",Q));M.push(L.delegate("mouseout",Q.mouseout,"li",Q));M.push(L.delegate("mousemove",function(R){R.halt();R.currentTarget.addClass("over");},"li",Q));M.push(L.delegate("mouseleave",function(R){R.halt();R.currentTarget.removeClass("over");},"li",Q));M.push(C.on("click",function(R){if(!Q.isVisible()){return;}if(Q.get("contentBox").contains(R.target)){if(R.target.get("nodeName").toLowerCase()!=="li"){return;}Q.get("ac").get("host").simulate("keydown",{keyCode:13});}if(Q.get("ac").get("host").contains(R.target)){return;}Q.hide();},document,this));}M.push(P.on(N+J+":load",function(R){if(!Q.get("disabled")){Q.setAttrs({query:R.query,data:R.results}).drawMarkUp().show().setAlign();}}));M.push(P.on(N+J+":query",function(R){Q.set("query",R.value).drawMarkUp();}));M.push(P.on(N+J+":next",Q.next,Q));M.push(P.on(N+J+":previous",Q.previous,Q));M.push(P.on(N+J+":hide",Q.hide,Q));P.select=function(R){Q.selected.call(Q,R,"enter");};Q.listeners=M;}return Q;},bindUI:function(L){return this.bind(L);},setSize:function(){if(!this.get("expandWidthToContents")){this.set("width",this.get("ac").get("alignNode").get("offsetWidth"));}},setAlign:function(){var O=this,M=O.get("ac").get("alignNode"),L=M.get("region"),N=[L.left,L.bottom];O.set("xy",N);return O;},drawMarkUp:function(){var L=this,M=L.get("data");if(!M){return L;}L[I]=-1;L[K]="";L.get("contentBox").set("innerHTML",L.getListMarkup(M));if(M.length>0){if(L.get("selectFirst")){this.set(G,0);}L.get("contentBox").setStyle("display","block");}else{L.get("contentBox").setStyle("display","none");}return L;},getListMarkup:function(O){var N=this,L=N.get("listTpl"),M=[];H(O,function(P){M.push(N.getItemMarkup(P));});return L.replace(/\{list\}/g,M.join(""));},getItemMarkup:function(M){var L=this;if(!F.isString(M)){return false;}return L.get("itemTpl").replace(/\{hilite\}/g,M);},_fixView:function(O){var R=this,N=R.get(G),L=R.get("contentBox"),Q,M,P;if(N===-1){L.set("scrollTop",0);return true;}M=R.item(N);Q=L.get("scrollTop");M=R.item(N);P=M.get("offsetTop");M.addClass("key-select");if(O){if((P>Q)&&(R.itemsCount()!==(N+1))){return true;}L.set("scrollTop",P);document.body.scrollIntoView();return false;}else{if((P+M.get("clientHeight"))>(Q+L.get("clientHeight"))){L.set("scrollTop",L.get("scrollTop")+M.get("clientHeight"));if(C.UA.ie<=0){M.scrollIntoView();}document.body.scrollIntoView(false);}return true;}},next:function(){var L=this;if(L.get("selectFirst")&&L.itemsCount()===1){return false;}return(L.get("visible")?L.selectNext():L);},selectNext:function(){var L=this;L.set(G,this.get(G)+1);L._fixView(false);return L.get(G);},selectPrevious:function(){var L=this;L.set(G,this.get(G)-1);L._fixView(true);return L.get(G);},previous:function(){var L=this;if(L.itemsCount()===1){return false;}return L.get("visible")?L.selectPrevious():L;},isVisible:function(){return this.get("visible");},hasSelectedItem:function(){return this.get("selectedIndex")>-1;},item:function(L){return this.get("contentBox").all(this.get("itemSelector")).item(L);},itemsCount:function(){return this.get("contentBox").all(this.get("allItemsSelector")).size();},click:function(L){this.selected(L,"click");},mouseover:function(O){var M,L,N=this;M=O.currentTarget;L=N.get("contentBox").all("li").indexOf(M);N.set("selectedIndex",L);},mouseout:function(){this.set("selectedIndex",-1);},autoManageSelect:function(L){var M=this,N=M.get("ac");if(!L){L=false;}if(L){N.on(J+":select",M.handleEnter,M);}else{N.detachAll(J+":select");}},handleEnter:function(P,M){if(!M){M=this;}var O=M.get("ac"),L=M[I],N,Q;P.halt();M.fire(J+":complete",M);if(L!==-1){N=M.item(L);if(N){Q=N.get("text");O.set(A,Q);}M[I]=-1;O.get("host").focus();M.hide();}},selected:function(R,P){var M=null,N=this,Q=N.get("ac"),L,O;if(!P){P="click";}M=N.item(this.get(G));if(!M){return false;}O=M.getData("selectedCb");if(O){O.call(M,R);return;}L=this.get(G);R.selectedItem=M;R.selectedIndex=L;R.type=P;R.container=N.get("contentBox");Q.fire("ac:select",R);N[I]=-1;return true;},setHostValue:function(M){var L=this;L.get("ac").set(A,M);L.get("ac").get("host").focus();L.hide();},reload:function(L){return this.get("ac").reload(L);},close:function(){var L=this;L.get("ac").close();L.hide();},destroy:function(){var M=this.listeners;if(M){var N=M.length,L;for(L=0;L<N;L++){if(M[L]){M[L].detach();M[L]=null;}}this.listeners=null;}if(this.get("ac")){this.get("ac").destructor();}E.superclass.destroy.apply(this,arguments);}},{NAME:"AutoCompleteWidget",ATTRS:{ac:{setter:function(L){if(!this[D]){return;}this.bind(L);},validator:function(){return true;}},data:{},query:{value:""},listTpl:{value:'<ul role="presentation">{list}</ul>'},itemTpl:{value:'<li role="option">{hilite}</li>'},itemSelector:{value:"ul li"},allItemsSelector:{value:"ul li"},selectedItem:{getter:function(){return this.item(this.get(G));},readOnly:true},expandWidthToContents:{value:false},selectFirst:{value:true}}});
E.ATTRS[G]={value:-1,validator:function(L){var M=this.get("data");return M&&C.Lang.isNumber(L);},getter:function(){return this[I];},setter:function(O){var T=this,Q=T.get(G),R=T.get("data"),L=T.itemsCount(),S=T.get("ac"),M=this.getClassName("selected"),P,N;if(isNaN(Q)){Q=-1;}if(!R||!L){return false;}while(O<-1){O+=L+1;}O=(O+1)%(L+1)-1;Q=(Q+1)%(L+1)-1;T[I]=O;if(Q===-1){T[K]=S.get(A);}if(Q===O){return false;}var U=T.get("contentBox").one("."+M);if(U){U.removeClass(M).removeClass("key-select");}if(O===-1){}else{P=T.item(O);if(P&&P.hasClass("corpmail.label")){N=O+(Q<O?1:-1);T[I]=N;P=T.item(N);}if(P){P.addClass(M);}}return O;}};C.namespace("comms.ui");C.comms.ui.AutoComplete=E;},"1.0.0",{requires:["overlay","comms-ui-autocomplete-plugin","node-event-simulate"]});YUI.add("comms-intl-bidihighlight",function(A){A.mix(A.namespace("comms.Intl"),{_needPrevChar:/[\u0620\u0622-\u063F\u0641-\u064A\u066E\u066F\u0671-\u0673\u0675-\u06D3\u06D5\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u077F\u07CA-\u07EA]/,_needNextChar:/[\u0620\u0626\u0628\u062A-\u062E\u0633-\u063F\u0641-\u0647\u0649\u064A\u066E\u066F\u0678-\u0687\u069A-\u06BF\u06C1\u06C2\u06CC\u06CE\u06D0\u06D1\u06FA-\u06FC\u06FF\u0712-\u0714\u071A-\u071D\u071F-\u0727\u0729\u072B\u072D\u072E\u074E-\u0758\u075C-\u076A\u076D-\u0770\u0772\u0775-\u0777\u077A-\u077F\u07CA-\u07EA]/,_highlightJoiner:"\u200d",_highlightStartTag:"<b>",_highlightEndTag:"</b>",_initializeBidiHighlightJoiner:function(){},highlightString:function(I,J,G){var K,F,M,D,B,L,C,E,H;E=function(N){return N===""?"":N.charAt(N.length-1);};H=function(N){return N===""?"":N.charAt(0);};if(I.length===0){return"";}L=E(J);C=H(G);K=I.charAt(0);M=I.charAt(I.length-1);F=K.charCodeAt(0);D=M.charCodeAt(0);if(L===""||L.charCodeAt(0)<1568||F<1568){B=this._highlightStartTag+I;}else{if(this._needNextChar.test(L)&&this._needPrevChar.test(K)){B=this._highlightJoiner+this._highlightStartTag+this._highlightJoiner+I;}else{B=this._highlightStartTag+I;}}if(C===""||C.charCodeAt(0)<1568||D<1568){B=B+this._highlightEndTag;}else{if(this._needPrevChar.test(C)&&this._needNextChar.test(M)){B=B+this._highlightJoiner+this._highlightEndTag+this._highlightJoiner;}else{B=B+this._highlightEndTag;}}return B;}});A.comms.Intl._initializeBidiHighlightJoiner();},"1.0.0");YUI.add("contacts-smartcontacts-api",function(B){var A={deleteSmartContacts:function(H,G,F){G=G||NeoConfig.socdirProxyPath;F=F||B.io;if(B.Lang.isArray(H)&&H.length>0){var D=H.length,E={ydht:{fields:{}}},C=E.ydht.fields;while(D--){C[H[D]]={"value":[0,null,-65536,1,1]};}F(G+"?/setSmartContacts?",{method:"POST",data:B.JSON.stringify(E)});}}};B.namespace("contacts.smartcontacts");B.contacts.smartcontacts.api=A;},"1.0.0",{requires:["io-base"]});YUI.add("ac-widget",function(F){var D=F.Lang,B=F.contacts,E=B.utils,G=F.comms;function A(I){var J=null,H=null;if(I&&(H=I.one(".ac-value"))){J=H.get("text");}return J;}function C(H){var I=this;H.ac=I._getEventPlugin(H);if(H.itemNodeToValue){this._nodeToValue=H.itemNodeToValue;}else{this._nodeToValue=A;}if(H.ac){C.superclass.constructor.apply(I,[H]);}}C.NAME="ACWidget";F.extend(C,G.ui.AutoComplete,{bind:function(){C.superclass.bind.apply(this,arguments);},bindUI:function(){C.superclass.bindUI.apply(this,arguments);},_getEventPlugin:function(H){var I=false,J=D.isUndefined;if(!J(H.acNode)&&!J(H.acTarget)){I=H.acTarget.plug(G.ui.AutoCompleteEventsPlugin,{alignNode:H.acNode}).ac;}return I;},refresh:function(H){var J=this,I=false;I=J._getEventPlugin(H);if(I){H.ac=I;return J.setAttrs(H);}return J;},getItemMarkup:function(H){return F.comms.FilterContactsMarkup.getItemMarkup(H);},click:function(L){var P=this,O=P.get("ac");L.halt();if(L.target.hasClass("ac-remove-item")){var J=L.target,Q=parseInt(J.getAttribute("data-ac-sc"),10),H=J.getAttribute("data-ac-id"),N=J.getAttribute("data-ac-email-field-id"),M=J.getAttribute("data-ac-email");F.fire("mt:click",{action:"ac_del",append:{ltxt:P._selectedIndex}});F.use("common-ui-dialog-helper","_shared_module_offscreen_bin_modal_btn_generic",function(V){var W=V.common.Utils.substitute(V.ui.Templates._shared_module_offscreen_bin_modal_btn_generic.base,0,0,0,{btnID:"ok",btnLabel:strings.str_delete}),S=V.common.Utils.substitute(V.ui.Templates._shared_module_offscreen_bin_modal_btn_generic.base,0,0,0,{btnID:"cancel","default":"default",btnLabel:strings.str_btn_cancel}),U={hd:strings.str_address_remove_hd,bd:V.common.Utils.substitute(Q?strings.str_sc_remove_bd:strings.str_contacts_remove_bd,{name:M}),ft:W+S},T={ok:{handler:function(){V.contacts.smartcontacts.api.deleteSmartContacts([M]);var X=new G.FilterContacts();V.contacts.api.removeEmail(H,parseInt(N,10),X.buildContactsIndex);O.set("queryValue","");U={hd:strings.str_address_removed_hd,bd:V.common.Utils.substitute(strings.str_address_removed_bd,{name:M}),ft:V.common.Utils.substitute(V.ui.Templates._shared_module_offscreen_bin_modal_btn_generic.base,0,0,0,{btnID:"ok","default":"default",btnLabel:strings.str_ok})};V.common.ui.DialogHelper.createCommon(U);}},cancel:{handler:function(){O.set("queryValue","");}}},R=function(){};V.common.ui.DialogHelper.createCommon(U,T,R);});}else{var K;F.fire("mt:click",{action:"ac_select",append:{ltxt:P._selectedIndex}});K=L.currentTarget.getData("selectedCb");if(K){K.call(L.target,L);return;}P._selectedIndex=-1;var I=this._nodeToValue(L.currentTarget);if(I!==null){O.set("queryValue",I);O.get("host").simulate("keydown",{keyCode:13});}P._currentValue=I;O.get("host").focus();}P.hide();},handleEnter:function(N,I){var L=I.get("ac"),H=I._selectedIndex,K,O;N.halt();var J=new G.FilterContacts();if(I.get("data").queryStr!==L.get("queryValue")){J.updateFilterItems(L.get("queryValue"));var M=J.filterContacts(E.getSortedFlatContacts(["firstname","lastname","email"]));I.setAttrs({query:L.get("queryValue"),data:M}).drawMarkUp().setAlign().show();}if(H!==-1){K=I.item(H);if(K){O=this._nodeToValue(K);if(O!==null){L.set("queryValue",O);I._selectedIndex=-1;L.get("host").focus();I.hide();}}}},triggerQuery:function(){this.get("ac").fire("ac:query",{value:this.get("ac").get("queryValue")});},isMousedOver:function(){var H=this.get("boundingBox"),I=H&&(H.one("div.ac-results:hover")||H.one("div.ac-results li.over")||H.one("li.yui3-aclist-item-hover"));return !!I;},buildName:F.comms.FilterContactsMarkup.buildName});C.ATTRS={host:{value:null,getter:function(){return this.get("ac").get("host");}},alignNode:{value:null,getter:function(){return this.get("ac").get("alignNode");}}};F.namespace("contacts.ui");F.contacts.ui.ACWidget=C;},"1.0.0",{requires:["overlay","node-event-simulate","comms-ui-autocomplete-plugin","comms-ui-autocomplete","contacts-api-utils","contacts-api","filter-contacts","common-utils","comms-intl-bidihighlight","contacts-smartcontacts-api"]});YUI.add("_shared_module_offscreen_bin_notification_notifications",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_notification_notifications={base:"{{addlozenge_exceededmax}}{{send_success}}{{send_error}}{{send_abuse}}{{intro}}{{spam_success}}",addlozenge_exceededmax:'<div class="nf-text">{{str_comp_addlozenge_exceededmax}} <a class="icon btn-cancel-notification" data-action="closeNotification"></a></div>',send_success:'<div class="nf-text">{{str_comp_msg_sent}} <a class="icon btn-cancel-notification" data-action="closeNotification"></a></div>',send_error:'<div class="nf-text">{{str_comp_not_sent}} <a href = "#" data-action="retry">{{str_retry}}</a> <a class="icon btn-cancel-notification" data-action="closeNotification"></a></div>',send_abuse:'<div class="nf-text">{{str_comp_send_abuse_error}} <a class="icon btn-cancel-notification" data-action="closeNotification"></a></div>',intro:'<div class="nf-text">Click <a href = "#" data-action = "view" style="padding:0">here</a> to learn more about your inbox! <a class="icon btn-cancel-notification" data-action="closeNotification"></a></div>',spam_success:'<div class="nf-text">{{str_modal_spam_investigation}} <a class="icon btn-cancel-notification" data-action="closeNotification"></a></div>'};},"1.0.0");YUI.add("mail-ui-mailcompose-base-header-conv",function(AD){var r=AD.mail,Ae=AD.Lang.trim,R=AD.Node.create,L=r.Controller.Compose,Aa=AD.common.persist.UserData,G=r.persist.MetaData,AL=AD.common.Utils,w=r.ui.PaneUtils,S=AL.substitute,AV=AL.escapeHtml,F=AL.unescapeHtml,b=strings.str_cfg_tog_unescape_ncr,Ag=AD.ui.Templates,p=Ag._shared_module_compose_message_header_fresh,AC=p&&p.compose_from_address,t=AD.contacts,c=t.utils,Ap="neo.pref.compose.showBcc",Af="neo.pref.compose.showCc",AK="hidden",AE="focus",d="compose-field-focus",Ai="offscreen",AM="restore",V="move",J="reply_all",AO="reply_sender",Aj="forward",X={"reply_sender":strings.str_reply,"reply_all":strings.str_reply,"forward":strings.str_forward};var K=function(Y,Ar){var As=this;As.isLozengeHighlighted=false;As.allLozengesSelected=false;As.composeView=Ar;As.offscreenContent=null;As.listeners=[];K.superclass.constructor.apply(As,arguments);As.neoEvent("updateSubject",{emitFacade:true,broadcast:1});As.neoEvent("qrCancel",{emitFacade:true,broadcast:1});};function M(){var Ax={},Ay=(Aa.get("externalAccounts")||{}).extAccount||[],Ar=(Aa.get("aliases")||{}).alias||[],Y=(Aa.get("disposableAddresses")||{}).deaName||[],Aw=Ay.concat(Ar,Y),Au=Aa.get("userSendPref"),As,At,Av=Aw.length;Ax[Au.defaultID]=1;Ax[Au.defaultFromAddress]=1;for(At=0;At<Av;At++){if((As=Aw[At].address)){Ax[As]=1;}}return Ax;}function AS(Y){var Ar=this;if(Ar.composeView.attView){Ar.composeView.attView.reposAttachObj(Y);}}function u(){if(AD.ACWidgetInst){AD.ACWidgetInst.hide();}}function B(Y){Y.removeAttribute("aria-owns");Y.removeAttribute("aria-activedescendant");}function Ah(Y){Y.removeAttribute("aria-describedby");}function U(){var Y=AD.ACWidgetInst;Y.get("ac").get("host").set("aria-owns",Y.get("contentBox").generateID());}function Ad(Y){var At=Y.ancestor("ul"),As=At.all(".lozenge-static"),Ar;if(As.size()>0){Ar=[];As.each(function(Au){Ar.push(Au.generateID());});}if(Ar){Y.set("aria-describedby",Ar.join(" "));}else{Y.removeAttribute("aria-describedby");}}function AB(Ar){var Y;Y=Ar.get("value").replace(/([^,; ]+?@[^ ,;]+?\.[a-z]+?>?)[ ;]+([^ ,;])/ig,"$1, $2");Ar.set("value",Y);}function o(As,Aw){var Ar=As.get("value"),Av=Ar.length,Au=parseInt(As.ancestor(".ac-input").getStyle("width"),10)-40,At=150,Y=17,Ax=this;if(Aw){if(Ar){AB(As);Ax._lozengeIt(As);}else{setTimeout(function(){AB(As);Ax._lozengeIt(As);},500);}}if(Av>Y){At+=(Av-Y)*10;if(At>Au){At=Au;}As.setStyle("width",At+"px");}else{As.setStyle("width","");}}function AX(Aw){var Y=false,As=null,Ar=null,Au=/(<[^<>]+@[^<>]+\.[^<>]+>)|(\([^\(\)]+@[^\(\)]+\.[^\(\)]+\))|(\[[^\[\]]+@[^\[\]]+\.[^\[\]]+\])/,Av,At=Aw.replace(/\".*\"/g,"");if(!Ae(At)||At.indexOf("@")<0){return{fail:true,email:Aw,name:Aw};}if(Au.test(Aw)){Av=Aw.match(Au);Ar=Av[0];As=Ae(Aw.replace(Ar,""));Ar=Ar.substring(1,Ar.length-1);}else{Ar=As=Ae(Aw);}if(!AD.comms.Utils.isValidEmail(Ar)){Y=true;}return{fail:Y,email:Ar,name:As};}function a(Ar){var Aw=0,At=0,As=Ar.length,Y=[],Av=false,Ax=false;for(At=0;At!==As;At++){var Au=Ar.charAt(At);switch(Au){case'"':Av=!Av;break;case"&":Ax=true;break;case";":if(Ax){Ax=false;}break;case",":if(!Av){Y.push(Ar.slice(Aw,At));Aw=At+1;}}}if(Aw!==At){Y.push(Ar.slice(Aw,At));}return Y;}function AF(Y){var As=Y.ancestor("ul"),Ar=As.all(".hLozenge");if(Ar){B(Y);Ah(Y);Ar.remove();AD.fire("lozenge:remove");}}function g(){var Ar=this,Y;if(!Ar.isLozengeHighlighted){return;}Y=Ar.composeView.baseNode.all(".hLozenge.focus");Y.removeClass(AE);B(AD.all("#to-field, #cc-field, #bcc-field"));Ar.allLozengesSelected=false;Ar.isLozengeHighlighted=false;}function An(Ar,Y){var At=this;At._removeLozengeHighlights();Ar.toggleClass(AE);At.isLozengeHighlighted=true;var As=Ar.one(".lozenge-static").generateID();Y.setAttrs({"aria-owns":As,"aria-activedescendant":As});}function x(Y){var At=this,As=Y.ancestor("ul"),Ar=As.all(".hLozenge");if(Ar){Ar.addClass(AE);At.isLozengeHighlighted=true;}At.allLozengesSelected=true;}function Am(Y){var Au=this,As,Ar,At;As=Y.ancestor();Ar=Ae(Y.get("value"));if(!Ae(Ar)){Y.set("value","");return;}if(Ar&&Ar.indexOf('"')>-1){At=a(Ar);}else{if(Ar.lastIndexOf(",")===(Ar.length-1)){Ar=Ar.substring(0,Ar.length-1);}At=Ar.split(/[;,]+/);}Au._makeLozenges(At,As);Ad(Y);Y.set("value","");Au.checkOtherLozengeBoxes();}function j(){var At=this,As=At.composeView.baseNode,Y,Ar;if(As.all("li.hLozenge").size()>100){Ar=new AD.common.ui.Notification({type:"fade",className:"top",parent:"shellcontent",parentType:"id"});Y=Ag._shared_module_offscreen_bin_notification_notifications.addlozenge_exceededmax;Ar.on("clickEvent",function(){Ar.destroy();});Ar.notify(S(Y,null,null,null,strings),5000);}}function Ak(Aw,Au){var Ax=this,Ar,Y=Aw.length,As,Av,At;for(Ar=0;Ar<Y;Ar++){As=Aw[Ar];Ae(As);if(As){Av=AX(As);At=Ax._createLozenge(Av);Au.insert(At,Au);}}Ax.composeView.resizeRTE();Ax._checkRecipientCount();Ax.composeView._setDirty();Ax.checkOtherLozengeBoxes();}function Ab(Au){var Ax,At;if(!Au){return null;}Au.name=Au.name||Au.email;if(strings.str_cfg_tog_compose_enable_nickname){var Y=c.getContactsByEmail(Au.email),As;if(Y){As=c.getFirstFieldValue(Y[0],"nickname");if(As){Au.isNN=true;Au.name=As;}}}if(!Ax){Ax={email:Au.email,firstName:Au.name||Au.email};}if(Au.fail){At=strings.str_comp_error_email_lozenge_attr;}else{At=Au.email;}var Ar,Aw={label:F(Au.name),hover:F(At),state:Au.fail?"error":"normal",data:Au,menu:null,edit:true,copy:true};Ar=new AD.comms.ui.Lozenge(Aw);var Av=Ar.getNode();Av.set("role","presentation");if(AD.mail.e2e&&AD.mail.e2e.hasStarted&&AD.mail.e2e.hasStarted()&&AD.mail.e2e.isValid()){AD.mail.e2e.validateRecipients([Au.email],function(Ay){if(Ay[0].recipient===Au.email&&Ay[0].valid){Av._node.classList.add("lozenge-secure");}});}return Av;}function AQ(Aw){var Ax=Aw.getData("lozenge");var At=Ax.data;var Av=Ax.error;if(strings.str_cfg_tog_compose_enable_nickname){if(At.name&&At.isNN){var As=AD.contacts.utils,Ar=As.getContactsByEmail(At.email),Au,Y;Au=As.getFirstFieldValue(Ar[0],"name");Y=Au?(Au.familyName+" "+Au.givenName):"";At.name=Y;}}if(Av){this.currentAddress=At.email;
this.validAddress=false;}else{this[this.currentField].push(At);}}function AI(){var Az=this,Au={to:[],cc:[],bcc:[],validAddress:true,currentAddress:"",currentField:""},Ax,A1,A2,Aw,A3,A0,As,Y,Ar,Ay,Av,At;Ax=Az.composeView.baseNode.one(".cm-to.ac-input").all(".hLozenge");Au.currentField="to";Ax.each(AQ,Au);A1=Az.composeView.baseNode.one(".cm-cc.ac-input").all(".hLozenge");Au.currentField="cc";A1.each(AQ,Au);A2=Az.composeView.baseNode.one(".cm-bcc.ac-input").all(".hLozenge");Au.currentField="bcc";A2.each(AQ,Au);A3=((Aa.get("externalAccounts")||{}).extAccount||[]).length;A0=((Aa.get("aliases")||{}).alias||[]).length;As=((Aa.get("disposableAddresses")||{}).deaName||[]).length;if((A3>0)||(A0>0)||(As>0)){if(Az.composeView.type&&Az.composeView.type==="inlineCompose"){Au.from={email:Az.composeView.cdo.get("header").from.email,name:Az.composeView.cdo.get("header").from.name};}else{Y=Az.composeView.baseNode.one(".from-select").get("value");Ar=Y.lastIndexOf("<");Ay=Y.lastIndexOf(">");Av=Y.substring(Ar+1,Ay);At=Y.substring(0,Ar-1);Au.from={email:Av,name:At};}}else{Au.from={email:Aa.get("userSendPref.defaultFromAddress"),name:Aa.get("userSendPref.defaultFromName")};}Aw=Az.composeView.baseNode.one(".cm-subject-field");if(Aw){Au.subj=Aw.get("value");}else{Au.subj=Az.composeView.cdo.get("header").subject;}return Au;}function E(Au,A3,As){var Aw,A2,Az,A0,Ar,Ay,At,Av=AD.mail.ui.PaneUtils,Ax=A3.recipients,A1=A3.more_recipients,Y=A3.to_str;if(Au){A2=Au.to||[];Az=Au.cc||[];A0=Au.bcc||[];Ar=A2.concat(Az,A0);Aw=Ar.length;Ay=function(A4){var A5={to:Av.getConvName(A4),rcpt_id:Av.getAddress(A4),rcpt_name:Av.getConvName(A4)};return A5;};At=Av.createRecipientList(Ar,Ax,null,As,Ay);if(As!==""&&Ar.length>As){At+=S(A1,{num_more_recipients:Ar.length-As},0,0,strings);}At=S(Y,null,null,null,strings)+At;return At;}}function Q(A1){var Aw=this,Au=Aw.composeView,At,A2,Az=Au.type==="inlineCompose"?Au.baseNode.one(".thread-recipients"):null,Ax="",Ar=[],Av={to:{list:A1.to,node:".cm-to-field"},cc:{list:A1.cc,node:".cm-cc-field"},bcc:{list:A1.bcc,node:".cm-bcc-field"}},Ay=function(A3){var A4={to:w.getConvName(A3),email:w.getAddress(A3)};return A4;};function As(A5,A6){var A4=Au.baseNode.one(A6),A3=A4.ancestor("li");if(Az&&A6!==".cm-bcc-field"){Ar=Ar.concat(A5);}AD.Array.each(A5,function(A7){At=Aw._createLozenge({name:A7.name,email:A7.email});A3.insert(At,A3);Aw.composeView.resizeRTE();Aw._checkRecipientCount();Au._setDirty();});Ad(A4);}for(A2 in Av){if(Av[A2].list){As(Av[A2].list,Av[A2].node);}}if(Az){Ax=w.createRecipientList(Ar,Ag._shared_module_thread_thread_display_rollup.recipients1,null,null,Ay);Az.setContent(Ax);}if(Av.cc.list&&Av.cc.list.length!==0){Aw._bccSwitch(true,false,"cc");}if(Av.bcc.list&&Av.bcc.list.length!==0){Aw._bccSwitch(true,false,"bcc");}if(Au.type==="fullCompose"){if(A1.subject){Au.baseNode.one(".cm-subject-field").set("value",A1.subject);var A0=AD.UA.ie>0&&AD.UA.ie<10,Y=A0&&Au.baseNode.one(".IEplaceholder");if(A0&&Y){Y.addClass("hidden");}Au._setDirty();}}Aw.checkOtherLozengeBoxes();}function C(Ar){var At=this,Y=At.composeView.baseNode.all("div.ac-input input"),As=At.composeView.baseNode.all("div.subject input");if(Ar){Y.removeAttribute("readOnly");As.removeAttribute("readOnly");}else{Y.setAttribute("readOnly",true);As.setAttribute("readOnly",true);}}function f(As){var Av=this,Au,Ar=As.name+" "+"<"+As.email+">",Y=Av.composeView.baseNode.one(".from-select"),At=Y.all("option").getDOMNodes();for(Au=0;Au<At.length;Au++){if(At[Au].value===Ar){Y.set("value",Ar);}}}function m(Y,A0,Av,A2){var Au=this,Ay,As,At,Az=strings.str_tog_loadRTLCss?"rtl":"ltr",A3,Ar=Av.fromNameDir||Az,A1,Aw=Av.fromName||"",Ax=Av.address||"";if(!Aw&&strings.str_cfg_tog_use_default_fromname){Aw=A2;}if(NeoConfig.bidi){A1=(Ar==="rtl"?"\u202B":"\u202A")+Aw+"\u202C";A3=(Az==="rtl"?"\u202B":"\u202A")+"\u200E&lt;"+Ax+"&gt;\u200E\u202C";At=AV(A1)+" "+A3;}else{At=AV(Aw,b)+" &lt;"+Ax+"&gt;";}if(Ax){Ay=S(AC,{isDefault:Av.isDefault,address:At},Au.composeView.formatters,null,strings);As=Ay.toLowerCase();Y.push(As);A0[As]=Ay;}}function v(Ar){var At=this,Y=At.composeView.cdo,As;if(Y.cdoType==="composereply_sender"){As=AD.common.Utils.getVal(Y,"oComposeData.origin.oMsg.header.to");if(As&&As.length>0&&As[0].email===Ar.address){return true;}}return false;}function AR(){var A7=this,A9,As,BD=[],BA=(Aa.get("aliases")||{}).alias||[],Ay=BA.length,Aw=Aa.get("userSendPref"),Ar,BE="",Y,Az,A8,A2=strings.str_tog_loadRTLCss?"rtl":"ltr",A3=Aa.get("externalAccounts")||{},A4=(Aa.get("disposableAddresses")||{}).deaName||[],At=A4.length,A0=A3.extAccount||[],BB=A0.length,A5=A7.composeView.baseNode.one(".from-select"),Au={},A1,Av,Ax,BF,BC=false;if(Aw){BE=Aw.defaultFromName||"";}for(A9=0;A9<BB;A9++){As=AD.merge(A0[A9]);As.isDefault=A7._isDefaultAccount(As);if(As&&As.mailFromAllowed){A7._buildFromAccount(BD,Au,As,BE);if(!BC){BC=As.isDefault?true:false;}}}for(A9=0;A9<Ay;A9++){As=AD.merge(BA[A9]);As.isDefault=A7._isDefaultAccount(As);if(As){A7._buildFromAccount(BD,Au,As,BE);if(!BC){BC=As.isDefault?true:false;}}}for(A9=0;A9<At;A9++){As=AD.merge(A4[A9]);As.isDefault=A7._isDefaultAccount(As);if(As&&(!strings.tog_check_active_compos||As.activeComposition)){A7._buildFromAccount(BD,Au,As,As.address);if(!BC){BC=As.isDefault?true:false;}}}if(Aw){if(NeoConfig.bidi){Az=Aw.defaultFromNameDir||A2;Y=(Az==="rtl"?"\u202B":"\u202A")+BE+"\u202C";A8=(A2==="rtl"?"\u202B":"\u202A")+"\u200E&lt;"+Aw.defaultFromAddress+"&gt;\u200E\u202C";Ar=AV(Y)+" "+A8;}else{Ar=AV(BE,b)+" "+"&lt;"+Aw.defaultFromAddress+"&gt;";}A1=S(AC,{isDefault:(BC)?false:true,address:Ar},A7.composeView.formatters,null,strings);Av=A1.toLowerCase();BD.push(Av);Au[Av]=A1;}if(BD.length>(Aw?1:0)){A7.composeView.baseNode.one("div.account-select").removeClass(AK);}BD=BD.sort(function(BH,BG){if(BH<BG){return -1;}if(BH>BG){return 1;}return 0;});var A6=[];for(A9 in BD){A6.push(Au[BD[A9]]);}A5.setContent(A6.join(""));if(AD.UA.gecko){BF=900;}else{if(AD.UA.ie<10){BF=700;}else{if(AD.UA.ie){BF=400;}else{BF=300;}}}Ax=A5.all("option").indexOf(A5.one(".nsel"));
AD.later(BF,A7,function(BG){if(BG>-1){A5.set("selectedIndex",BG);}},Ax);}function AH(){var As=this,Ar=p.show_full_header,Y=S(Ar,As.cdo,As.composeView.formatters,null,strings,Ag);As.hdr=As.composeView.baseNode.one(".compose-header");As.hdr.setContent(Y);As._bindUIHeader();As._buildFromMenu();}function AU(As,Ar){var At=this,Y;Ar=Ar||"";Y=(Ar)?1:0;At._bccSwitch(Y,false,"cc");}function AN(As){var Ar,Y=-1;if(typeof As.get("selectionEnd")==="number"){Y=As.get("selectionEnd");}else{if(document.selection&&document.selection.createRange){Ar=document.selection.createRange();Ar.moveStart("character",-As.get("value").length);Y=Ar.text.length;}}return Y;}function l(Y,Au){Au=Au||"bcc";var Aw=this,Av=Aw.composeView.baseNode,At=Av.one(".cm-"+Au+".ac-input").all(".hLozenge"),Ar=Av.one(".cm-"+Au+"-field"),As=(Au==="bcc")?Ap:Af;if(Y||(At.isEmpty()&&Ar.get("value").length===0)){Aw._bccSwitch(Y,true,Au);As!==Ap&&G.set(As,Y);}else{Aw.composeView.confirm(null,strings["str_comp_conf_"+Au],function(){At.each(function(Ax){Ax.remove();Aw.composeView._setDirty();});Ar.set("value","");Aw._bccSwitch(false,true,Au);As!==Ap&&G.set(As,false);});}}function AW(Ax,Av,As){As=As||"bcc";var At=this,Ar=At.composeView.baseNode.all(".cm-btn-show-"+As),Ay=At.composeView.baseNode.one(".cm-"+As+"-group");if(typeof Av==="undefined"){Av=true;}if(Ax){Ay.removeClass(AK);Ar.addClass(AK);Av&&At.composeView.setFocus(As);}else{Ay.addClass(AK);Ar.removeClass(AK);Av&&At.composeView.setFocus(As);}var Y=At.composeView.baseNode.one(".cm-bcc-group"),Aw=At.composeView.baseNode.one(".cm-cc-group"),Au=At.composeView.baseNode.one(".btn-bcc-in-cc");if(Y.hasClass(AK)){if(Ax){Au.removeClass(AK);}else{if(Aw.hasClass(AK)){Au.addClass(AK);}else{Au.removeClass(AK);}}}At._reposAttachObj(V);At.composeView.resizeRTE();}function Aq(Y){var Ar=this;if(NeoConfig.isCorpmail){AD.use("ac-corp-widget",function(){Ar._initAutoComplete2(Y);});}else{Ar._initAutoComplete2(Y);}}function z(Av){var As={"to-field":".cm-to","cc-field":".cm-cc","bcc-field":".cm-bcc"},Aw=this,At=NeoConfig.isCorpmail?t.ui.ACCorpWidget:t.ui.ACWidget,Au=Av.get("id");if(Au&&As[Au]){Av.removeClass("whiteout");var Ar=Aw.composeView.baseNode.one(As[Au]);var Y=function(){Aw.listeners.push(AD.ACWidgetInst.get("ac").on("ac:query",function(A2){var Ax=this,A0=A2.value,A1,Az;if(c.areContactsLoaded()){var Ay=new AD.comms.FilterContacts();Ay.updateFilterItems(A0);A1=Ay.fastMatch();A1.queryStr=A0;Az=AD.bind(Ax.reload,Ax,A1);Az(A1);}}));};if(!AD.ACWidgetInst){if(Aw.offscreenContent){Aw.offscreenContent.remove();}Aw.offscreenContent=AD.Node.create(S(Ag._shared_module_offscreen_bin_compose.base,{},null,null,strings,Ag));AD.one(document.body).append(Aw.offscreenContent);AD.ACWidgetInst=new At({acNode:Ar,acTarget:Av,contentBox:"#ac-to-results",selectFirst:true}).setAlign().render();Aw._setACWidgetARIAOwns();AD.ACWidgetInst.after("visibleChange",function(A0){var Az=this.get("ac").get("host"),Ax=AD.ACWidgetInst.get("contentBox").one("li"),Ay=(A0.newVal&&Ax)?true:false;Az.set("aria-expanded",Ay);if(!Ay){Az.set("aria-activedescendant","");}});AD.ACWidgetInst.after("selectedIndexChange",function(Ay){var Ax="";if(Ay.newVal>-1){Ax=this.get("contentBox").one(".yui3-acwidget-selected").generateID();}this.get("ac").get("host").set("aria-activedescendant",Ax);});Y();}else{if(AD.ACWidgetInst.get("ac").get("alignNode")!==Ar){AD.ACWidgetInst.get("ac").destructor();AD.ACWidgetInst.refresh({acNode:Ar,acTarget:Av,width:Ar.getStyle("width"),selectFirst:true}).setAlign().render();Y();Aw._setACWidgetARIAOwns();}}}}function D(){var At=this,Ar=At.listeners;if(Ar){var As=Ar.length,Y;for(Y=0;Y<As;Y++){if(Ar[Y]){Ar[Y].detach();}}Ar.length=0;}if(At.lozengeDD){At.lozengeDD.destroy(true);}if(At.hdr){At.hdr.detachAll();At.hdr.remove();}K.superclass.ondestroy.call(At,arguments);}function W(Ar){var At=this,Y=Ar.target,As=Y.ancestor("div.ac-input",false);if(As){At.composeView.focusNode=As.get("id");As.addClass(d);As.get("parentNode").addClass("active");}if((Y.hasClass("cm-to-field"))||(Y.hasClass("cm-cc-field"))||(Y.hasClass("cm-bcc-field"))){At.composeView._registerFocus(Y);At._initAutoComplete(Y);At.checkOtherLozengeBoxes();}}function Ac(Y){if(!(AD.one("div.ac-results:hover")||AD.one("div.ac-results li.over")||AD.one("li.yui3-aclist-item-hover"))){u();this._lozengeIt(Y);AD.ACWidgetInst.get("ac").set("queryValue","");}}function q(As){var Au=this,Ar=As.target,Y=Au.composeView.cdo;if(Ar.hasClass("cm-to-field")||Ar.hasClass("cm-cc-field")||Ar.hasClass("cm-bcc-field")){As.halt();this.handleACBlur(Ar);}else{if(Ar.get("id")==="subject-field"){var At=Ar.get("value");if(At&&At!==""){if(Y.oComposeData&&Y.oComposeData.header&&typeof Y.oComposeData.header.subj!=="undefined"&&Y.oComposeData.header.subj!==At){Au.composeView._setDirty();}}}}}function A(Aw,A3){var Au=this,Ax=Aw.target,A5=Aw.keyCode,A4,Av,As=Ax.ancestor("div"),A0=As.one(".hLozenge.focus"),A1=Ax.get("value"),At,Ay,A2=Ax.get("id");if(A2){A4={"to-field":A3.one("#to_add_contacts"),"cc_show_btn_in_to":"to","cc_hide_btn":"cc","cc-field":A3.one("#cc_add_contacts"),"bcc-field":A3.one("#bcc_add_contacts"),"bcc_show_btn_in_cc":A3.one("#cc_hide_btn"),"bcc_hide_btn":"bcc"};Av={"to-field":A3.one("#cc_show_btn_in_to"),"to_add_contacts":"to","cc_add_contacts":"cc","cc_hide_btn":A3.one("#bcc_show_btn_in_cc"),"bcc_add_contacts":"bcc","cc_show_btn_in_to":A3.one("#bcc_show_btn_in_to"),"cc-field":A3.one("#cc_hide_btn"),"bcc-field":A3.one("#bcc_hide_btn")};if(A5===39){if(Ax.get("nodeName")==="A"||(!A1&&!A0)||(A1&&AN(Ax)===A1.length)){At=Av[A2];if(At){Au.composeView.setFocus(At);if(At==="to"||At==="cc"||At==="bcc"){var Ar=A3.one("#"+At);Ay=Ar.one(".hLozenge");if(Ay){Au._selectSingleLozenge(Ay,Ar);Ar.addClass("whiteout");}}return;}}}}if(!Ax.get("value")){Aw.preventDefault();var Az;if(A0){if(A5===37){Az=A0.previous();if(!Az){A4[A2]&&Au.composeView.setFocus(A4[A2]);Au._removeLozengeHighlights();Ax.removeClass("whiteout");}}else{Az=A0.next();if(!Az.hasClass("hLozenge")){Az=null;Au._removeLozengeHighlights();Ax.removeClass("whiteout");
}}if(Az){Au._removeLozengeHighlights();Au._selectSingleLozenge(Az,Ax);}}else{if(A5===37){var Y=Ax.ancestor();Az=Y.previous();if(Az&&Az.hasClass("hLozenge")){Au._removeLozengeHighlights();Au._selectSingleLozenge(Az,Ax);Ax.addClass("whiteout");}else{A4[A2]&&Au.composeView.setFocus(A4[A2]);}}}}}function s(Au){var At=this,Az=Au.keyCode,Av=Au.target;if(!Av.get("value")){var Y=Av.ancestor(),As=Av.ancestor("div"),Ay=As.all(".hLozenge.focus"),Ar=Ay.size();Au.halt();if(At.allLozengesSelected){At.removeAllLozenges(Av);Av.removeClass("whiteout");return;}var Ax,Aw;if(Ar){At.removeARIAFocus(Av);At.removeARIADescription(Av);if(Ar===1){Ax=Ay.item(0);Aw=Ax.next();if(Aw===Y){Aw=Ax.previous();}if(Aw){At._selectSingleLozenge(Aw,Av);}else{Av.removeClass("whiteout");}}else{Av.removeClass("whiteout");}At.composeView._setDirty();Ay.detachAll();Ay.remove();Ay=null;AD.fire("lozenge:remove");}else{if(Az===8){Aw=Y.previous();if(Aw){At._removeLozengeHighlights();At._selectSingleLozenge(Aw,Av);Av.addClass("whiteout");}}}At.checkOtherLozengeBoxes();At.composeView.resizeRTE();}}function n(){var Au=this,As=Au.composeView.baseNode.one(".cm-to.ac-input").all(".hLozenge").size(),Y=Au.composeView.baseNode.one(".cm-cc.ac-input").all(".hLozenge").size(),At=Au.composeView.baseNode.one(".cm-bcc.ac-input").all(".hLozenge").size(),Ar=0;Ar=As+Y+At;Au.totalLozenges=Ar;return Ar;}function AY(){var Ar=this,Y=Ar.lozengeCount();if(Y<=0){Ar.composeView._showSendBtn(false);}else{Ar.composeView._showSendBtn(true);}}function P(){var Y=AD.ACWidgetInst;if(Y.canHandleEnter){return Y.canHandleEnter();}return(Y&&Y.isVisible()&&(Y.get("data").length>0||(NeoConfig.isCorpmail&&Y.get("gabData").length>0)));}function h(As,Aw){var Av=this,A1=AD.ACWidgetInst,A0=As.decodeCategory(Aw.get("value")),Az=function(A8,A7,A5,A6,A4){switch(A7){case"amp":if(A5){return Az(A8,A5,"",A6+5,A4);}return"&";case"#39":return"'";case"quot":return'"';case"lt":return"<";case"gt":return">";case"#35":return"#";default:return"";}};if(A0){var A2,Ay=[];for(A2 in A0){var Ax=A0[A2];if(Ax){var Ar="",At=Ax.firstname&&AV(Ax.firstname),A3=Ax.middlename&&AV(Ax.middlename),Au=Ax.lastname&&AV(Ax.lastname),Y=Ax.nickname&&AV(Ax.nickname);Ar=A1.buildName(At,A3,Au,Y);Ar=Ar+"("+Ax.email+")";Ay.push(Ar.replace(/&((?:[a-zA-Z]+)|(?:#[0-9]+));(?:([a-zA-Z]+|(?:#[0-9]+));)?|([;,])/gi,Az));}}Av._makeLozenges(Ay,Aw.ancestor());Av.addARIADescription(Aw);Aw.set("value","");}else{Av._lozengeIt(Aw);}}function i(Ax){var Aw=this,Ay=Ax.target,Y=Ax.ctrlKey,Az=Ax.metaKey,A1=AD.ACWidgetInst,Au=AD.UA.os,Ar=(Y&&(Au==="linux"||Au==="windows"||Au==="win"))||(Az&&(Au==="macintosh"||Au==="mac"));if(Ay.get("nodeName")==="A"){return;}if(Ar&&!Ax.altKey){Aw.composeView.handleComposeAction("send",Ax);}var As=new AD.comms.FilterContacts();if(Aw.canACWidgetInstHandleEnter()){A1.handleEnter(Ax,A1);}else{As.updateFilterItems(Ay.get("value"));var A2=As.fastMatch();if(A2&&A2.length){var Av=A2[0],A3=R(A1.getItemMarkup(Av));A3.one("span.ac-remove-item").remove();Ay.set("value",A3.get("text"));}else{}}Ax.halt();if(!Ay.get("value")){Ax.preventDefault();var At=Ay.ancestor("div");var A0=At.one(".hLozenge.focus");if(A0){A0.getData("lozenge").startEdit();}return;}Aw.setACCategory(As,Ay);}function k(Au){var At=this,Av=Au.target,Y=Au.ctrlKey,Aw=Au.metaKey,Az=AD.ACWidgetInst,As,Ay,Ar=(As=Az.get("data"))&&As.length,Ax=(Ay=Az.get("gabData"))&&Ay.length;if((Y||Aw)||!Av.get("value")){return;}if(Ar>=2||Ax>=2){return;}else{if(Ar===1||Ax===1){Au.halt();if(Az&&Az.isVisible()){Av.simulate("keydown",{keyCode:13});}}else{Au.halt();At._lozengeIt(Av);}}}function T(Ar){var Au=this,Y=Ar.target,At=Ar.ctrlKey,As=Ar.metaKey;if((!At&&!As)||Y.get("value")){return;}Ar.halt();Au._selectAllLozenges(Y);Y.addClass("whiteout");}function e(Av){var Au=this,At,Aw=Av.target,Ar=Av.ctrlKey,Ax=Av.metaKey,Y=Av.altKey,Ay=AD.ACWidgetInst,As=(At=Ay.get("data"))&&At.length;if(!Aw.get("value")){if(Ay.hasItemSelected){if(!Ay.hasItemSelected()){return;}}else{if(!Ay.isVisible()){return;}}}if(!Ar&&!Ax&&!Y){if(As>=1){Av.halt();}Au.composeView.keepHdrFocus=true;Aw.simulate("keydown",{keyCode:13});}}function Z(As){var Av=this,Au=As.ctrlKey,At=As.metaKey,Ar=(AD.UA.os==="macintosh")?At:Au;function Y(){var Ay=Av.hdr,Ax=r.ui.MessagePaneUtils,Aw="";Ay.all("li.focus").each(function(Az){Aw+=Az.one("input").get("value");Aw+="; ";});if(Aw!==""){Aw=Aw.substring(0,Aw.length-1);Ax.initializeCopyText();Ax.copyToClipboard(Aw,null,document.activeElement);}}if(Ar){As.stopPropagation();Y();}}function AJ(As){var Ax=this,Ar=As.target,Av=As.ctrlKey,Au=As.metaKey,Y=(AD.UA.os==="macintosh")?Au:Av,At=(As.type==="paste")?true:false,Aw;if(Y||At){if(window.clipboardData){As.preventDefault();Aw=window.clipboardData.getData("Text");Aw=Aw.replace(/(\r\n|\n|\r)/gm," ");Ar.set("value",Aw);}setTimeout(function(){Ax.updateTextField(Ar,true);},0);}}function AP(At){var Aw=this,As=At.target,Y=At.shiftKey,Av=At.ctrlKey,Au=At.metaKey,Ar=(AD.UA.os==="macintosh")?Au:Av;As.removeClass("whiteout");if(!(Ar||Y)){Aw._removeLozengeHighlights();}}function AT(At){var Au=this,As=At.target;if(As.hasClass("cm-to-field")||As.hasClass("cm-cc-field")||As.hasClass("cm-bcc-field")){var Y=Au.composeView.baseNode.one(".ac-input.compose-field-focus .recipient-input input"),Ar=Au.totalLozenges;if(Y===null&&Ar<=0){Au.composeView._showSendBtn(false);}else{if(Y.getDOMNode().value===""&&Ar<=0){Au.composeView._showSendBtn(false);}else{Au.composeView._showSendBtn(true);}}}}function O(Aw){var Au=this,A2=Au.hdr,A4=Aw.keyCode,Ay=Aw.shiftKey,Ar=Aw.ctrlKey,Ax=Aw.metaKey,Y=Aw.altKey,Az=(AD.UA.os==="macintosh")?Ax:Ar,A3,Av=Aw.target,A5=NeoConfig.infinitePane,A0=Av?(Av.get("type")?Av.get("type").toLowerCase()||"":""):"",At=Av?Av.get("tagName").toLowerCase():"",A1=function(){return Av.ancestor("div.cm-to ul,.cm-cc ul,div.cm-bcc ul");},As;AD.fire("HoverCard:hideHoverCard");if(A0&&(A0==="text"||A0==="textarea")){Aw.stopPropagation();}else{if(At&&(At==="input"||At==="textarea")){Aw.stopPropagation();}}if(Av.hasClass("cm-from-field")){if(A5&&(Aw.keyCode===37||Aw.keyCode===39)){Aw.stopPropagation();
}}if(!(Ay&&Ar&&Ax&&Y)&&(A4===188||A4===186)&&(Av.hasClass("lozenge-edit"))&&A1()){As=A1().one("li.recipient-input input");if(As){As.focus();}else{Av.blur();}}if(Av.hasClass("cm-subject-field")||Av.hasClass("cm-to-field")||Av.hasClass("cm-cc-field")||Av.hasClass("cm-bcc-field")||Av.get("nodeName")==="A"){if(A5&&(Aw.keyCode===37||Aw.keyCode===39)){Aw.stopPropagation();}if((A4===83||(A4===89&&Ay)||(A4===85&&Ay))&&(Ar||Ax)||A4===27){Au.composeView.get("keydownHandler")?Au.composeView.get("keydownHandler")(Aw):Au.composeView.onKeyDown(Aw);return;}else{if(Av.hasClass("cm-subject-field")){A3=(Ar||Ax)&&(!Y&&!Ay)||A4===9;if(!A3||(Az&&A4===86)){Au.composeView._setDirty();}if(A4===9&&!Ay){Av.blur();Au.composeView.setFocus("body");Aw.halt();}if(A4===13&&Az&&!Aw.altKey){Au.composeView.handleComposeAction("send",Aw);}return;}else{switch(A4){case 37:case 39:Au.handleLeftRightArrow(Aw,A2);break;case 8:case 46:Au.handleDelete(Aw);break;case 13:Au.handleEnter(Aw);break;case 32:Au.handleSpacebar(Aw);break;case 65:Au.handleSelectAll(Aw);break;case 38:break;case 9:Au.handleTab(Aw);break;case 67:Au.handleCopy(Aw,A2);break;case 86:if(Az){Au.handlePaste(Aw);}break;default:Au.handleDefaultKeydown(Aw);}}}}}function I(){var As=this,Ar=As.hdr,Y=As.listeners;Y.push(Ar.on("blur",As.setInputBlur,As));Y.push(Ar.on("keydown",As.keyHandler,As));Y.push(Ar.on("keyup",As.sendEnableKeyHandle,As));Y.push(Ar.on("change",function(Au){var At=Au.target;if(At.hasClass("cm-to-field")||At.hasClass("cm-cc-field")||At.hasClass("cm-bcc-field")){As.composeView._setDirty();}}));}function AZ(Ar){var As=this,Y=Ar.dataAction;switch(Y){case"reply_all":case"reply_sender":case"forward":As.switchReplyMode(Ar.dataAction);AD.fire("mt:click",{action:"reply_card_menu_"+Y});break;case"edit_subject":As.allowSubjectEdit(true);break;}}function N(At){var Au=this,Y=Au.composeView.cdo.oComposeData.origin,As=AD.common.ui.MenuHelper,Ar=At.target;AD.use("mail-ui-inboxmenu-base","_shared_module_offscreen_bin_menus_reply_modes",function(Av){Av.mail.ui.InboxMenu.insert("menu-reply-modes",function(){var Aw=Av.one("#menu-reply-modes");As.create(Ar,{menu:Aw,flushLeft:false,isContext:false,xy:[At.clientX,At.clientY]},function(){Aw.on("menuSelected",Au.onReplyModeSelected,Au);Aw.after("menu:state",function(Ay){var Ax=Ay.state;if(Ax==="hide"){Ar.removeClass("pressed");Ar.unplug(Av.Plugin.Menu);this.destroy(true);}});});},Y.fid,{origin:Y,isQuickReply:Au.composeView.get("isQuickReply")});});}function Ao(){var Y=this;Y.listeners.push(Y.hdr.delegate("click",function(Ar){var As=AL.getDataAction(Ar).action;switch(As){case"menu":Y.loadReplyModeMenu(Ar);AD.fire("mt:click",{action:"reply_card_"+As});break;case"qr-cancel":Y.neoFire("qrCancel");AD.fire("ToolTips:hideTooltips");AD.fire("mt:click",{action:"reply_card_"+As});break;case"compose-recpt-more":Y.hdr.one(".recipients").set("innerHTML",Y._getRecptList(Y.composeView.cdo.oComposeData.header,p,""));break;}},".compose-header"));}function AG(){var At=this,As=At.composeView.baseNode,Y=As.one("input.cm-subject-field"),Au=As.one("input.cm-to-field"),Av=As.one("input.cm-cc-field"),Ay=As.one("input.cm-bcc-field"),Ax=AD.UA.ie>0&&AD.UA.ie<10,Ar=Ax&&As.one(".IEplaceholder"),Aw=At.hdr;if(NeoConfig.bidi){Y.plug(AD.Plugin.BidiTextEntry);}At._bindAutoComplete();At.listeners.push(At.hdr.delegate("paste",AJ,"#to-field, #cc-field, #bcc-field",At));At.listeners.push(AD.on("lozenge:highlight",function(){At.isLozengeHighlighted=true;}));if(NeoConfig.useDD&&At.composeView.type==="fullCompose"){AD.use("common-ui-lozengeDD",function(Az){Az.Lang.later(0,0,function(){At.lozengeDD=new Az.common.ui.lozengeDD({composeView:At.composeView,dragSelector:".ac-input"});});});}At.listeners.push(Aw.on("focus",W,At));At.listeners.push(Y.after("focus",function(){At.composeView._registerFocus(Y);if(Ax){Ar.addClass("hidden");}}));At.listeners.push(Y.on("change",function(){if(Ax){Ar.addClass("hidden");}}));At.listeners.push(Au.after("blur",function(){Au.ancestor("div").removeClass(d);At.composeView.resizeRTE();})),At.listeners.push(Av.after("blur",function(){Av.ancestor("div").removeClass(d);At.composeView.resizeRTE();})),At.listeners.push(Ay.after("blur",function(){Ay.ancestor("div").removeClass(d);At.composeView.resizeRTE();})),At.listeners.push(Y.after("blur",function(Az){At.neoFire("updateSubject");if(Ax&&AD.Lang.trim(Az.target.get("value"))===""){Ar.removeClass("hidden");}}));At.listeners.push(Aw.delegate(["click","keydown"],function(A1){if(A1.type==="keydown"&&A1.keyCode!==13){return;}A1.halt();At._reposAttachObj(Ai);var Az={"to_add_contacts":".cm-to","cc_add_contacts":".cm-cc","bcc_add_contacts":".cm-bcc"},A0={wspath:NeoConfig.socdirProxyPath,guid:NeoConfig.neoguid,wssid:NeoConfig.wssid,requestFn:AD.common.net.SessionMgr.requestProxy,selectAll:false,lookForSelect:true,lookForInput:true,onDone:function(A8,BA){var A5,BB,A7,A6=BA.get("id"),A4=At.composeView.baseNode.one(Az[A6]).all("li"),A9=A4.item(A4.size()-1);for(A5 in A8){BB={name:A8[A5].name,email:F(A8[A5].field.value)};A7=At._createLozenge(BB);At.composeView._setDirty();A9.insert(A7,A9);At.composeView.resizeRTE();At._checkRecipientCount();}At._reposAttachObj(AM);At.composeView._restoreFocus();},onCancel:function(){At._reposAttachObj(AM);}};AD.use("contacts-ui-choosecontactdialog",function(A4){if(!At.composeView.cancelDialogLoad){A4.fire("ccd:create",A0,A1.currentTarget);}});var A3=A1.currentTarget.get("id"),A2="addbcc";if(A3==="to_add_contacts"){A2="addrec";}else{if(A3==="cc_add_contacts"){A2="addcc";}}AD.fire("mt:click",{action:"cmps_"+A2,append:{t1:"cmpsTb"}});},".choose-contact"));At.listeners.push(Aw.delegate("click",function(A2){var A1=A2.target,A0=A2.currentTarget,A4=A0.getElementsByTagName("INPUT"),Az=A4.item(A4.size()-1),A3;if(A1.hasClass("lozenge-edit")){return;}A3=A0.get("scrollTop");Az.focus();if(A1.hasClass("lozenge-static")||A1.hasClass("lozenge-edit")){A0.set("scrollTop",A3);Az.addClass("whiteout");}else{Az.removeClass("whiteout");At._removeLozengeHighlights();A0.set("scrollTop",A0.get("scrollHeight"));
}},"div.ac-input"));At.listeners.push(Aw.on("keyup",function(A2){var A3=A2.target,A0=A3.get("value"),A1=A0.length,Az=A0[A1-1];if(!(A3.hasClass("cm-to-field")||A3.hasClass("cm-cc-field")||A3.hasClass("cm-bcc-field"))){return;}if(A1>0){At.composeView._setDirty();}if(Az===";"||Az===","){A2.halt();A0=Ae(A0);if(A0.length===1){A3.set("value","");return;}if(!A0){return;}At._lozengeIt(A3);}At.updateTextField(A3);At._reposAttachObj(V);}));}function H(Y,Ar){var As=Y.action===J;if(As){Ar.removeClass("ico-thread-reply");Ar.addClass("ico-thread-reply-all");}else{Ar.removeClass("ico-thread-reply-all");Ar.addClass("ico-thread-reply");}}function y(At){At=At||0;var Aw=this,Az=Aw.composeView.cdo.oComposeData.origin,Y=Aw.composeView.baseNode,Au=Y.all(".replyall-toggle-btn a"),Ar,Ax,As=Y.one(".qr-card-actions");if(!At){At=Az.action===AO?J:AO;}Az.action=At;if(As){As.replace(S(Ag._shared_module_compose_quick_reply_card_actions.base,{reply_type:X[At]},null,null,strings));}if(At===AO){Au.set("text",strings.str_comp_btn_reply_all);!Aw.composeView.get("isQuickReply")&&AD.fire("mt:click",{action:"cmps_rplysndr",append:{t1:"cmpsTb"}});}else{if(At===J){Au.set("text",strings.str_comp_btn_reply_sender);!Aw.composeView.get("isQuickReply")&&AD.fire("mt:click",{action:"cmps_rplyall",append:{t1:"cmpsTb"}});}else{if(At===Aj){!Aw.composeView.get("isQuickReply")&&AD.fire("mt:click",{action:"cmps_fwd",append:{t1:"cmpsTb"}});Aw.allowSubjectEdit(false);}}}L.updateAttachments(Aw.composeView.cdo);if(Aw.composeView.type==="inlineCompose"){H(Az,Au);}Ax=L.getHeaderContent(Az);Ar=Y.one(".cm-subject-field");if(Ar){Ax.subject=Ar.get("value");}var Av=Y.one(".cm-to-field"),Ay=Y.one(".cm-cc-field");Aw.removeAllLozenges(Av);Aw.removeAllLozenges(Ay);Aw.setHeader(Ax);Aw.composeView._restoreFocus();}function AA(){var A3=this,As=A3.hdr,A2,A4,At=A3.composeView.cdo.oComposeData.origin,A6=At&&At.oMsg&&At.oMsg.header,Az=At&&At.oMsg&&At.oMsg.body,Ax=A6&&((A6.to?A6.to.length:0)+(A6.cc?A6.cc.length:0))||0,A5=At.action,Aw,Av,Au,Y=A3.composeView.baseNode,A0=Y.all(".replyall-toggle-btn"),A7,Ar={},A9,A1,Ay=1,A8;if(At.fid==="Sent"&&A5===AO){At.action=J;}if((A5!==J&&A5!==AO)||!Az||!Ax){return;}if(A6.replyto){A8=A6.replyto.length;for(A7=0;A7<A8;A7++){Ar[A6.replyto[A7].email]=1;}}A9=A6.to.concat(A6.cc);Aw=A3.getAllAccountEmails()||{};A8=A9.length;for(A7=0;A7<A8;A7++){Av=A9[A7].email||"";if((A1&&Av!==A1)||(A8===1&&!(Av in Aw||Av in Ar))){Ay=0;}A1=Av;if((Av in Aw||Av in Ar)&&!Au){Au=0;}else{Au=1;}}if(A5&&Au&&!Ay&&Y.one(".replyall-toggle-btn")&&At.fid!=="Sent"){A0.removeClass("hidden");A2=As.one("#to");A4=As.one(".address-btns");if(A4&&A2.getX()+A2.get("clientWidth")+A4.get("clientWidth")+20>As.get("clientWidth")+As.getX()){A0.addClass("hidden");return;}if(A3.composeView.type==="inlineCompose"){H(At,Y.all(".replyall-toggle-btn a"));}A3.listeners.push(Y.delegate("click",function(){A3.switchReplyMode();},".address-btns .replyall-toggle-btn a",A3));}}function Al(Y){var Ar=this.hdr.one(".subject");Ar.removeClass("hidden");if(Y){setTimeout(function(){Ar.one("input").focus();},0);}}AD.extend(K,r.ui.BaseWidget);AD.mix(K.prototype,{NAME:"HeaderBase",render:AH,getHeader:AI,setHeader:Q,enableHeader:C,getAllAccountEmails:M,allowEditing:AU,_bindUIHeader:AG,bind:Ao,loadReplyModeMenu:N,setInputFocus:W,setInputBlur:q,keyHandler:O,lozengeCount:n,sendEnableKeyHandle:AT,handleACBlur:Ac,handleLeftRightArrow:A,handleDelete:s,handleEnter:i,handleSpacebar:k,handleTab:e,handleSelectAll:T,handleCopy:Z,handlePaste:AJ,handleDefaultKeydown:AP,setACCategory:h,canACWidgetInstHandleEnter:P,checkOtherLozengeBoxes:AY,_bindAutoComplete:I,ondestroy:D,destroy:D,hideACWidget:u,_cmdBccSwitch:l,_reposAttachObj:AS,_setFromMenu:f,removeAllLozenges:AF,_removeLozengeHighlights:g,_createLozenge:Ab,enableSwitchReplyButton:AA,switchReplyMode:y,_lozengeIt:Am,_checkRecipientCount:j,_makeLozenges:Ak,_selectSingleLozenge:An,_selectAllLozenges:x,_tokenizeAddresses:a,removeARIAFocus:B,_setACWidgetARIAOwns:U,removeARIADescription:Ah,addARIADescription:Ad,updateTextField:o,_buildFromAccount:m,_isDefaultAccount:v,_buildFromMenu:AR,createAddress:AX,_initAutoComplete:Aq,_initAutoComplete2:z,_bccSwitch:AW,_getRecptList:E,getCursorLocation:AN,onReplyModeSelected:AZ,allowSubjectEdit:Al,_ccSwitch:function(){}},true);AD.namespace("mail.compose");r.compose.HeaderBaseConv=K;},"1.0.0",{requires:["comms-ui-lozenge","ac-widget","_shared_module_offscreen_bin_compose","mail-controller-compose","_shared_module_offscreen_bin_notification_notifications","mail-controller-compose-text","contacts-api","_shared_module_compose_message_header_fresh","mail-ui-basewidget","mail-common-utils-features"]});/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("stylesheet",function(e,t){function v(t,r){var o,a,f,l={},h,p,m,g,y,b;if(!e.instanceOf(this,v))return new v(t,r);if(t){if(e.Node&&t instanceof e.Node)a=t._node;else if(t.nodeName)a=t;else if(s(t)){if(t&&u[t])return u[t];a=n.getElementById(t.replace(/^#/,d))}if(a&&u[e.stamp(a)])return u[e.stamp(a)]}if(!a||!/^(?:style|link)$/i.test(a.nodeName))a=n.createElement("style"),a.type="text/css";s(t)&&(t.indexOf("{")!=-1?a.styleSheet?a.styleSheet.cssText=t:a.appendChild(n.createTextNode(t)):r||(r=t));if(!a.parentNode||a.parentNode.nodeName.toLowerCase()!=="head")o=(a.ownerDocument||n).getElementsByTagName("head")[0],o.appendChild(a);f=a.sheet||a.styleSheet,h=f&&"cssRules"in f?"cssRules":"rules",m="deleteRule"in f?function(e){f.deleteRule(e)}:function(e){f.removeRule(e)},p="insertRule"in f?function(e,t,n){f.insertRule(e+" {"+t+"}",n)}:function(e,t,n){f.addRule(e,t,n)};for(g=f[h].length-1;g>=0;--g)y=f[h][g],b=y.selectorText,l[b]?(l[b].style.cssText+=";"+y.style.cssText,m(g)):l[b]=y;v.register(e.stamp(a),this),r&&v.register(r,this),e.mix(this,{getId:function(){return e.stamp(a)},enable:function(){return f.disabled=!1,this},disable:function(){return f.disabled=!0,this},isEnabled:function(){return!f.disabled},set:function(e,t){var n=l[e],r=e.split(/\s*,\s*/),i,s;if(r.length>1){for(i=r.length-1;i>=0;--i)this.set(r[i],t);return this}return v.isValidSelector(e)?(n?n.style.cssText=v.toCssText(t,n.style.cssText):(s=f[h].length,t=v.toCssText(t),t&&(p(e,t,s),l[e]=f[h][s])),this):this},unset:function(t,n){var r=l[t],s=t.split(/\s*,\s*/),o=!n,u,a;if(s.length>1){for(a=s.length-1;a>=0;--a)this.unset(s[a],n);return this}if(r){if(!o){n=e.Array(n),i.cssText=r.style.cssText;for(a=n.length-1;a>=0;--a)c(i,n[a]);i.cssText?r.style.cssText=i.cssText:o=!0}if(o){u=f[h];for(a=u.length-1;a>=0;--a)if(u[a]===r){delete l[t],m(a);break}}}return this},getCssText:function(e){var t,n,r;if(s(e))return t=l[e.split(/\s*,\s*/)[0]],t?t.style.cssText:null;n=[];for(r in l)l.hasOwnProperty(r)&&(t=l[r],n.push(t.selectorText+" {"+t.style.cssText+"}"));return n.join("\n")}})}var n=e.config.doc,r=n.createElement("p"),i=r.style,s=e.Lang.isString,o={},u={},a="cssFloat"in i?"cssFloat":"styleFloat",f,l,c,h="opacity",p="float",d="";l=h in i?function(e){e.opacity=d}:function(e){e.filter=d},i.border="1px solid red",i.border=d,c=i.borderLeft?function(e,t){var n;t!==a&&t.toLowerCase().indexOf(p)!=-1&&(t=a);if(s(e[t]))switch(t){case h:case"filter":l(e);break;case"font":e.font=e.fontStyle=e.fontVariant=e.fontWeight=e.fontSize=e.lineHeight=e.fontFamily=d;break;default:for(n in e)n.indexOf(t)===0&&(e[n]=d)}}:function(e,t){t!==a&&t.toLowerCase().indexOf(p)!=-1&&(t=a),s(e[t])&&(t===h?l(e):e[t]=d)},f=function(t,s){var o=t.styleFloat||t.cssFloat||t[p],u=e.Lang.trim,f;try{i.cssText=s||d}catch(l){r=n.createElement("p"),i=r.style,i.cssText=s||d}o&&!t[a]&&(t=e.merge(t),delete t.styleFloat,delete t.cssFloat,delete t[p],t[a]=o);for(f in t)if(t.hasOwnProperty(f))try{i[f]=u(t[f])}catch(c){}return i.cssText},e.mix(v,{toCssText:h in i?f:function(t,n){return h in t&&(t=e.merge(t,{filter:"alpha(opacity="+t.opacity*100+")"}),delete t.opacity),f(t,n)},register:function(e,t){return!!(e&&t instanceof v&&!u[e]&&(u[e]=t))},isValidSelector:function(e){var t=!1;return e&&s(e)&&(o.hasOwnProperty(e)||(o[e]=!/\S/.test(e.replace(/\s+|\s*[+~>]\s*/g," ").replace(/([^ ])\[.*?\]/g,"$1").replace(/([^ ])::?[a-z][a-z\-]+[a-z](?:\(.*?\))?/ig,"$1").replace(/(?:^| )[a-z0-6]+/ig," ").replace(/\\./g,d).replace(/[.#]\w[\w\-]*/g,d))),t=o[e]),t}},!0),e.StyleSheet=v},"3.16.0",{requires:["yui-base"]});
/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("content-editable",function(e,t){var n=e.Lang,r=e.Node,i="contentready",s="ready",o="p",u="blur",a="container",f="contentEditable",l="",c="focus",h="host",p="innerHTML",d="key",v="parentNode",m="paste",g="Text",y="use",b=function(){b.superclass.constructor.apply(this,arguments)};e.extend(b,e.Plugin.Base,{_rendered:null,_instance:null,initializer:function(){var e=this.get(h);e&&(e.frame=this),this._eventHandles=[],this.publish(s,{emitFacade:!0,defaultFn:this._defReadyFn})},destructor:function(){(new e.EventHandle(this._eventHandles)).detach(),this._container.removeAttribute(f)},_onDomEvent:function(e){var t;e.frameX=e.frameY=0,(e.pageX>0||e.pageY>0)&&e.type.substring(0,3)!==d&&(t=this._container.getXY(),e.frameX=t[0],e.frameY=t[1]),e.frameTarget=e.target,e.frameCurrentTarget=e.currentTarget,e.frameEvent=e,this.fire("dom:"+e.type,e)},_DOMPaste:function(e){var t=this.getInstance(),n=l,r=t.config.win;e._event.originalTarget&&(n=e._event.originalTarget),e._event.clipboardData&&(n=e._event.clipboardData.getData(g)),r.clipboardData&&(n=r.clipboardData.getData(g),n===l&&(r.clipboardData.setData(g,n)||(n=null))),e.frameTarget=e.target,e.frameCurrentTarget=e.currentTarget,e.frameEvent=e,n?e.clipboardData={data:n,getData:function(){return n}}:e.clipboardData=null,this.fire("dom:paste",e)},_defReadyFn:function(){var t=this.getInstance(),n=this.get(a);e.each(b.DOM_EVENTS,function(r,i){var s=e.bind(this._onDomEvent,this),o=e.UA.ie&&b.THROTTLE_TIME>0?e.throttle(s,b.THROTTLE_TIME):s;t.Node.DOM_EVENTS[i]||(t.Node.DOM_EVENTS[i]=1),r===1&&i!==c&&i!==u&&i!==m&&(i.substring(0,3)===d?this._eventHandles.push(n.on(i,o,n)):this._eventHandles.push(n.on(i,s,n)))},this),t.Node.DOM_EVENTS.paste=1,this._eventHandles.push(n.on(m,e.bind(this._DOMPaste,this),n),n.on(c,e.bind(this._onDomEvent,this),n),n.on(u,e.bind(this._onDomEvent,this),n)),t.__use=t.use,t.use=e.bind(this.use,this)},_onContentReady:function(t){if(!this._ready){this._ready=!0;var n=this.getInstance(),o=e.clone(this.get(y));this.fire(i),t&&(n.config.doc=r.getDOMNode(t.target)),o.push(e.bind(function(){n.EditorSelection&&(n.EditorSelection.DEFAULT_BLOCK_TAG=this.get("defaultblock"),n.EditorSelection.ROOT=this.get(a)),this.fire(s)},this)),n.use.apply(n,o)}},_getDefaultBlock:function(){return this._getHostValue("defaultblock")},_getDir:function(){return this._getHostValue("dir")},_getExtraCSS:function(){return this._getHostValue("extracss")},_getHTML:function(){var e,t;return this._ready&&(t=this.get(a),e=t.get(p)),e},_getHostValue:function(e){var t=this.get(h);if(t)return t.get(e)},_setHTML:function(t){if(this._ready){var n=this.get(a);n.set(p,t)}else this.once(i,e.bind(this._setHTML,this,t));return t},_setLinkedCSS:function(t){if(this._ready){var n=this.getInstance();n.Get.css(t)}else this.once(i,e.bind(this._setLinkedCSS,this,t));return t},_setDir:function(t){var n;return this._ready?(n=this.get(a),n.setAttribute("dir",t)):this.once(i,e.bind(this._setDir,this,t)),t},_setExtraCSS:function(t){if(this._ready){if(t){var n=this.getInstance(),s=n.one("head");this._extraCSSNode&&this._extraCSSNode.remove(),this._extraCSSNode=r.create("<style>"+t+"</style>"),s.append(this._extraCSSNode)}}else this.once(i,e.bind(this._setExtraCSS,this,t));return t},_setLang:function(t){var n;return this._ready?(n=this.get(a),n.setAttribute("lang",t)):this.once(i,e.bind(this._setLang,this,t)),t},_instanceLoaded:function(t){this._instance=t,this._onContentReady();var n=this._instance.config.doc;if(!e.UA.ie)try{n.execCommand("styleWithCSS",!1,!1),n.execCommand("insertbronreturn",!1,!1)}catch(r){}},_validateLinkedCSS:function(e){return n.isString(e)||n.isArray(e)},use:function(){var t=this.getInstance(),r=e.Array(arguments),i=!1;return n.isFunction(r[r.length-1])&&(i=r.pop()),i&&r.push(function(){i.apply(t,arguments)}),t.__use.apply(t,r)},delegate:function(e,t,n,r){var i=this.getInstance();return i?(r||(r=n,n=this.get(a)),i.delegate(e,t,n,r)):!1},getInstance:function(){return this._instance},render:function(t){var n,i,s;return this._rendered?this:(t&&this.set(a,t),container=this.get(a),container||(container=r.create(b.HTML),e.one("body").prepend(container),this.set(a,container)),this._rendered=!0,this._container.setAttribute(f,!0),n=e.clone(this.get(y)),s=e.bind(function(){i=YUI(),i.host=this.get(h),i.use("node-base",e.bind(this._instanceLoaded,this))},this),n.push(s),e.use.apply(e,n),this)},focus:function(){return this._container.focus(),this},show:function(){return this._container.show(),this.focus(),this},hide:function(){return this._container.hide(),this}},{THROTTLE_TIME:100,DOM_EVENTS:{click:1,dblclick:1,focusin:1,focusout:1,keydown:1,keypress:1,keyup:1,mousedown:1,mouseup:1,paste:1},HTML:"<div></div>",NAME:"contentEditable",NS:f,ATTRS:{dir:{lazyAdd:!1,validator:n.isString,setter:"_setDir",valueFn:"_getDir"},container:{setter:function(t){return this._container=e.one(t),this._container}},content:{getter:"_getHTML",lazyAdd:!1,setter:"_setHTML",validator:n.isString,value:"<br>"},defaultblock:{validator:n.isString,value:o,valueFn:"_getDefaultBlock"},extracss:{lazyAdd:!1,setter:"_setExtraCSS",validator:n.isString,valueFn:"_getExtraCSS"},id:{writeOnce:!0,getter:function(t){return t||(t="inlineedit-"+e.guid()),t}},lang:{validator:n.isString,setter:"_setLang",lazyAdd:!1,value:"en-US"},linkedcss:{setter:"_setLinkedCSS",validator:"_validateLinkedCSS"},node:{readOnly:!0,value:null,getter:function(){return this._container}},use:{validator:n.isArray,writeOnce:!0,value:["node-base","editor-selection","stylesheet"]}}}),e.namespace("Plugin"),e.Plugin.ContentEditable=b},"3.16.0",{requires:["node-base","editor-selection","stylesheet","plugin"]});
/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("editor-inline",function(e,t){var n=function(){n.superclass.constructor.apply(this,arguments)};e.extend(n,e.EditorBase,{initializer:function(){this.plug(e.Plugin.ContentEditable)}}),e.InlineEditor=n},"3.16.0",{requires:["editor-base","content-editable"]});
YUI.add("mail-services-message-service",function(B){function A(){var D=arguments[0]||{},C=D.stopwatch||null,F=D.cacheKey||"Prime",E=D.truncateAt||null;return{get:function(H,G){return(new Promise(function(J,I){if(C){C.CMGStart=new Date();}B.mail.Controller.Messages.get({fid:G,msg:{mid:H},cachekey:F,ovparams:{truncateAt:E}},{success:function(L,K){if(C){C.CMGEnd=new Date();C.wasCached=K.respProps.wasCached;}if(!L||!L.mid){I();}J(L);},failure:function(){I();}});}));}};}B.namespace("mail.Services").MessageService=A;},"1.0.0",{requires:["mail-controller-messages"]});YUI.add("mail-ui-mailcompose",function(F){var W=F.common.Utils.substitute,e=F.mail.Controller.Compose,G=F.common.Utils,Q=F.mail.model.DataStore,d=G.log,L=F.ui.Templates,Z={"reply_sender":strings.str_reply,"reply_all":strings.str_reply,"edit":strings.str_reply,"forward":strings.str_forward},H=L._shared_module_compose_message_header_fresh;var a=function(Y,h,f,i){var k=this,j=i&&i.showSubject;k.header=new F.mail.compose.HeaderBaseConv(Y,k);k.cdo=Y;k.isDraft=h;k.title=strings.str_comp_nosubject;k.parent=null;k.baseNode=null;k.compArea=null;k.loadingArea=null;k.type="compose";k.dirty=false;k.focusNode=null;k.container=f;k.attachmentsLoading=[];k.attView=null;k.loadingTimer=null;k.allowEdit=false;k.allowSend=true;k.richFontInfo={fontFamily:null,fontSize:null};k.draftMID=null;k.saveTimer=null;k.hasHardDraft=false;k.blockAutoSave=false;k.lastSave=null;k.lastSaveType=null;k.isSending=false;k.isSaving=false;Q.Sessions.reset();var g={m:"mailcompose init"};if(k.cdo.oComposeData.origin.action===null){g.action="new";}else{g.action=k.cdo.oComposeData.origin.action;}d(g);k.cancelDialogLoad=false;k.contentLoaded=false;k.stopwatch=i?i.stopwatch:null;k.origMsgFID=i?i.fid:null;k.suppressDialog=false;k.formatTmpl=L._shared_module_rte_well_content_format_fresh;k.handles=[];k.autoSaveTime=(NeoConfig.autoSaveInSec||120)*1000;k.formatters={page_well_email:function(){return W(L._shared_module_rte_well_tabs_compose.base,{},k.wellTabFormatters,null,strings,L);},page_well_format:function(){return W(k.formatTmpl.base,{},k.formatters,null,strings,L);},page_well_format_fresh:function(){return W(k.formatTmpl.base,{},k.formatters,null,strings,L);},page_well_emoticons:function(){return W(L._shared_module_rte_well_content_emoticons.base,{},k.formatters,null,strings,L);},page_well_attachments:function(){return W(L._shared_module_rte_well_content_attachments.base,{},k.formatters,null,strings,L);},quick_reply_card_actions:function(){return W(H.quick_reply_card_actions,{},k.formatters,0,strings,L);},quickCompose:function(){if(k.get("isQuickReply")){return W(H.quickCompose,{},0,0,strings,L);}},make_reply_all:function(){if(k.get("isQuickReply")){return;}var n=k.cdo.oComposeData.origin,l=n.action,m={title:(l==="reply_all"||n.fid==="Sent")?strings.str_comp_btn_reply_sender:strings.str_comp_btn_reply_all};return((l!=="reply_all"&&l!=="reply_sender")?"":W(H.make_reply_all,m,0,0,strings));},make_reply_all_qr:function(){var n=k.cdo.oComposeData.origin,l=n.action,m={title:(l==="reply_all"||n.fid==="Sent")?strings.str_comp_btn_reply_sender:strings.str_comp_btn_reply_all};return((l!=="reply_all"&&l!=="reply_sender")?"":W(H.make_reply_all_qr,m,0,0,strings));},spellCheckEnabled:function(){if(strings.str_tog_spellcheckEnabled){return W(k.formatTmpl.spellCheckEnabled,{HiddenClassName:""},k.formatters,null,strings,L);}else{return W(k.formatTmpl.spellCheckEnabled,{HiddenClassName:" hidden"},k.formatters,null,strings,L);}},is_rtl:function(){var l;if(NeoConfig.bidi){l=strings.str_tog_loadRTLCss?k.formatTmpl.is_rtl:k.formatTmpl.is_rtl_else;return W(l,{},k.formatters,null,strings,L);}else{return"";}},bidi:function(){if(NeoConfig.bidi){return W(k.formatTmpl.bidi,{},k.formatters,null,strings,L);}else{return"";}},page_compose_conversation:function(){return"";},compose_from_address:function(){return W(H.compose_from_address,{},k.formatters,null,strings,L);},timestamp_id:function(){return(new Date()).getTime();},fromSelected:function(l){return(l.isDefault?' selected="selected" class="nsel"':"");},fromAddress:function(l){if(typeof l==="string"){return l;}else{if(typeof l==="object"&&typeof l.address==="string"){return l.address;}}return"";},global_path_img:function(){return NeoConfig.globalPathImg+"/u/assets/img";},display_av_logo:function(){return NeoConfig.avLogoUrl?W(L._shared_module_rte_well_content_file_count.display_av_logo,{},k.formatters,null,strings,L):"";},antivirus_logo_path_img:function(){return NeoConfig.avLogoUrl;},page_compose_email_else:function(){return"hidden";},reply_type:function(){var m=k.cdo.oComposeData.origin,l=m.action;return l?Z[l]:strings.str_reply;},smartscroll:function(){return G.features.enabled("smartscroll")?L._shared_module_compose_fresh_conv.smartscroll:"";},inConvReplyBucketBorder:function(){return G.features.enabled("convReplyBucket")?L._shared_module_compose_fresh_conv.inConvReplyBucketBorder:"";},intl_fonts:function(){function m(q,o){var p=L._shared_module_rte_well_content_fontnamesize_fresh;return W(p.intl_fonts,{},{font_value:function(){return q;},font_name:function(){return o;}},null,strings,L);}var l="";if(strings.str_cfg_intl_fonts){var n=F.JSON.parse(strings.str_cfg_intl_fonts);F.Array.each(n,function(o){l+=m(o.value,o.name);});}return l;},show_formatter_well:function(){return W(L._shared_module_rte_well_fresh_conv.show_formatter_well,{},k.formatters,null,strings,L);},show_attachment_icon:function(){if(NeoConfig.useAttComposerTT){return W(L._shared_module_rte_well_fresh_conv.show_attachment_icon,{},k.formatters,null,strings,L);}else{return"";}},bottomToolbar:function(){return W(L._shared_module_compose_fresh.bottomToolbar,{},k.formatters,null,strings,L);},subject_hidden:function(){return k.get("isQuickReply")&&!j?H.subject_hidden:"";},less_than_IE10:function(){var l=F.UA.ie>0&&F.UA.ie<10;return l?W(H.less_than_IE10,{},k.formatters,null,strings,L):"";},is_underline:function(){if(NeoConfig.enableUnderline){return W(k.formatTmpl.is_underline,{},k.formatters,null,strings,L);}else{return"";}},has_quote:function(){var m=k.cdo.oComposeData.origin,l=m.action;if(NeoConfig.hasConv&&(l==="reply_sender"||l==="reply_all"||l==="edit")){return W(L._shared_module_compose_message_body.has_quote,{},k.formatters,null,strings,L);}}};a.superclass.constructor.call(k);k.addChild(k.header);k.header.on("HeaderBase:updateSubject",function(){k.neoFire("composeEvent",{action:"updateSubject"});});k.header.on("HeaderBase:qrCancel",function(){k.neoFire("composeEvent",{action:"qrCancel"});});k.cdo.after("saveactionChange",function(m){var l=m.newVal;
if(l&&k.cdo){if(l.state===1){k.saveProgress(l);}else{if(l.state===0||l.state===-2){k.saveSuccess(l);}else{k.saveFailure(l);}}}});};function X(){var Y=this;a.superclass.ondestroy.call(Y,arguments);}function M(){var Y=this;return Y.dirty;}function C(){var Y=this;return Y.draftMID===null?false:true;}function K(j,i,h,g,Y){var k=this,f=j?j:strings.str_comp_dialogheader;if(k.suppressDialog===true){h();return;}F.use("common-ui-dialog-helper",function(m){var l={hd:f,bd:i,suppressRestoreFocus:true};m.common.ui.DialogHelper.confirm(l,{ok:{text:Y,handler:h},cancel:{handler:function(){k._restoreFocus();if(g){g();}}}});});if(k.hiliteCP){k.hiliteCP.hide();}if(k.textCP){k.textCP.hide();}}function V(){var h=this,f=h.attachmentsLoading,Y,g;if(h.cdo&&!h.cdo.attachments){return 0;}if(NeoConfig.useAttComposerTT&&h.cdo){return !h.cdo.attachments.areAllUploadsDone();}if(!f){return 0;}Y=f.length;for(g=0;g<Y;g++){if((f[g]*1)){return 1;}}return 0;}function U(Y){var f=this;f.focusNode=Y;f.neoFire("composeEvent",{action:"setFocusNode",focusNode:Y});}function P(){var Y=this;Y.setFocus(Y.focusNode);}function c(){var Y=this;if(!Y.isSending&&!Y.isSaving){Y.fire("compose:dirty");Y.dirty=true;Y.resetSaveTimer();}}function B(){var Y=this;if(Y.saveTimer){Y.saveTimer.cancel();}if(!NeoConfig.isAMT){Y.saveTimer=F.later(Y.autoSaveTime,Y,function(){Y._invokeSaveDraft({auto:true,silent:true});d("#SS invokeDraftSave inside timer:saving: "+((Y.isSaving)?"true":"false"));Y.saveTimer.cancel();},[],false);}}function O(){var Y=this;if(Y.saveTimer){Y.saveTimer.cancel();Y.saveTimer=null;}}function D(g,f){var h=this,Y=g?g:strings.str_comp_dialogheader;if(h.allowSend){F.use("common-ui-dialog-helper",function(k){h.allowSend=false;var j={hd:Y,bd:f,suppressRestoreFocus:true};var i=function(){h.allowSend=true;h._restoreFocus();};k.common.ui.DialogHelper.alert(j,{ok:{handler:i},cancel:{handler:i}});});}else{h._restoreFocus();}}function S(f){var j=this,g,i={},Y,h;if(j.isSaving||j.isSending){return true;}else{if(!j.contentLoaded){return false;}else{if(typeof f==="undefined"&&!j.dirty){if(j.lastSave){j.saveProgress(true);setTimeout(function(){j.updateSaveText();},500);}return false;}}}f=f||{};if(!f.forceSave){if(f.auto&&(j.blockAutoSave||!j.dirty)){j.resetSaveTimer();return false;}}if(!f.retry){j.lastSaveType=null;}if(f.auto){i.auto=true;}j.isSaving=true;d("#SS: _invokeSaveDraft, isSave:1");g=j.assembleSendBody(true);Y={header:j._getHeader(true),textcontent:g.text,content:g.html};j.cdo.updateData(Y);h=j.draftMID&&j.cdo&&j.cdo.attachments.getAll().length;if(f.silent){i.silent=true;}else{if(f.retry){i.silent=false;}else{i.silent=h;}}i.isRetryable=h;i.cdo=j.cdo;i.author=j.container;i.mid=j.draftMID;e.save(i);if(j._isSpellCheckActive()){j._doSpellCheck();}return true;}function E(){var Y=this;if(Y.cdo===null){return;}Y.updateSaveText(true);}function J(g){if(this.cdo===null){return;}var l=this,i,k,h,Y;l.draftMID=g.mid;g=g||{};if(NeoConfig.useAttComposerTT){i=l.cdo.attachments;}if(l.dirty!=="ForceClose"&&!l.areAttachmentsPending()){l.dirty=false;}if(i&&i.getAll().length&&l.origMsgFID&&l.origMsgFID!=="Draft"&&!l.lastSave){Y=F.later(10000,l,function(){l.isSaving=false;});var f="Draft",m=new F.mail.Services.MessageService({cacheKey:"SaveMessage"}),j=m.get(g.mid,f);j.then(function(p){Y.cancel();l.isSaving=false;return p;}).then(function n(p){l.fire("compose:getDisplayMessageResponse",p);},function o(){});}else{l.isSaving=false;if(NeoConfig.useAttComposerTT){F.Array.each(i.getAll(),function(p){k=p.original;if(k&&k.fid==="Draft"){k.mid=g.mid;}});}if(l.cdo.get("isRichText")){NeoConfig.hasConv?h=l.baseNode:h=l.getRTEDocNode();h.all("img").each(function(p){var q=p.get("src");if(q.indexOf("ya/download")!==-1&&q.indexOf("fid=Draft")!==-1){q=q.replace(/mid=.*?([&'">])/,"mid="+encodeURIComponent(g.mid)+"$1");p.set("src",q);}});}}l.lastSaveType=g.auto?1:0;l.lastSave=G.dateFormatter(new Date(),strings.str_tog_dateformat_rsstime_l10n);l.updateSaveText();l.resetSaveTimer();if(!g.auto){l.hasHardDraft=true;}l.fire("compose:saveSuccess",g);}function N(g){var k=this,l=g.mid||k.draftMID,m=k.lastSaveType,j,Y=false,h=false,f;g=g||{};k.lastSaveType=-1;if(k.cdo){j=k.cdo.attachments.getAll();Y=(j.length>0);if(Y){h=!F.Array.every(j,function(n){if(n.referencedInline===true||n.disposition==="inline"){return false;}return true;});}}if(m!==-1){if(l&&Y){f=F.later(10000,k,function(){k.isSaving=false;});F.mail.Controller.Messages.get({fid:"Draft",msg:{mid:l},cachekey:"SaveMessage",noCache:true},function(n){f.cancel();k.isSaving=false;if(!n||!n.mid||!n.part){}else{k.fire("compose:getDisplayMessageResponse",n);k._invokeSaveDraft({auto:g.auto,silent:g.auto?true:false,retry:true});}});return;}}k.updateSaveText();k.neoFire("composeEvent",{action:"saveComplete",saveSuccess:false});if(!g.auto){var i=k.allowSend;k.allowSend=true;k._alertProblem(strings.str_comp_title_saveasdraftfail,strings.str_comp_saveasdraftfail);k.allowSend=i;}k.isSaving=false;k.fire("compose:saveFail");}function T(){var h=this,Y=h.richFontInfo,g=Y.fontFamily,f=Y.fontSize;if(!g){g=e.getStyleFontFamily(false);}if(!f){f=e.getStyleFontSize(false);}return{fontFamily:g,fontSize:f,foreColor:Y.foreColor,backColor:Y.backColor};}function b(){var g=this,Y=g.areAttachmentsPending(),f='<button id="{{btnID}}ModalOverlay" class="btn left right {{default}}" data-action="{{btnID}}">{{btnLabel}}</span>';F.use("common-ui-dialog-helper",function(h){var p=W(f,{btnID:"SaveDraft","default":"default",btnLabel:strings.str_comp_savetodrafts_fresh}),k=W(f,{btnID:"DontSave",btnLabel:(Y?strings.str_comp_closewithoutsaving:strings.str_comp_abandon)}),i=W(f,{btnID:"Continue","default":(Y?"default":""),btnLabel:(Y?strings.str_comp_returntomessage:strings.str_comp_keepwriting)}),n=Y?(i+k):(p+k+i),o=(Y?strings.str_comp_close_attachmentprocessing:strings.str_comp_close_confirm),j={modal_classes:"lg saveDraftDialog",hd:strings.str_comp_close,bd:o,ft:n,suppressRestoreFocus:true},l={SaveDraft:{handler:function(){g._invokeSaveDraft();if(g.header){g.header.hideACWidget();
}g.dirty="ForceClose";g._closeAfterWarning(true);}},DontSave:{handler:function(){if(g.header){g.header.hideACWidget();}g.dirty="ForceClose";if(!g.hasHardDraft&&g.draftMID){h.use("mail-ui-proxyevents",function(){h.mail.ui.MailEventsProxy.handleUI({action:"delete"},"Draft",null,[{fid:"Draft",mid:g.draftMID,force:true}]);});}g._closeAfterWarning(false);}},Continue:{handler:function(){g.blockAutoSave=false;g.cancelDialogLoad=false;g._restoreFocus();}}},m=function(q){g.blockAutoSave=true;if(q){h.one(".compose").focus();}h.common.ui.DialogHelper.createCommon(j,l,function(r){r.set&&r.set("adAction","disableRetriggerOnOk");});};g.neoFire("composeEvent",{action:"showSaveDialog",sdcbk:h.bind(m,g),sdinline:(g.type==="inlineCompose")});});}function R(){return this.draftMID;}function I(g){var i=this,f=i.areAttachmentsPending(),h='<span id="{{btnID}}ModalOverlay" class="btn left right {{default}}"><a href="#" data-action="{{btnID}}">{{btnLabel}}</a></span>';function Y(){if(i.draftMID){F.use("mail-ui-proxyevents",function(){F.mail.ui.MailEventsProxy.handleUI({action:"delete"},"Draft",null,[{fid:"Draft",mid:i.draftMID,force:true}]);});}}if(!g){Y();return;}F.use("common-ui-dialog-helper",function(p){var q=W(h,{btnID:"Discard","default":"default",btnLabel:strings.str_comp_discard}),j=W(h,{btnID:"Continue","default":(f?"default":""),btnLabel:strings.str_comp_keepwriting}),m=f?(j+q):(q+j),n=(f?strings.str_comp_discard_attachmentprocessing:strings.str_comp_discard_confirm),l={modal_classes:"lg",hd:strings.str_comp_deletedraft,bd:n,ft:m,suppressRestoreFocus:true},k={Discard:{handler:function(){if(i.header){i.header.hideACWidget();}i.dirty="ForceClose";Y();i._closeAfterWarning(false);}},Continue:{handler:function(){i.blockAutoSave=false;i.cancelDialogLoad=false;i._restoreFocus();}}},o=function(){i.blockAutoSave=true;p.common.ui.DialogHelper.createCommon(l,k,function(r){r.set&&r.set("adAction","disableRetriggerOnOk");});};i.neoFire("composeEvent",{action:"showDeleteDraftDialog",sdcbk:p.bind(o,i)});});}function A(Y){var j=this,i=j.baseNode&&j.baseNode.one(".attachment-button-attach"),h=j.baseNode&&j.baseNode.one("#rtetext");if(F.UA.gecko>0&&h){h.focus();h.blur();}j.cancelDialogLoad=true;if(j.hiliteCP){j.hiliteCP.hide();}if(j.textCP){j.textCP.hide();}if(j.dirty==="ForceClose"){return true;}var g=j.isDirty()||(j.draftMID&&!j.hasHardDraft&&!Y),f=j.areAttachmentsPending();if(f){g=j.dirty=1;}if(j.get("isQuickReply")){j.doDiscardDraft(g);}else{if(g){j.showSaveDraftDialog();}else{i&&i.fire("compose:close");}}return !g;}F.extend(a,F.mail.ui.BaseWidget);F.mix(a.prototype,{NAME:"MailCompose",isDirty:M,_setDirty:c,_getHeader:function(){return this.header.getHeader();},_setHeader:function(Y){this.header.setHeader(Y);},isSaved:C,areAttachmentsPending:V,resetSaveTimer:B,canClose:A,showSaveDraftDialog:b,doDiscardDraft:I,getDraftMID:R,getRichFontInfo:T,saveSuccess:J,saveFailure:N,saveProgress:E,_alertProblem:D,_invokeSaveDraft:S,_cancelSaveTimer:O,_closeAfterWarning:function(){},_registerFocus:U,_restoreFocus:P,confirm:K,ondestroy:X},true);F.namespace("mail.ui");F.mail.ui.MailComposeConv=a;},"1.0.0",{requires:["autocomplete_css","common-persist-user-data","mail-persist-meta-data","mail-controller-messages","mail-model-datastore","mail-controller-compose","_shared_module_compose_message_header_fresh","mail-ui-mailcompose-base-header-conv","comms-utils","mail-ui-basewidget","editor-inline","mail-services-message-service"]});YUI.add("mail-ui-rte-formatter",function(C){var L=C.ui.Templates,O=C.Node.create,I=C.common,D=I.Utils,S=D.substitute,Q,M,F=[10,13,16,0,24,32,48],U="hidden",a={"align-l":"justifyleft","align-c":"justifycenter","align-r":"justifyright",inserthrule:"inserthorizontalrule",insertlink:"createlink",setfontstyle:"fontname",setfontsize:"fontsize",insertnumberedlist:"insertorderedlist",color:"notyet",hilitecolor:"notyet"};function R(Y){var b=this;Y=Y||{};R.superclass.constructor.call(b,Y);b.formatTmpl=Y.formatTmpl||L._shared_module_rte_well_content_format_fresh;b.baseNode=null;b.editor=Y.editor;b.globalPathImage=Y.globalPathImage||null;b.fontColorMenu=null;b.fontSizeMenu=null;b.fontNameMenu=null;b.selectedFCValue="#000000";b.selectedFC=null;b.selectedFBValue="transparent";b.selectedFB=null;b.selectedFSIndex=-1;b.selectedFS=null;b.selectedFNIndex=-1;b.selectedFN=null;b.formatButtons=null;b.emotionMenu=null;b.textIndentation=null;b.textAlignment=null;b.textLists=null;b.fontFamilyOptions=null;b.formatters=Y.formatters||{spellCheckEnabled:function(){if(M){return S(b.formatTmpl.spellCheckEnabled,{HiddenClassName:""},b.formatters,null,strings,L);}else{return S(b.formatTmpl.spellCheckEnabled,{HiddenClassName:" hidden"},b.formatters,null,strings,L);}},is_rtl:function(){var c;if(Q){c=strings.str_tog_loadRTLCss?b.formatTmpl.is_rtl:b.formatTmpl.is_rtl_else;return S(c,{},b.formatters,null,strings,L);}else{return"";}},bidi:function(){if(Q){return S(b.formatTmpl.bidi,{},b.formatters,null,strings,L);}else{return"";}}};b.handles=[];Q=Y.isBidi;M=Y.isSpellCheckEnabled;}function B(d,b,Y){var f=this,e;f.baseNode=d;if(!d.one("div.format-pane")){var c=S(f.formatTmpl.base,null,f.formatters,null,strings,L);if(b){Y.insert(c,b);}else{f.baseNode.appendChild(c);}}e=d.one("div.format-pane");f.formatButtons=e.all('span[role="button"]');f.fontFamilyOptions=e.all("span.showFontStyle select option");}function V(){var g=this,b,c=["bold","italic","underline"],f,Y=g.handles,e=g.baseNode.one("div.attachments-well");e&&e.addClass(U);f=g.baseNode.one("div.format-pane");b=f.all("select");Y.push(C.on("change",function(h){g._invokeAction(h.currentTarget.get("parentNode"),h.currentTarget.get("value"));},b));var d=f.all('span[role="button"]');Y.push(C.on(["mousedown","keydown"],function(j){if(j.type==="keydown"&&j.keyCode!==13){return;}var i=j.currentTarget,h=i.getAttribute("data-action"),k="cmps_wl_";if(h==="menu"){k+=i.get("id");}else{k+=h;}C.fire("mt:click",{action:k,append:{t1:"cmpsTb"}});j.preventDefault();g._invokeAction(j.currentTarget,"");},d));d.each(function(j){var k,h=c.length,l=j.getAttribute("data-action");if(l){for(k=0;k<h;k++){if(c[k]===l){j.addClass("btnpress");}}}});g.editor.on("nodeChange",function(h){g.updateRTToolbar(h);});}function H(b,c,e){var d=this,Y;C.use("editor-lists",function(f){d.editor.plug(f.Plugin.EditorLists);Y=b.getAttribute("data-action");if(!Y){return;}if(Y==="color"||Y==="hilitecolor"){}else{if(Y==="menu"){d._showMenus(b);}else{if((Y==="bold")||(Y==="italic")||(Y==="underline")){b.toggleClass("pressed");}else{if(Y&&Y==="bidi"){if(!e){c=b.getAttribute("value");}}}d._invokeDataAction(Y,c);}}});}function A(Y,f){var g=this,d=a[Y],e,b,c;if(d){Y=d;}if(Y==="notyet"){return;}else{if(Y==="forecolor"){g.selectedFCValue=f;}else{if(Y==="backcolor"){g.selectedFBValue=f;}else{if(Y==="fontname"){g.selectedFNIndex=f;}else{if(Y==="fontsize"){g.selectedFSIndex=f;}else{if(Y==="emoticon"){C.later(10,g,function(){c=f.indexOf("*");e=f.slice(0,c);e=e.replace(/emoticon_(\d+)/,g.globalPathImage+"/emoticons/emo$1.gif");b=f.slice(c);b=b.replace(/"/,"&quot;").replace(/</,"&lt").replace(/>/,"&gt;").replace(/&/,"&amp;");f='<img src="'+e+'" alt="'+b+'" title="'+b+'">';Y="insertandfocus";g.editor.invokeCommand(Y,f);g.fire("formatter:action",{act:Y,val:f});},null,null);return;}else{if(C.UA.gecko>0&&Y==="createlink"){g.fontNameSizeMenu&&g.fontNameSizeMenu.hide();g.fontColorMenu&&g.fontColorMenu.hide();g.textIndentation&&g.textIndentation.hide();g.textAlignment&&g.textAlignment.hide();g.textLists&&g.textLists.hide();g.emotionMenu&&g.emotionMenu.hide();}}}}}}}g.editor.invokeCommand(Y,f);g.fire("formatter:action",{act:Y,val:f});}function K(b){var i=this,f,d,k,n,l,c,j,h,g,o,p,Y,m=false,e=null;l=b.get("id");if(b.menu){if(l==="btn-fontnamesize"){i.selectFontNameInMenu(i.fontNameMenu,i.selectedFNIndex);i.selectFontSizeInMenu(i.fontSizeMenu,i.selectedFSIndex);}if(l==="btn-forecolor"){i.selectFontColorInMenu(i.fontColorMenu,"both");}return;}switch(l){case"btn-text-align":e={x:-2,menuUpY:0,menuDownY:0};f=L._shared_module_offscreen_bin_compose_menu_text_align.base;break;case"btn-indent":e={x:-2,menuUpY:0,menuDownY:0};f=L._shared_module_offscreen_bin_compose_menu_indent.base;break;case"btn-fontnamesize":Y=S(L._shared_module_rte_well_content_fontnamesize_fresh.base,null,{intl_fonts:function(){function r(v,t){var u=L._shared_module_rte_well_content_fontnamesize_fresh;return S(u.intl_fonts,{},{font_value:function(){return v;},font_name:function(){return t;}},null,strings,L);}var q="";if(strings.str_cfg_intl_fonts){var s=C.JSON.parse(strings.str_cfg_intl_fonts);C.Array.each(s,function(t){q+=r(t.value,t.name);});}return q;}},null,strings);break;case"btn-insertunordered":e={x:-2,menuUpY:0,menuDownY:0};f=L._shared_module_offscreen_bin_compose_menu_list.base;break;case"emoticon":f=L._shared_module_rte_well_content_emoticons_fresh.base;break;case"btn-forecolor":case"btn-backcolor":j=[["000000","808080","ffffff"],["9d1811","cd232c","d36a53"],["a46016","dd902f","e4ac64"],["ac9e19","fdef2b","fdf869"],["5b8828","8fca40","add773"],["4c76a2","70aced","7dbef1"],["440062","652191","845aa7"],["9c005c","cb008e","d264aa"]];h=j[0].length;g=j.length;f=["<div id='menu-color-picker' class='optionMenu colorPickerMenu'>"];d=["<div class='groupie'><span class='swatchTitle'>{{groupie_title}}</span>"];for(o=0;o<g;o++){d.push("<ul data-action='{{swatchaction}}'>");for(p=0;p<h;p++){k=j[o][p];if(k==="ffffff"){n=";' class='white' ";}else{if(k==="000000"){n=";' class='black' ";}else{n=";' ";
}}d.push("<li style='background-color:#",k,n,"data-value='#",k,"'><a href='#'></a></li>");}d.push("</ul>");}d.push("</div>");d=d.join("");f.push(S(d,{swatchaction:"forecolor",groupie_title:strings.str_rte_forecolor_title},null,null,strings));d=d.replace("<li style='background-color:#ffffff;' class='white' data-value='#ffffff'>","<li style='background-color:transparent;' title='{{str_rte_no_color}}' class='transparent' data-value='transparent'><a class='icon icon-none'></a>");f.push(S(d,{swatchaction:"backcolor",groupie_title:strings.str_rte_backcolor_title},null,null,strings));f.push("</div>");f=f.join("");break;default:break;}if(f){Y=S(f,null,null,null,strings);}if(Y){c=i._showRTEMenu(Y,b,m,e,function(q){i.handles.push(q.on("menuSelected",function(r){i._invokeDataAction(r.dataAction,r.dataValue);}));});}}function Z(i,e,g,d,b){var f=this,c=O(i),Y=c.get("id"),h=["comms-ui-menu-base"];C.one("body").appendChild(c);switch(Y){case"menu-color-picker":f.fontColorMenu=c;break;case"menu-fontnamesize":f.fontNameSizeMenu=c;f.fontSizeMenu=c.one("#menu-fontsize");f.fontNameMenu=c.one("#menu-fontname");break;case"menu-emoticon":h.push("emoticon_css");f.emotionMenu=c;break;case"menu-list":f.textLists=c;break;case"menu-indent":f.textIndentation=c;break;case"menu-text-align":f.textAlignment=c;break;default:break;}C.use(h,function(k){e.plug(k.Plugin.Menu,{"menu":c,"overlap":g,"offset":d||null,"dontFocus":true});if(e.get("id")==="btn-forecolor"){f.selectFontColorInMenu(f.fontColorMenu,null,null);}if(Y==="menu-fontnamesize"){f.selectFontSizeInMenu(f.fontSizeMenu,f.selectedFSIndex);f.selectFontNameInMenu(f.fontNameMenu,f.selectedFNIndex);}f.handles.push(c.on("menu:state",function(l){if(l.state==="show"){k.fire("ToolTips:hideTooltips");e.addClass("pressed");}else{if(l.state==="hide"){e.removeClass("pressed");}}}));e.menu.show();function j(l){switch(l.keyCode){case 13:case 32:l.currentTarget.simulate("mousedown");break;default:break;}}f.handles.push(c.delegate("keydown",j,"li"));f.handles.push(c.delegate("mousedown",function(q){q.halt();var p=q.target,o=q.currentTarget,m=p.ancestor(function(s){return s.getAttribute("data-action");},true),n=m?m.getAttribute("data-action"):o.getAttribute("data-action")||0,l=p.ancestor(function(s){return s.getAttribute("data-value");},true),r=l?l.getAttribute("data-value"):"";c.fire("menuSelected",{dataAction:n,dataValue:r,item:l});e.menu&&e.menu.hide();},"li"));b(c);});return c;}function P(f,Y,d){var h=this;var e,c,g,b;e=c=false;if(Y==="fore"){e=true;h.selectedFCValue=d;}else{if(Y==="back"){c=true;h.selectedFBValue=(d==="#ffffff")?"transparent":d;}else{e=c=true;h.selectedFCValue=h.selectedFCValue||"#000000";h.selectedFBValue=h.selectedFBValue||"transparent";}}if(f){if(e&&h.selectedFC){h.selectedFC.removeClass("icon").removeClass("icon-checkmark");}if(c&&h.selectedFB){h.selectedFB.removeClass("icon").removeClass("icon-checkmark");}g=f.all("div.groupie");if(e){b=g.item(0).all("li");h.selectedFC=null;b.each(function(i){if(i.getAttribute("data-value").toLowerCase().indexOf(h.selectedFCValue.toLowerCase())===0){h.selectedFC=i.one("a");}});if(h.selectedFC){h.selectedFC.addClass("icon").addClass("icon-checkmark");}}if(c){b=g.item(1).all("li");h.selectedFB=null;b.each(function(i){if(i.getAttribute("data-value").toLowerCase().indexOf(h.selectedFBValue.toLowerCase())===0){h.selectedFB=i.one("a:not(.icon-none)");}});if(h.selectedFB){h.selectedFB.addClass("icon").addClass("icon-checkmark");}}}}function T(e,Y){var f=this,c,d,b;if(e){if(f.selectedFN!==null){f.selectedFN.removeClass("checked");f.selectedFN.one("i.icon").removeClass("icon-checkmark");}if(!Y){b=f.editor.getDefaultFontInfo(false);Y=b.fontFamily||"";}c=e.all("li[data-value]");c.each(function(g){d=g.getAttribute("data-value");if(d.toLowerCase().indexOf(Y.toLowerCase())>=0){f.selectedFN=g;}});if(f.selectedFN){f.selectedFN.addClass("checked");f.selectedFN.one("i.icon").addClass("icon-checkmark");}}}function E(c,Y){var d=this,b;Y=Y||"";if(c){if(d.selectedFS!==null){d.selectedFS.removeClass("checked");d.selectedFS.one("i.icon").removeClass("icon-checkmark");}if(isNaN(Y)){b=d.editor.getDefaultFontInfo(false);Y=b.fontSize||"";}d.selectedFS=c.one('li[data-value="'+Y+'"]');if(d.selectedFS){d.selectedFS.addClass("checked");d.selectedFS.one("i.icon").addClass("icon-checkmark");}}}function J(Y){var b=this;b.baseNode.one("div.format-pane").all('span[role="button"]').each(function(c){if(!c.hasClass("last")){c.setStyle("display",Y?"":"none");}else{if(Y){c.get("id")==="switchtext-plain"?c.addClass("hidden"):c.removeClass("hidden");}else{c.get("id")==="switchtext-plain"?c.removeClass("hidden"):c.addClass("hidden");}}});}function N(Y){if(Y.length===4){return Y[0]+Y[1]+Y[1]+Y[2]+Y[2]+Y[3]+Y[3];}return Y;}function X(c){if(!this.editor.get("isRich")){return;}var d=this,b,Y;if(!0){b=c.commands;d.formatButtons.removeClass("pressed");d.formatButtons.each(function(g){var f=g.getAttribute("data-action"),e=g.hasClass("btnpress");if(f&&b[f]&&e){g.addClass("pressed");}});if(c.fontColor){d.selectedFCValue=N(c.fontColor);d.selectFontColorInMenu(d.fontColorMenu,"fore",d.selectedFCValue);}d.selectedFBValue=c.backgroundColor?N(c.backgroundColor):"transparent";d.selectFontColorInMenu(d.fontColorMenu,"back",d.selectedFBValue);if(c.fontFamily){d.selectedFNIndex=c.fontFamily;d.selectFontNameInMenu(d.fontNameMenu,d.selectedFNIndex);}if(c.fontSize.indexOf("pt")!==-1){Y=c.fontSize.replace("pt","");d.selectedFSIndex=d._fontSizeMatch(Y);d.selectFontSizeInMenu(d.fontSizeMenu,d.selectedFSIndex);}else{Y=parseInt(c.fontSize.replace("px",""),10);if(!isNaN(Y)){d.selectedFSIndex=d._fontSizeMatch(Y);d.selectFontSizeInMenu(d.fontSizeMenu,d.selectedFSIndex);}else{if(C.UA.webkit){Y=d._fontSizeMatchWebkit(c.fontSize);if(!isNaN(Y)){d.selectedFSIndex=Y-1;}d.selectFontSizeInMenu(d.fontSizeMenu,d.selectedFSIndex);}}}}}function W(e){var f=10000,c,b=e,d,Y=F.length;if(b>7){for(d=0;d<Y;d++){c=Math.abs(e-F[d]);if(c<f){f=c;b=d;}}b++;}return b;}function G(Y){switch(Y){case"-webkit-xxx-large":return 7;
case"xx-large":return 6;case"x-large":return 5;case"large":return 4;case"medium":return 3;case"small":return 2;case"x-small":return 1;}return Y;}C.extend(R,C.mail.ui.BaseWidget);C.namespace("mail.ui").RTEFormatter=R;C.mix(C.mail.ui.RTEFormatter.prototype,{NAME:"RTEFormatter",renderUI:B,bindUI:V,_invokeAction:H,_invokeDataAction:A,_showMenus:K,_showRTEMenu:Z,selectFontColorInMenu:P,selectFontSizeInMenu:E,selectFontNameInMenu:T,_switchEditMode:J,updateRTToolbar:X,_fontSizeMatch:W,_fontSizeMatchWebkit:G});},"1.0.0",{requires:[]});YUI.add("comms-ui-dialog-base",function(H){var E=H.Node,C=E.one,G,D,F="dlg-show";function A(I){var J=I.get("id");if(!J){J=H.stamp(I);I.set("id",J);}return J;}function B(R){R=R||{};R.visible=R.visible||0;R.zIndex=R.zIndex||15500;var Q=this,U=R.contentBox||null,V=R.template||null,K=R.cssPrefix||null,I=R.focusedNode||null,M=R.clearMask||false,T=R.hideMask||false,S=R.restoreFocusNode,J=R.suppressRestoreFocus||false,L=R.suppressActive,O=R.maskId||null,N=R.noScroll||false,P=R.disableEsc||false;this._evt=[];if(!U&&V){Q.CONTENT_TEMPLATE=V;}B.superclass.constructor.apply(this,arguments);if(!D&&L){if(G){D=G;G.set("visible",false);}else{L=false;}}Q.addAttrs({cssPrefix:{value:K,readOnly:true},focusedNode:{value:I},clearMask:{value:M},hideMask:{value:T},restoreFocusNode:{valueFn:function(){var W=S;if(!((W instanceof H.Node)||H.Lang.isNull(W))){W=document.activeElement;}return W;}},suppressRestoreFocus:{value:J},suppressActive:{value:L,readOnly:true},maskId:{value:O},noScroll:{value:N},disableEsc:{value:P}});}B.NAME="dialog";B.CSS_PREFIX="yui3-overlay";B.ATTRS={role:{value:"dialog"}};H.extend(B,H.Overlay,{maskEl:null,prevMaskElId:null,centerEl:null,_haltShow:false,initializer:function(){this.set("visible",false);this.on("render",this.onBeforeRender);},destructor:function(){H.one("html").removeClass(F);var J,K=this.get("restoreFocusNode"),M=this.get("suppressRestoreFocus"),I=this.get("contentBox").get("id");this.get("boundingBox").purge(true);if(this.get("centered")){this.centerEl&&this.centerEl.remove(true);}else{this.get("boundingBox").remove(true);}for(J in this._evt){H.detach(this._evt[J]);}if(!this._haltShow){if(D&&this.get("suppressActive")){D.set("visible",true);D=null;this.prevMaskElId&&this.maskEl&&this.maskEl.set("id",this.prevMaskElId);this.prevMaskElId=null;}else{if(this.get("maskId")){this.maskEl.remove(true);}else{this.maskEl&&this.maskEl.setStyle("display","none");}G=null;if(!M){try{if(!(H.Lang.isNull(K)||K.tagName=="IFRAME")){K.focus();}}catch(L){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-comms-shared-src-ui-dialog-js-dialog:1",L,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-comms-shared-src-ui-dialog-js-dialog:1");}}H.fire("dialog:hide",I);}}else{this._haltShow=false;}},renderUI:function(){var P=this.get("cssPrefix"),K=this.get("contentBox"),O=this.get("role"),I,N,M,J,L;K.set("role",O);if(P){I=["#"+K.get("id")," .",P].join("");M=H.one(I+"-hd");J=H.one(I+"-bd");L=H.one(I+"-ft");if(M){K.set("aria-labelledby",A(M));if((N=M.one(".close"))){N.set("role","presentation");}if(!M.hasClass("yui3-widget-hd")){M.addClass("yui3-widget-hd");}}if(J){if(O==="alertdialog"||O==="dialog"){K.set("aria-describedby",A(J));}if(!J.hasClass("yui3-widget-bd")){J.addClass("yui3-widget-bd");}}if(L){if(!L.hasClass("yui3-widget-ft")){L.addClass("yui3-widget-ft");}}}K.setStyle("display","block");K.set("tabIndex",0);K.all(".btn a").each(function(R,Q){R.set("role","button");});},show:function(){if(!G){B.superclass.show.call(this);!this.get("suppressActive")&&H.fire("dialog:show",this);this.get("contentBox").setStyle("opacity",1);}else{this._haltShow=true;this.destroy();}},bindUI:function(){var J=H.one("html"),O=J.all(".yui3-overlay-content .btn"),I=O.size()-1,M=J.one(".yui3-overlay-content"),P=this.get("focusedNode"),L;if(this.get("centered")){this.after("renderedChange",this.center);}this._evt.push(this.after("visibleChange",function(){var R={display:"none"},Q=this.get("contentBox");if(this.get("visible")){Q&&Q.setStyle("display","block");R.display=this.get("hideMask")?"none":"block";G=this;if(!this.get("clearMask")){J.addClass(F);}}else{Q&&Q.setStyle("display","none");G=null;if(!this.get("clearMask")){J.removeClass(F);}}this.maskEl&&this.maskEl.setStyles(R);if(G){N(true);}H.fire("ToolTips:hideTooltips");}));function N(R){if(!G){return;}if(!(P instanceof H.Node)){R&&H.UA.gecko&&M.focus();P=M.one(P);}try{if(P){P.focus();}else{M.focus();}}catch(Q){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-comms-shared-src-ui-dialog-js-dialog:2",Q,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-comms-shared-src-ui-dialog-js-dialog:2");}}this._evt.push(M.on("blur",function(){L=true;}));this._evt.push(M.on("focus",function(R){var Q="#"+M.get("id");if(L&&!R.target.ancestor(Q,true)){N();}L=false;}));function K(S){var Q,R=S.target;switch(S.keyCode){case 8:case 46:return;case 9:if(I>-1){if(S.shiftKey){if(M==R){S.halt();O.item(I).focus();}}else{if(O.item(I)==R){S.halt();M.focus();}}}break;case 27:if(!this.get("disableEsc")){this.fire("dialog:action",{dataAction:"cancel"});S.preventDefault();}break;case 32:if(R.getAttribute("role")=="button"){S.preventDefault();H.use("node-event-simulate",function(){R.simulate("click");});}break;case 37:case 39:if((I>0)&&(Q=O.indexOf(R))>-1){if(S.keyCode==37){O.item((Q==0)?I:Q-1).focus();}else{O.item((Q==I)?0:Q+1).focus();}}break;}S.stopPropagation();}M.on("keydown",K,this);},onBeforeRender:function(O){var P=this.get("zIndex"),I=this.get("hideMask"),L=this.get("clearMask"),Q=this.getClassName((L?"clearmask":"mask")),J="position:fixed;top:50%;left:50%;height:1px;",K,M=this.get("maskId"),N,R;if(M){this.maskEl=C("#"+M);}if(!this.maskEl){if(!M){M=H.guid();}if(!(this.maskEl=H.one("."+Q))&&!I){N=['<DIV id="',M,'" class="',Q,'" style="z-index:',(P-2),'"></DIV>'].join(""),C("body").prepend(N);this.maskEl=C("#"+M);}else{if(this.maskEl){this.prevMaskElId=this.maskEl.get("id");this.maskEl.set("id",M);this.maskEl.setStyle("zIndex",P-2);}}}if(this.get("centered")){K=H.guid();R=['<DIV id="',K,'" style="',J,"z-index:",(P-1),'"></DIV>'].join("");C("body").prepend(R);this.centerEl=H.one("#"+K);O.parentNode=this.centerEl;this.get("boundingBox").setStyle("position","relative");}},center:function(){var J,K,I=this.get("boundingBox");J=-(I.get("offsetWidth")/2)+"px";K=-(I.get("offsetHeight")/2)+"px";I.setStyles({"marginLeft":J,"top":K,"left":0});}});H.namespace("comms.ui");H.comms.ui.Dialog=B;
},"0.0.1",{requires:["node","overlay"]});YUI.add("_shared_module_offscreen_bin_modal",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_modal={base:'<div id="modalOverlay" class="modal {{modal_classes}}"> <h2 class="modal-hd"> {{modal_header}} {{_shared_module_offscreen_bin_modal_close_icon}} </h2> <div class="frontpanel"> <div class="modal-bd">{{modal_body}}</div> <div class="modal-ft">{{modal_ft}}</div> </div> {{modal_back_panel}}</div>',modal_back_panel:'<div class="backpanel back hidden"> <div class="modal-bd">{{modal_body_back}}</div> <div class="modal-ft">{{modal_ft_back}}</div> </div> '};},"1.0.0",{requires:["_shared_module_offscreen_bin_modal_close_icon"]});YUI.add("_shared_module_offscreen_bin_modal_btn_ok",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_modal_btn_ok={base:'<button id="okayModalOverlay" class="btn left right default" title="{{str_ok}}" role="button" data-action="ok">{{str_ok}}</button> '};},"1.0.0");YUI.add("common-ui-dialog-helper",function(C){var A=C.common.Utils.substitute,B=C.ui.Templates,E="alertdialog",D;D=function(){var H={modal_header:function(M){return M.hd;},modal_body:function(M){return M.bd;},modal_ft:function(M){return A(M.ft,0,0,0,strings);},_shared_module_offscreen_bin_modal_btn_ok:function(M){return M.ok;},_shared_module_offscreen_bin_modal_btn_cancel:function(M){return M.cancel;},_shared_module_offscreen_bin_modal_close_icon:function(M){return(M.hideClose)?"":A(B._shared_module_offscreen_bin_modal_close_icon.base,0,0,0,strings);},global_path_img:function(){return NeoConfig.globalPathImg+"/u/assets/img";},antivirus_logo_path_img:function(){return NeoConfig.avLogoUrl;}};function L(N,O,M){N.ft=B._shared_module_offscreen_bin_modal_btn_ok.base||"";N.role=E;if(O&&O.ok&&O.ok.text){N.ft=A(N.ft,0,0,0,{str_ok:O.ok.text});}F(N,O,M);}function K(N,O,M){C.use("_shared_module_offscreen_bin_modal_btn_cancel",function(){var P={cancel:B._shared_module_offscreen_bin_modal_btn_cancel.base};N.ft=A(B._shared_module_offscreen_bin_modal_btn_cancel.base,P,H,0,strings);N.focusedNode='.modal-ft [data-action="cancel"]';N.role=E;F(N,O,M);});}function G(N,O,M){C.use("_shared_module_offscreen_bin_modal_btns_ok_cancel",function(){var P={ok:B._shared_module_offscreen_bin_modal_btn_ok.base,cancel:B._shared_module_offscreen_bin_modal_btn_cancel.base};if(O&&O.ok&&O.ok.text){P.ok=A(P.ok,0,0,0,{str_ok:O.ok.text});}if(O&&O.cancel&&O.cancel.text){P.cancel=A(P.cancel,0,0,0,{str_btn_cancel:O.cancel.text});}N.ft=A(B._shared_module_offscreen_bin_modal_btns_ok_cancel.base,P,H,0,strings);N.role=E;F(N,O,M);});}function J(N,O,M){N.ft=A(N.ft,0,H,0,strings);F(N,O,M);}function F(N,O,M){N=N||{};if(!N.template){var Q=N.rawTemplate||B._shared_module_offscreen_bin_modal.base;N.template=A(Q,N,H,0,strings);}N.centered=true;N.cssPrefix="modal";N.focusedNode=N.focusedNode||".yui3-widget-ft button.default";function P(R){R.get("contentBox").set("aria-live","polite");R.show();if(M){M(R);}}I(N,O,P);}function I(N,P,M){var O=new C.comms.ui.Dialog(N);P=P||{};O.render();O.get("contentBox").on("click",function(S){var T=C.common.Utils.getDataAction(S),R=T.action,Q=T.node;if(R){if(!N.allowDefault){S.preventDefault();}O.fire("dialog:action",{dataAction:R,item:Q});}});O.after("dialog:action",function(T){var R=T.dataAction,Q;if(R){Q=P[R];try{if(!Q||!Q.stopDestroy){O.destroy();}Q&&Q.handler&&Q.handler.call(this,T,O);}catch(S){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-dialoghelper-dialoghelper:1",S,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-dialoghelper-dialoghelper:1");}}});if(M){M(O);}}C.mix(this,{alert:L,cancelDialog:K,confirm:G,create:I,custom:J,createCommon:F});};C.namespace("common.ui");C.common.ui.DialogHelper=new D();},"1.0.0",{requires:["common-utils","modal_css","comms-ui-dialog-base","_shared_module_offscreen_bin_modal","_shared_module_offscreen_bin_modal_btn_ok"]});YUI.add("_shared_module_compose_link_editor",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_compose_link_editor={base:'<div class="label-left-fl"> <div class="link-editor-description"> <div>{{str_comp_createlink_display_text}}</div> <input id="newDescription" aria-label="{{str_comp_createlink_display_text}}" type="text" class="field-xl" value="{{defaultDescription}}"/> </div> <div class="link-editor-link"> <div>{{str_comp_createlink_edit_link}}</div> <input id="newURL" aria-label="{{str_comp_createlink_edit_link}}" type="text" class="field-xl" placeholder="http://www.yahoo.com" value="{{defaultHREF}}" dir="ltr"/> </div> <a id="followLink" role="button" title="{{str_comp_createlink_follow_link}}" href="#">{{str_comp_createlink_follow_link}}</a></div>'};},"1.0.0");/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("escape",function(e,t){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;"},r={html:function(e){return(e+"").replace(/[&<>"'\/`]/g,r._htmlReplacer)},regex:function(e){return(e+"").replace(/[\-$\^*()+\[\]{}|\\,.?\s]/g,"\\$&")},_htmlReplacer:function(e){return n[e]}};r.regexp=r.regex,e.Escape=r},"3.16.0",{requires:["yui-base"]});
YUI.add("mail-ui-rte-linkeditor",function(G){var A=G.common.Utils.substitute;function D(){var I;if(window.getSelection){I=window.getSelection();if(I.getRangeAt&&I.rangeCount){return I.getRangeAt(0);}}else{if(document.selection&&document.selection.createRange){return document.selection.createRange();}else{if(document.body.createTextRange){return document.body.createTextRange();}}}return null;}function F(I){var J;if(I){if(window.getSelection){J=window.getSelection();J.removeAllRanges();J.addRange(I);}else{if(document.selection&&I.select){I.select();}}}}function C(J){var I=D();if(!I){return;}if(I.setStartAfter){I.setStartAfter(G.Node.getDOMNode(J));}else{I.moveToElementText(J);}I.collapse(true);window.getSelection().removeAllRanges();window.getSelection().addRange(I);}function H(I){var J;I=G.Lang.trim(I);if(!I||I===""){return"";}if(0===I.indexOf("//")){I="http:"+I;}else{if(-1===I.indexOf(":")){I="http://"+I;}}I=I.replace(/"/g,"%22").replace(/'/g,"%27");J=I.toLowerCase();if(J.substr(0,7)==="http://"||J.substr(0,8)==="https://"||J.substr(0,7)==="mailto:"||J.substr(0,6)==="ftp://"){return I;}return"";}function E(I){I.replace(G.Escape.html(I.get("text")));}G.Plugin.ExecCommand.COMMANDS.createlink=function(){var I=this.get("host");I.get("container").focus();I.get("host").linkEditor.createOrEditLinkInSelection();};var B=function(){B.superclass.constructor.apply(this,arguments);};G.extend(B,G.Plugin.Base,{initializer:function(){var K=this,J=this.get("host"),I;function M(O){var N=function(P){return P===I;};if(!O.target.ancestor("[contenteditable=false]",true,N)){O.preventDefault();K.editExistingLink(this);}}function L(){I=K._editor.frame.get("container");I.delegate("click",M,"a");}this._editor=J;this.listeners=[];if(J.get("isReady")){L();return;}K.listeners.push(J.after("ready",L));},destructor:function(){G.each(this.listeners,function(I){I.detach();});this.listeners=[];}},{NAME:"linkEditor",NS:"linkEditor",ATTRS:{host:{value:false}}});G.mix(B.prototype,{_getSelection:function(){var I=this._editor.frame.getInstance();return new I.EditorSelection();},_execCommand:function(K,I,J){J=J||{};if(J.bypassOverrides){return this._editor.frame._execCommand(K,I);}else{return this._editor.frame.execCommand(K,I);}},_selectLink:function(){var L=this._getSelection(),I,K,J;if(!L.isCollapsed){I=L.getSelected();if(!I.size()){return null;}K=I.item(0);J=K.get("tagName");if(J==="A"){return K;}else{if(J==="FONT"&&K.get("parentNode").get("tagName")==="A"){return K.get("parentNode");}}return I.item(0).one("a");}if(L.anchorNode.get("tagName")==="A"){K=L.anchorNode;L.selectNode(K);}return K;},_showEditDialog:function(N,R,K){var P,S,L,O,J,Q;function M(Y){var X=G.one("input#newURL"),U=G.one("input#newDescription"),T=G.one("a#followLink"),W;Y.get("contentBox").addClass("link-editor-dialog");function V(Z){if(Z.keyCode===G.Node.DOM_EVENTS.key.eventDef.KEY_MAP.enter){Z.preventDefault();Y.fire("dialog:action",{dataAction:"ok"});}if(Z.keyCode===G.Node.DOM_EVENTS.key.eventDef.KEY_MAP.esc){Y.fire("dialog:action",{dataAction:"cancel"});}}L=X.on("keydown",V);T.on("click",function(a){var Z=X.get("value");Z=H(Z);a.preventDefault();if(!G.Lang.isString(Z)||Z.length===0){return;}window.open(Z);});if(NeoConfig.bidi){W=G.Intl.bidiDirection(U.get("value"));U.set("dir",W);U.plug(G.Plugin.BidiTextEntry);}P=Y;X.focus();X.select();}function I(){if(P){P.destroy();P=null;}F(Q);if(J){J.remove(true);G.all("span.yui-non").remove(true);}if(L){L.detach();}}S=this._getSelection();O=S.getSelected();Q=D();if(S.isCollapsed){}N=H(N);R=G.Escape.html(R);G.common.ui.DialogHelper.confirm({hd:strings.str_comp_createlink_link_options,bd:A(G.ui.Templates._shared_module_compose_link_editor.base,{defaultHREF:N,defaultDescription:R},null,null,strings),focusedNode:"input#newURL"},{ok:{handler:function(){var W=G.one("input#newURL"),V=W.get("value"),T=G.one("input#newDescription"),U=T.get("value")||V;if(!G.Lang.isString(V)){return;}I();K(H(V),U);},stopDestroy:true},cancel:{handler:function(){I();}}},M);},_fireLinkEvent:function(I){this.get("host").fire("link",{node:I,linkSource:"link-editor"});},_findAnchor:function(J){var L=J.one("a"),I=J.ancestor(),K=function(M){return M.get("tagName").toUpperCase()==="A"?true:false;};J=K(J)?J:null;I=K(I)?I:null;return J||L||I;},_createLink:function(K,N,M){var L,O,I,J;this._execCommand("createlink",K,{bypassOverrides:true});L=this._getSelection();O=L.getSelected();if(L.isCollapsed||!O.size()){this._execCommand("insertandfocus",'<a id="link-editor-new-anchor" href="'+K+'">'+G.Escape.html(N)+"</a>");I=G.one("#link-editor-new-anchor");I.removeAttribute("id");if(I&&K.indexOf("http")===0){this._fireLinkEvent(I);}return;}J=this._findAnchor(O.item(0));if(J&&M&&K.indexOf("http")===0){J.set("text",N);this._fireLinkEvent(J);}I=O.item(0).one("a");if(I){O.item(0).replace(I);J=I;}C(J);},editExistingLink:function(I){function J(K,L){if(!K){E(I);return;}I.set("href",K);I.set("text",L);}this._showEditDialog(I.get("href"),I.get("text"),J);},createOrEditLinkInSelection:function(){var L=this,K="",M,I=L._selectLink();if(I&&I.get("href")){K=I.get("href");M=I.get("text");}else{M=L._getSelection().text;}function J(P,O){var N;if(!I&&!P){return;}if(!P){E(I);return;}if(I&&G.UA.gecko){N=L._getSelection();E(I);L._execCommand("inserthtml",'<a href="'+P+'">'+G.Escape.html(N.text.trim())+"</a>");return;}L._createLink(P,O,I?false:true);}L._showEditDialog(K,M,J);}});G.namespace("mail.rte").LinkEditor=B;},"1.0.0",{requires:["plugin","common-ui-dialog-helper","_shared_module_compose_link_editor","escape"]});YUI.add("mail-ui-rte-smartscroll",function(e){function u(e,t){var n,r;if(!e)return 0;n=e.offsetTop,r=e.offsetParent;while(r!==t){if(!r)return n;n+=r.offsetTop,r=r.offsetParent}return n}function a(e){var t=document.createRange(),n;return t.selectNodeContents(e),n=t.getClientRects(),n.length>0?n[0]:null}function f(){var e=document&&document.documentElement;return e?e.scrollHeight>e.clientHeight+10?!0:e.scrollWidth>e.clientWidth+10?!0:!1:!1}function l(e){var t;return e?e.nodeType===3?(t=a(e),t?t.top:l(e.parentElement)):e.nodeName==="BR"?l(e.offsetParent)+e.offsetTop:(t=e.getBoundingClientRect(),t?t.top:0):0}function c(e){var t,n,r,i,s,o=!0,u,a,f=0;t=window.getSelection();if(!t||t.rangeCount===0)return null;t.isCollapsed||(t.anchorNode===t.focusNode?o=t.focusOffset<t.anchorOffset:(a=l(t.anchorNode),u=l(t.focusNode),o=u<a)),n=t.getRangeAt(0),r=n.getClientRects(),o?f=0:f=r.length-1;if(r[f]&&r[f].height<e)i=r[f].top,s=r[f].height;else{r=t.focusNode.getBoundingClientRect&&t.focusNode.getBoundingClientRect();if(!r||!r.height)return null;r=h(t.focusNode,t.focusOffset),i=r[0],s=r[1]}return[i,s]}function h(e,t){var n,r=0,i=0,s=e.childNodes,o,u;for(n=t-1;n>=0;n--){o=s.item(n);if(o.nodeType===3){u=a(o);if(u){r=u.top,i=u.height;break}}else if(o.nodeName!=="BR"){u=o.getBoundingClientRect(),r=u.top,i=u.height;break}}return i>0?r+=(t-n-1)*i:(u=e.getBoundingClientRect(),i=u.height/e.children.length,r=u.top+t*i),[r,i]}function p(a){function U(){if(!s)return;var e=y.getComputedStyle(t);g.addClass(i),g.setStyles({top:x+"px",width:T,left:N}),y.setStyle(t,e),M=!0}function z(){if(!s)return;g.removeClass(i),g.setStyles({top:"",width:"",left:""}),y.setStyle(t,""),M=!1}function W(){var n=E.getComputedStyle(t),r={width:C,left:N};b.addClass(i),w.addClass(i),m.scrollWidth>m.clientWidth&&(e.UA.webkit&&(r.bottom="10px"),e.UA.ie&&(r.bottom="17px"),e.UA.gecko&&e.UA.os!=="macintosh"&&(r.bottom="17px")),b.setStyles(r),w.setStyles(r),E.setStyle(t,n),_=!0}function X(){var e={width:"",left:"",bottom:""};b.removeClass(i),w.removeClass(i),b.setStyles(e),w.setStyles(e),_=!1,E.setStyle(t,"")}function V(){var t=m.scrollTop,r=u(e.Node.getDOMNode(d),m),i=m.clientHeight,o=r+d.get(n);if(!_){if(!M&&s&&r<t){m.scrollTop=r;return}if(o>t+i){m.scrollTop=o-i;return}}}function $(){T=d.getComputedStyle("width"),N=d.getX()-e.DOM.docScrollX(),C=parseInt(T,10)-56+"px",P=d.get(r),x=O.get(n)+O.getY(),S=d.one(".inner"),S.setStyle("minHeight","180px"),V(),D=!0}function J(){return b.get(n)>0?b:w}function K(){if(!D){$();return}if(f()){M&&z(),_&&X();return}var t=m.scrollTop,i=u(e.Node.getDOMNode(d),m),s=d.get(n),a=m.clientHeight,l=m.scrollLeft,c;l>0&&(M||_)&&(m.scrollLeft=0);if(M||d.get(r)!==P)T=d.getComputedStyle("width"),C=parseInt(T,10)-56+"px",P=d.get(r),x=O.get(n)+O.getY(),N=d.getX()-e.DOM.docScrollX(),c={},c.left=N,_&&(c.width=C,b.setStyles(c),w.setStyles(c)),M&&(c.width=T,c.top=x,g.setStyles(c));t<i?M&&z():t<i+s-o?M||U():M&&z(),t+a<i+o?_&&X():t+a<i+s?_||W():_&&X(),(!M&&_||M&&!_)&&g.getY()+g.get(n)+30>J().getY()&&(_&&X(),M&&z())}function Q(){K(),window.setTimeout(function(){_&&W(),M&&U()},0)}function G(e){window.setTimeout(function(){_&&X(),b.scrollIntoView()},0)}function Z(e){var t,r,i,s,o,u,a,l,h,p,d;D||$();if(f()){M&&z(),_&&X();return}if(e){t=e.changedType,t||(t=e.type);if(t==="mousedown"||t==="keydown"||t==="keypress")return;if(t==="keyup"){e.changedType?r=e.changedEvent:r=e,i=r.keyCode;if(r.ctrlKey||r.metaKey)return;if(i>111&&i<124)return;switch(i){case 16:case 17:case 18:case 19:case 20:case 27:case 44:case 91:case 93:case 144:case 145:case 224:return}}}K();if(H){B=!0;return}H=!0,R=window.setTimeout(function(){H=!1,B&&(B=!1,Z())},100),_||V();if(!_&&!M)return;s=m.scrollTop,l=g.get(n),p=m.clientHeight-l-J().get(n)-60,d=c(p);if(!d)return;o=Math.round(d[0]),u=Math.round(d[1]);if(M){a=Math.round(g.getY());if(o<a+l){m.scrollTop=s-a-l+o-20;return}}_&&(h=Math.round(J().getY()),o+u>h-20&&(m.scrollTop=s-h+40+o+u))}var l=this,h=a.rte,p=h.getContainer(),d=p.ancestor(".compose"),v=d&&d.ancestor(a.topOverlaySelector),m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M=!1,_=!1,D=!1,P,H,B,j,F,I,q=null,R=null;l.detach=function(){q&&window.clearTimeout(q),R&&window.clearTimeout(R),k&&k.detach(),L&&L.detach(),j&&j.detach(),A&&A.detach(),I&&I.detach(),F&&F.detach()};if(!v)return;O=v.ancestor(".threadpane").one(".message-header"),g=d.one(".compose-header"),y=g.ancestor("tr"),b=d.one(".bottomToolbar"),w=d.one(".bottomNotification"),E=b.ancestor("tr"),m=e.Node.getDOMNode(v),$(),k=v.on("scroll",K),j=e.one(window).on("resize",Q),F=e.on("attachmentsChanged",G),I=e.on("recalculateScrollToRepositionSend",function(){q=window.setTimeout(K,50)}),L=h.getRTE().on("nodeChange",Z),e.UA.ie>=11&&(A=h.getContainer().on(["dom:keyup","dom:focus","focus"],Z))}var t="height",n="clientHeight",r="clientWidth",i="smartFixed",s=e.common.Utils.features.enabled("smartscrollHeader"),o=150;e.namespace("mail.rte"),e.mail.rte.smartScroll=p},"1.0.0",{requires:["editor-base","mail-common-utils-features"]});
YUI.add("mail-ui-rteview",function(E){var a="hidden",T,C,K;function I(Y){var h=this;I.superclass.constructor.call(h,Y);T=Y.bidi;C=Y.isFullSSL;K=Y.isRTL;h.rte=null;h.contentInitialized=null;h.focusNode=false;h.baseNode=null;h.rteReady=false;h.rteArea=null;h.evt=[];h.set("isRich",Y.isRich);h.getDefaultFontInfo=Y.getDefaultFontInfo;h.convertToPlain=Y.convertToPlain;h.richFontInfo=h.getDefaultFontInfo(!Y.isRich);h.smartscroll=Y.smartscroll;var g={isRich:{setter:function(i){h.isRich=i;h.switchEditMode();}},content:{setter:function(i){h.content=i;h.rte.getInstance().Selection.cleanCursor();if(h.baseNode){h.baseNode.fire("switchToPlain");}},getter:function(){return h.content?h.content:"";}}};h.addAttrs(g,Y||{});}function f(Y){var g=this;g.baseNode=Y;g.rteArea=Y.one("div.cm-rtetext");E.Frame.DEFAULT_CSS="";g.rte=new E.EditorBase({defaultblock:"p",dir:T&&strings.str_tog_loadRTLCss?"rtl":"ltr",plugins:[{fn:E.Plugin.ContentEditable,cfg:{use:E.EditorBase.USE}}]});E.Plugin.ExecCommand.COMMANDS.fontsize=null;g.rte.plug(E.Plugin.EditorPara);g.rte.plug(E.mail.rte.LinkEditor);if(T){g.rte.plug(E.Plugin.EditorBidi);g.rte.plug(E.Plugin.EditorAutoBidi);}g.bindUI();g.renderUI();}function b(){var g=this,Y=g.evt;Y.push(g.rte.after("nodeChange",function(i){var h=i.changedType;if(h==="keypress"||(!E.UA.ie&&h==="keydown")){return;}if(h==="right"||h==="left"||h==="space"){return;}if(h==="mouseup"||(E.UA.ie&&h.indexOf("up")!==-1&&i.changedNode.get("tagName")!=="SPAN")){return;}if(h==="mousedown"&&i.changedEvent&&i.changedEvent.which>1){return;}if(i.changedType&&i.changedType.toLowerCase()!=="execcommand"){g.fire("nodeChange",i);}}));Y.push(g.rte.frame.after("ready",function(){g.rteReady=true;g.rte.set("isReady",true);Y.push(g.getContainer().on("focus",function(){g.fire("focus",{editor:g.rte});}));Y.push(g.getContainer().on("blur",function(){g.fire("blur",{editor:g.rte});}));Y.push(g.getContainer().on("keydown",function(i){i.stopPropagation();}));Y.push(g.getContainer().on("keypress",function(i){i.stopPropagation();}));if(g.smartscroll){Y.push(new E.mail.rte.smartScroll({"rte":g,"topOverlaySelector":".thread-item-list"}));}Y.push(g.rte.frame.on("dom:keydown",function(l){var k,j=l.keyCode,i=(l.ctrlKey||l.metaKey)&&(!l.altKey&&!l.shiftKey);l.frameEvent.stopPropagation();if(E.UA.gecko&&(l.ctrlKey||l.metaKey)&&l.shiftKey&&j===88){if(T&&l.metaKey){k="bidi";i=true;}else{l.frameEvent.halt();return;}}if(i||(T&&l.ctrlKey)){switch(j){case 66:k="bold";break;case 73:k="italic";break;case 85:k="underline";break;case 16:if(T){k="bidi";}break;default:break;}if(k){l.frameEvent.halt();g.execute(k,"");return;}}g.fire("keyDown",l);}));Y.push(g.rte.frame.on("dom:mousedown",function(i){g.fire("mousedown",i);}));Y.push(g.getContainer().on("drop",function(i){g.fire("drop",i);}));g.rteArea._node.onpaste=function(i){if(!g.isRich){H.call(g,i);}else{g.fire("paste");setTimeout(function(){F.call(g,i);},1);}};if(g.contentInitialized){g.setContent(g.contentInitialized,false);}g.set("ready",true);g.fire("ready");g.getContainer().addClass(C?"fullSSL":"nonSSL");g.getContainer().setStyles(g.getComposeStyle(g.isRich));if(g.isRich){g.getContainer().setStyles({"fontSize":g.richFontInfo.fontSize,"fontFamily":g.richFontInfo.fontFamily});}else{g.getContainer().addClass("plaintextMsg");}var h=g.getContainer();if(h&&T&&K){h.set("dir","rtl");}}));}function D(){var Y=this;Y.rteArea=Y.baseNode.one("div.cm-rtetext");Y.rte.render(Y.rteArea);if(T){Y.rte.fire("turnautobidioff",{status:!Y.isRich});}}function O(){var Y=this;if(E.UA.ie){Y.rteArea.setStyle("display","block");}Y.rteArea.setStyle("visibility","");}function Z(){var Y=this;if(E.UA.ie){Y.rteArea.setStyle("display","none");}Y.rteArea.setStyle("visibility",a);}function P(Y,i){var j=this,h,g;if(j.rte){if(Y==="bidi"){j.rte.fire("disableautobidi");}j.rte.execCommand(Y,i);if(E.UA.webkit){if(Y==="createlink"){h=j.rte.getInstance();g=new h.Selection();if(g&&g._selection){g._selection.collapseToEnd();}return;}j.rte.focus();}}}function Q(g,m){var k=this,Y,i,j="",o=E.Selection.CURSOR,n=(!E.Lang.isUndefined(m))?m:true;o=(E.UA.ie===9)?"&nbsp;":E.Selection.CURSOR;if(n){j="<p>"+o+"</p>";}else{j="";}j+=g;if(k.rteReady){k.rte.set("content",j);i=k.rte.getInstance();i.Selection.filter();if(E.UA.ie&&k.rte.frame._fixIECursors){k.rte.frame._fixIECursors();}try{Y=new i.Selection();Y.focusCursor(true,true);}catch(l){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailcompose-rte-rteview:1",l,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailcompose-rte-rteview:1");}if(E.UA.ie&&E.UA.ie>=10){var h=k.getDoc().one("p .yui-cursor");if(h){h.remove(true);}}}else{k.contentInitialized=j;}}function e(){return this.rte.getContent();}function U(){return this.rte.get("content");}function W(){return this.rte;}function S(){return this.getContainer();}function R(){return this.getContainer();}function A(Y){if(this.rte){this.rte.focus(Y);}}function d(){var Y=this;E.each(Y.evt,function(g){g.detach();});delete Y.evt;Y.rte.destroy(true);delete Y.rte;I.superclass.ondestroy.call(this,arguments);}function L(){var h=this,Y,g;if(h.rte){g=h.isRich;Y=h.getDefaultFontInfo(!g);h.getContainer().setStyles(h.getComposeStyle(g));if(h.isRich){h.getContainer().removeClass("plaintextMsg");h.getContainer().setStyles({"fontSize":Y.fontSize,"fontFamily":Y.fontFamily});}else{h.getContainer().addClass("plaintextMsg");}if(T){h.rte.fire("turnautobidioff",{status:!g});}}}function c(){var h=this,Y=h.getContainer();if(Y){var g=h.convertToPlain(Y,false);if(g){if(E.UA.ie){g=g.replace(/\xA0/gi," ");}return E.Lang.trim(g)!=="";}else{return false;}}return true;}function M(){var Y=this,g=this.getContainer();if(!g){return"";}return Y.convertToPlain(g,true);}function V(Y){var h=this,g=h.getDefaultFontInfo(!Y);if(Y){h.richFontInfo.fontFamily=g.fontFamily;h.richFontInfo.fontSize=g.fontSize;h.richFontInfo.foreColor="#000";h.richFontInfo.backColor="#fff";}return{"color":this.richFontInfo.foreColor,"background-color":h.richFontInfo.backColor};
}function B(g,Y){if(this.rte){this.rte.plug(g,Y);}}function X(){return this.rte.frame.get("container");}function G(Y,g){var h=this;if(h.rte&&(Y==="insertandfocus"||Y==="inserthtml")){h.rte.focus();}h.execute(Y,g);}function J(g){var i=this,Y,h;if(g){if((g.get&&g.get("className")==="yahoo_quoted")||g.className==="yahoo_quoted"){return;}if(g.set){g.set("className","");}if(g.className){g.className="";}if(g.getDOMNode&&g.getDOMNode().childNodes){h=g.getDOMNode().childNodes;}else{if(g.childNodes){h=g.childNodes;}}if(h){for(Y=0;Y<h.length;Y++){i.clearClassNames(h[Y]);}}}}function N(Y){var h=(((Y&&Y.get("tagName"))||"").toLowerCase()==="img"),g;if(!h){return false;}g=((Y&&Y.get("src"))||"").toLowerCase().replace(/^\s*/,"");return((g.indexOf("data:")===0)||g.indexOf("webkit-fake-url:")===0);}function F(){var g=this,Y;g.rteArea.all("*").each(function(h){if(N(h)){h.remove();return;}if(!h.hasClass("yahoo_quoted")){h.setAttribute("class","");h.setAttribute("className","");}Y=(h.getAttribute("style")||"").replace(/position\s*?:\s*?(fixed|absolute)/ig,"");h.setAttribute("style",Y);});}function H(m){var l=this,j="",n=false,g,h,p,k,Y,i;try{if(m.clipboardData){j=(m.originalEvent||m).clipboardData.getData("text/plain");l.execute("insertText",j);n=true;}else{if(window.clipboardData){j=window.clipboardData.getData("Text");g=window.getSelection();if(g.getRangeAt&&g.rangeCount){k=g.getRangeAt(0);k.deleteContents();h=document.createElement("div");h.innerHTML=j;p=document.createDocumentFragment();while((i=h.firstChild)){Y=p.appendChild(i);}k.insertNode(p);if(Y){k=k.cloneRange();k.setStartAfter(Y);k.collapse(true);g.removeAllRanges();g.addRange(k);}}n=true;}else{l.fire("paste");setTimeout(function(){l.setContent(l.convertToPlain(l.rteArea,true));},1);}}}catch(o){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailcompose-rte-rteview:2",o,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailcompose-rte-rteview:2");l.fire("paste");setTimeout(function(){l.setContent(l.convertToPlain(l.rteArea,true));},1);}if(n){m.stopPropagation();m.preventDefault();if(window.event){window.event.returnValue=false;}}}E.namespace("mail");E.extend(I,E.mail.ui.BaseWidget);E.mail.RTEView=I;E.mix(E.mail.RTEView.prototype,{NAME:"RTE",_sanitizeHtml:F,_sanitizeText:H,render:f,renderUI:D,bindUI:b,execute:P,getRTE:W,getDoc:S,getDocRoot:R,getContent:e,getContentOnSave:U,getComposeStyle:V,getContentAsPlainText:M,getContainer:X,setFocus:A,setContent:Q,clearClassNames:J,switchEditMode:L,hasContent:c,plug:B,hideArea:Z,showArea:O,ondestroy:d,invokeCommand:G},true);},"1.0.0",{requires:["attribute-base","editor-base","editor-inline","editor-para","event-base","node-base","node-event-delegate","common-utils","mail-ui-basewidget","mail-ui-rte-linkeditor","mail-ui-rte-smartscroll"]});YUI.add("mail-tt-attcomposer",function(C){var L,F=C.common.persist.UserData,D=F.get("userFeaturePref.attachTotalSize"),I=F.get("userFeaturePref.attachFiles");function B(){var M=NeoConfig.launch_protocol;if(NeoConfig.attachmentServer){M+=NeoConfig.attachmentServer+"/";}if(NeoConfig.isSSL&&!NeoConfig.isAttachSSL){M+=window.location.host;}else{M+=[strings.str_cfg_base_intl,".",NeoConfig.farm,".mail.yahoo.com"].join("");}M+="/ya/upload";return M;}L=B();function K(){var N={UPLOAD_URL_BASE:L,IFRAME_USE_TIMEOUTS:!NeoConfig.low_bandwidth,stopwatch:C.common.Utils.Stopwatch},M;M=parseInt(NeoConfig.formUploaderResponseTimeout,10);if(M){N.IFRAME_UPLOAD_TIMEOUT_MS=M;}M=parseInt(NeoConfig.formUploaderRedirectInterval,10);if(M){N.IFRAME_POLL_INTERVAL_MS=M;}return N;}function E(M){var N={},O=C.Object.keys(C.tictac.attach.Controller.conf);O=C.Array.hash(O);if(O.getDownloadInfo){N.getDownloadInfo=function(Q,P){M.attGetDownloadInfo(Q,P);};}if(O.download){N.download=function(Q,P){M.attDownload(Q,P);};}if(O.getMsg){N.getMsg=function(P,Q){M.attGetMsg(P,Q);};}return N;}function J(M){var O=this,N=M.currentTarget;C.fire("mt:click",{action:"cmps_attflmnu",append:{t1:"cmpsTb"}});M.preventDefault();if(!N.menu){C.use("common-ui-menu-helper","_shared_module_offscreen_bin_menus_compose_attach",function(Q){var P=Q.one("#menu-attach-options");P=Q.Node.create('<div id="menu-attach-options" class="optionMenu"></div>');Q.one("body").append(P);if(O.attachLargeBtn){P.appendChild(O.attachLargeBtn);}Q.common.ui.MenuHelper.create(N,{menu:P,blur:true,allowSimClick:true},function(){});});}}function G(O,M,N){var Q=M.node,P=Q.one("span.attach-btn-menu"),R=Q.one(".attachment-button-attach");O.push(P.on("click",J,N));R&&R.removeClass("right");P&&P.removeClass("hidden");}function H(Q,N,S,P){var R=false,M,T=(C.Tictac&&(C.Tictac.dropbox||C.Tictac.flickr)),O=(!C.UA.ie||T);M=C.after("om:compose_add_btn",function(){if(!R&&O&&N._node){N.one(".attachment-button-attach").ancestor().append(S);G(Q,{node:N},P);R=true;}});Q.push(M);if(O){N.one(".attachment-button-attach").ancestor().append(S);G(Q,{node:N},P);R=true;}}function A(Q,a,Z,b,N){var T=C.tictac.attach,Y=Z.one("span.attachment-button-attach"),X=window.strings,W=Z.one(".attach-btn-menu"),S,V,U,M,R,P,O="#menu-attach-options:last-of-type";P=C.Node.create("<li data-action='attach' class='menu-attach-file'><a>href='#'></a></li>");S=C.Node.create("<li class='menu-attach-dropbox'><a href='#'></a></li>");V=C.Node.create("<li class='menu-attach-flickr'><a href='#'></a></li>");U=Q.editor.getDoc();W.remove();Y.remove();Y.one("input[type=file]").remove();Z.empty();b.empty();T.Utils.configure(T.UploaderForm.conf,K());T.Utils.configure(T.UploaderHTML5.conf,{simpleRelogin:C.common.net.Error.simpleRelogin,stopwatch:C.common.Utils.Stopwatch,dropNode:U});T.Utils.configure(T.model.Attachments.conf,{MAX_BYTES:D,MAX_COUNT:I});T.Utils.configure(T.View.conf,{ERROR_TITLE:X.str_comp_attach_error,ERROR_SIZE:X.str_comp_attach_size_exceeded,ERROR_COUNT:X.str_comp_attach_num_files_exceeded,alert:function(c){C.use("common-ui-dialog-helper",function(d){d.common.ui.DialogHelper.alert(c);});}});if(T.Controller.conf){C.mix(T.Controller.conf,E(Q),true);}R={tray:b,attach:Y,attachContainer:Z,dropArea:Q.baseNode,dropbox:S,flickr:V,rte:N,username:NeoConfig.userDataObj.userSendPref.defaultFromName,attachOption:P,attachMenuSelector:O,composeView:Q};M=new T.AttachmentComposer(R);H(Q.handles,Z,W,M);delete a.oComposeData.attachments;a.attachments=M.model;return M;}C.namespace("mail.tt.attcomposer").make=A;},"1.0.0",{requires:[]});YUI.add("mail-ui-fullcompose",function(e){function x(t){var n=this,r,i;n.composeViewRendered&&(n.isDraft?r="draft":(i=n.cdo&&n.cdo.get&&n.cdo.get("origin"),r=i?i.action:null),r=r||"new",e.Lang.later(90,null,function(){n.neoFire("composeEvent",{action:"darlaEvent",type:"compose_"+r})})),n.attView&&n.attView.reposAttachObj(E),n.attView&&n.attView.attachLargeBtn&&n.attView.attachLargeBtn.removeClass("hidden"),t.cbk&&t.cbk()}function T(e){var t=this;try{t.get("isQuickReply")||t.header.hideACWidget()}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailcompose-message-composeview:1",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailcompose-message-composeview:1")}t.dirty&&t.dirty!=="ForceClose"&&NeoConfig.saveOnHideCompose&&t._invokeSaveDraft({auto:!0}),t.hiliteCP&&t.hiliteCP.hide(),t.textCP&&t.textCP.hide(),t.attView&&t.attView.reposAttachObj(w),t.attView&&t.attView.attachLargeBtn&&t.attView.attachLargeBtn.addClass("hidden"),e.cbk&&e.cbk()}function N(){var e=this,n=e.baseNode,r=n.one(".cm-subject-field"),i=n.one("input.cm-subject-field");return i.ancestor("div").removeClass(p),{subjectVal:t(r.get("value")),subjectDir:NeoConfig.bidi?r.getStyle("direction"):null}}function C(){var t=this,n=t.cdo,r=n.get("origin"),i=t.closeSrc,s;r&&r.action!==null?r=r.action:r="new",s={action:"cmps_tab_cls",append:{t1:"cmpsTb",ltxt:r,cmpsType:t.get("isQuickReply")?"QR":"fullCmps"}};switch(i){case"closeBtn":break;case"escKey":s.append.actn="keybrd";break;case"cancelBtn":s.action="tlbr_cancelcompose"}t.set("close",1),e.fire("mt:click",s)}function k(){var t=this,n=t.attView,r=t.cdo,i=t.attComposer,s;t.blockSave=!0,t.saveTimer&&t.saveTimer.cancel(),t.resizeRTEDelayTimer&&t.resizeRTEDelayTimer.cancel(),t._clearOriginTimers(),t.hiliteCP&&t.hiliteCP.hide(),t.textCP&&t.textCP.hide(),!e.Lang.isNull(t.spellCheckView)&&!e.Lang.isUndefined(t.spellCheckView)&&t.spellCheckView.destroy(),t.spellCheckView=null,n&&(n.cleanUp&&n.cleanUp(),t.attView=null),i&&(i.cleanup(),t.attComposer=null),r&&(e.each(t.handles,function(e){e.detach&&e.detach()}),e.each(r.get("attachments"),function(e){e.timeout&&(clearTimeout(e.timeout),e.timeout=null)}),t.cdo=null),s=t.rteFormatter,s&&(s.fontFamilyOptions&&s.fontFamilyOptions.remove().destroy(!0),s.fontSizeMenu&&s.fontSizeMenu.remove().destroy(!0),s.fontNameMenu&&s.fontNameMenu.remove().destroy(!0),s.formatButtons&&s.formatButtons.remove().destroy(!0),s.fontColorMenu&&s.fontColorMenu.remove().destroy(!0),s.textIndentation&&s.textIndentation.remove().destroy(!0),s.textAlignment&&s.textAlignment.remove().destroy(!0),s.textLists&&s.textLists.remove().destroy(!0),s.emotionMenu&&s.emotionMenu.remove().destroy(!0)),t.rtSwitch=null,t.baseNode&&(e.each(t.handles,function(e){e.detach()}),t.handles=null,t.baseNode.remove().destroy(!0)),t.header=null,t.formatters=null,t.container=null,e.fire("compose:rte:blur"),S.superclass.ondestroy.call(this,arguments)}function L(){var t=this,n,r=t.baseNode.one(".ac-input.focus .recipient-input input");r&&t.header._lozengeIt(r),n=t.baseNode.all(".compose-header .field .hLozenge");if(n.size()>100){e.use("common-ui-dialog-helper",function(){o.ui.DialogHelper.alert({hd:strings.str_comp_dialogheader,bd:strings.str_comp_send_toomanyrecipients,suppressRestoreFocus:!0},{ok:{handler:function(){}},cancel:{handler:function(){}}})}),c({m:"Too many recipients"});return}c({m:"Pass recipients' size check"}),setTimeout(function(){t._invokeSend(!0)},0)}function A(){var t=this,n,s=t.cdo,o=t.handles;t.attachBtn=t.baseNode.one("#attachment-button-input"),NeoConfig.backButtonFull||e.fire("initPage"),o.push(t.editor.on({keyDown:function(n){var r=!1;e.fire("HoverCard:hideHoverCard");if(n.ctrlKey||n.metaKey||n.altKey||n.shiftKey||n.keyCode===27)r=t.get("keydownHandler")?t.get("keydownHandler")(n):t.onKeyDown(n);r?n.halt():(t._setDirty(),setTimeout(function(){t.get("isQuickReply")&&t.resizeRTE()},0))},focus:function(n){t._registerFocus(n.editor),t.header._removeLozengeHighlights(),e.fire("compose:rte:active",{editor:n.editor,cv:t})},blur:function(n){e.fire("compose:rte:blur",{editor:n.editor,cv:t})},drop:function(){var e=t.attView,n=e&&e.uploader;t._setDirty(),n&&n.uploaderType===r.UploaderService.UPLOADER_TYPE_HTML5&&n._ddEventHandler&&t.get("active")},paste:function(){t._setDirty()},ready:function(){t.postRender();var e=t.cdo.get("header");e.to&&e.to.length>0?t.setFocus("body"):t.setFocus("to")}})),o.push(s.on("compose:restoreFocus",function(){t.focusNode instanceof e.Node?t._restoreFocus():t.setFocus("body",0,1)},t)),o.push(t.baseNode.delegate("click",function(n){var r=n.currentTarget,i=r.get("parentNode"),s=i.hasClass("cc-btn")?"cc":"bcc",o=i.get("id");n.halt(!1);var u=o==="btn-show-"+s+"-in-to"||o==="btn-show-"+s+"-in-cc",a="cmps_"+(u?"shw"+s:"hd"+s);t.header._cmdBccSwitch(u,s),e.fire("mt:click",{action:a,append:{t1:"cmpsTb"}}),t._restoreFocus()},"span.cc-btn a, span.bcc-btn a")),o.push(t.compArea.on(["click","keydown"],function(e){if(e.type==="keydown"&&e.keyCode!==13)return;"quoted-text"===e.target.getAttribute("data-action")&&t._expandQuotedReply()})),o.push(t.baseNode.delegate("click",function(){t._clearOriginTimers(),t._displayLoading(),i.fetchOrigin(s,t.isDraft)},"a.retryOrigin")),t.on("renderComplete",function(){t.contentLoaded=!0,e.use("mail-controller-sendconfirm","mail-ui-sendconfirmview-base-conv",function(){})}),t._addFocusListenersFresh(),o.push(t.baseNode.on("keydown",function(e){var n,r=e.target;e.keyCode===13&&r.ancestor("div.rte-well-container")&&(e.halt(),t.focusNode=r,n=r.one("b"),n&&n.simulate("click"))})),o.push(t.baseNode.delegate("click",function(e){var n=u.getDataAction(e).action;t.handleComposeAction(n,e)},".bottomToolbar > span")),n=t.attachBtn,n&&o.push(n.on({focus:function(){n.ancestor("span").addClass("focused")},blur:function(){n.ancestor("span").removeClass("focused")},click:function(){t.attView&&t.attView.uploader&&t.attView.uploader.uploaderType===r.UploaderService.
UPLOADER_TYPE_YUI&&!t.attView.formUploader&&t.attView.switchToFormUploader({skipDefault:!0})}})),o.push(t.on("compose:dirty",function(){t.enableSaveDraft||(t.enableSaveDraft=!0,t._showDraftBtn())})),o.push(e.on("windowresize",function(){t.resizeRTE()})),t._showSendBtn(!1)}function O(e){e?this.neoFire("composeEvent",{action:"showSendBtn"}):this.neoFire("composeEvent",{action:"hideSendBtn"})}function M(){this.enableSaveDraft?this.neoFire("composeEvent",{action:"showDraftBtn"}):this.neoFire("composeEvent",{action:"hideDraftBtn"})}function _(){var e=this,t=e.rteFormatter,n=e.handles,r=e.cdo;t.bindUI(),n.push(t.on("formatter:action",function(t){e._setDirty(),e._setComposePreference(t.act,t.val)})),n.push(r.after("isRichTextChange",function(t){e.editor.set("isRich",!NeoConfig.low_bandwidth&&t.newVal),e.rteFormatter&&e.rteFormatter._switchEditMode(t.newVal)})),e._intlBindUIRTE()}function D(){var t=this,n,r,i,s;n=t.rteFormatter=new e.mail.ui.RTEFormatter({isBidi:NeoConfig.bidi,isSpellCheckEnabled:strings.str_tog_spellcheckEnabled,editor:t.editor,globalPathImage:t.formatters.global_path_img()}),n.renderUI(t.baseNode.one(".rte-well-container")),n._switchEditMode(t._isRTEActive()),t._bindWellUIFresh(),r=t.richFontInfo.fontFamily,i=t.richFontInfo.fontSize,i&&(s=parseInt(i.replace("pt",""),10),s=e.Array.indexOf(v,s),s>=0&&(n.selectedFSIndex=s+1)),n.selectedFNIndex=r,t._initializeSpellCheck(),t._bindTextSwitchFresh()}function P(t){var n=t.one(".yahoo_quoted"),r="qtdSeparateBR",i=r.length,s,o;n=n?n:t.one('div[class*="yqt"]'),n&&(s=n.previous(function(e){return o=e.get("className"),o&&o.indexOf(r,o.length-i)!==-1}),!s&&n.insert(e.Node.create(l._shared_module_compose_reply.forward_rich_body),"before"))}function H(){var e=this,t,n,r=e.getRTEDocNode(),i=e.compArea.one(".compose-quoted-text"),s=r.one(".yahoo_quoted"),o;e._insertEmptyLineBeforeQuotedText(r),s&&s.setStyle("display","block"),t=e.cdo.get("yqtdPrefix");if(t)for(n=0;n<t.length;n++)o=e.getRTEDocNode().one("."+t[n]+"yahoo_quoted"),o&&o.setStyle("display","block");i&&i.remove(),e.resizeRTE()}function B(){var e=this;e.hasRTEFormatter&&e.initializeRTEFormatter()}function j(){var e=this,t;NeoConfig.useAttComposerTT&&(t=e.cdo.attachments.count()),t!==0?e.baseNode.one("div.attachments-well").removeClass(h):e.baseNode.one("div.attachments-well").addClass(h)}function F(t){var n=this,r,s;if(t){n.parent=t,r=a(l._shared_module_compose_fresh_conv.base,n.cdo,n.formatters,null,strings,l),t.append(r),n.baseNode=t.one(".compose"),n.get("isQuickReply")||(n.baseNode.addClass("full-compose"),n.baseNode.addClass("content")),n.compArea=n.baseNode.one("div.compose-message").one("div.inner"),n.loadingArea=n.compArea.one("div.msg-loadingpane"),n.footer=n.baseNode.one(".footer-separator");var o=i.getDefaultFontInfo(!n._isRTEActive());n.richFontInfo.fontFamily=o.fontFamily,n.richFontInfo.fontSize=o.fontSize,s=n.baseNode.one("div.cm-plaintext"),s&&s.get("parentNode").removeChild(s),e.UA.gecko&&n.compArea.ancestor("td").setStyle("height","0"),n.header.enableHeader(!1),n._renderWellsFresh(),n.bindUI(),n.header.render(),n.header.bind(),n.composeViewRendered=!0,n.editor.render(n.baseNode)}}function I(){var e=this,t=e.footer.getY();e.footer.setStyles({position:"fixed",top:t+"px"})}function q(){NeoConfig.tabs&&!NeoConfig.hasConvView?(this.resizeRTEDelayTimer&&this.resizeRTEDelayTimer.cancel(),this.resizeRTEDelayTimer=e.later(300,this,this.doResizeRTE)):this.doResizeRTE()}function R(){var t=this,n,r,i=0,s,o,u=t.baseNode.one("div.attachments-well");if(t.get("close"))return;i=u?u.getStyle("height"):0,i=i==="auto"?0:parseInt(i,10),r=e.one("body").get("offsetHeight");if(!t.get("isQuickReply")){n=parseInt(t.compArea.getY(),10),r=e.one("body").get("offsetHeight"),s=r-n-b-10;var a=s-.2*r;a>300&&(a=300),t.compArea.setStyles({maxHeight:s+"px",minHeight:a+"px"}),o=a-i>0?a-i:0,t.editor.rteArea.setStyles({minHeight:o+"px"})}else if(!NeoConfig.smartscroll){parseInt(t.baseNode.getStyle("height"),10)>t.maxHeight&&(t.maxHeightFn&&(t.maxHeight=t.maxHeightFn()),t.compArea.setStyles({maxHeight:t.maxHeight-parseInt(t.header.hdr.getStyle("height"),10)-b+"px"}));var f=t.baseNode.get("parentNode").get("offsetTop")-t.containerNode.get("scrollTop")+parseInt(t.baseNode.getStyle("height"),10)+6-t.containerNode.get("offsetHeight");f>0&&t.containerNode.set("scrollTop",t.containerNode.get("scrollTop")+f)}}function U(){function i(i){var s=i.params,o,u,a,f,l={format:1};if(!l.hasOwnProperty(s.tab))return;if(!t.baseNode)return;s.tooltip=s.tooltip||"";if(s.tab!=="format")return;u=s.name||"Stationery",a='<span class="btn menu" data-app="'+i.appInstance+'">'+'<a class="icon '+u+'" href="#" title="'+s.tooltip+'">'+'<i role="presentation" class="plaintext">'+s.label+"</i></a></span>",f=n(a);try{t.baseNode.one("."+s.tab+"-pane").one(".om-buttons").append(f)}catch(c){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailcompose-message-composeview:2",c,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailcompose-message-composeview:2")}o=e.stamp(f),r.push(f.on("click",function(e){e.preventDefault(),i.handler(o,t)})),r.push(e.on("om:click_btn",function(e){if(!e.app||!e.app.instance||!e.tab)return;i.appInstance===e.app.instance&&i.handler(o,t)}))}var t=this,r=t.handles;e.each(s,i),r.push(e.on("om:compose_add_btn",function(){i(s[s.length-1])}))}function z(t,r,i){var s=this,o=s.handles,u=n('<ul class="om-buttons"></ul>'),a=s.baseNode.one("div.rte-well-container");e.UA.ie===0&&(u.appendChild(t),a.addClass("largefiles")),e.Tictac&&e.Tictac.flickr&&(u.appendChild(i),o.push(i.on("click",function(t){e.fire("mt:click",{action:"cmps_attflk",append:{t1:"cmpsTb"}}),t.preventDefault()})),a.addClass("largefiles")),e.Tictac&&e.Tictac.dropbox&&(u.appendChild(r),o.push(r.on("click",function(t){e.fire("mt:click",{action:"cmps_attlgfl",append:{t1:"cmpsTb"}}),t.preventDefault()})),a.addClass("largefiles")),s.attView&&(s.attView.attachLargeBtn=u),s.attComposer&&(s.attComposer
.attachLargeBtn=u),o.push(e.on("om:click_btn",function(e){if(!e.app||!e.app.instance||!e.tab)return}))}function W(){var t=this,n,r,i;if(!e.tictac||!e.tictac.attach){e.once("tictacs-loaded:ws:postLoad",function(){t._loadAtt()});return}e.use("mail-tt-attcomposer",function(e){n=t.baseNode.one("input[type=file]").ancestor("div"),r=t.baseNode.one("div.attachments-well"),i=t.baseNode.one("div.cm-rtetext"),t.attComposer=e.mail.tt.attcomposer.make(t,t.cdo,n,r,t.editor),t.onAttachmentsReady&&t.onAttachmentsReady(t.cdo),t._bindAttachmentsTT(),t.addAttachMenuItems(t.attComposer.btnAttachOption,t.attComposer.btnAttachCloud,t.attComposer.btnAttachFlickr),t._activateWellFresh()})}function X(){var t=this,n,r,s,o,u,a,f=t.cdo;t._bindCDO(),NeoConfig.useAttComposerTT&&t._loadAtt();if(t._isOrigin()){t.slowOriginReqTimer=setTimeout(function(){t._handleSlowOriginRequest()},g),t.loadingTimer=setTimeout(function(){t._displayLoading()},m),t.editor.hideArea();if(t.cdo&&t.cdo.get("passive")){var l=t.cdo.get("content");t.contentChangeAfter(l),t.replyheaderChangeAfter(),t.replyContentChangeAfter(l);if(t.cdo.get("attachments"))for(var c=0,h=f.oComposeData.attachments.length;c<h;c++)t.attView.addNewAttachment(c)}else i.fetchOrigin(f,t.isDraft,t.stopwatch,function(){t.isDraft&&f&&f.oComposeData&&f.oComposeData.origin&&f.oComposeData.origin.oMsg&&(t.draftMID=f.oComposeData.origin.oMsg.mid)});t.isDraft?(t.hasHardDraft=!0,t.draftMID=f.oComposeData.origin.oMsg.mid):(u=f.get("origin"),e.Lang.later(90,null,function(){t.neoFire("composeEvent",{action:"darlaEvent",type:"compose_"+u.action})})),r=f.oComposeData.origin.oMsg,s=r&&r.header&&r.header.to,o=t.baseNode.all("#from-field option"),e.Array.some(s||[],function(n){o.each(function(r,i){var s=r.get("value").replace(/.+\<(.+)\>/,"$1");if(n.email===s)return e.later(100,t,function(){r.get("parentNode").set("selectedIndex",i)}),!0})}),a=r.header?r.header.from:r.from,a&&t.isDraft&&e.later(10,t,function(){t.header._setFromMenu(a)})}else n=f.get("header"),t.header.setHeader(n),t._allowEditing(f.get("content")),t.dirty=f.get("prePopulated"),t.neoFire("composeEvent",{action:"darlaEvent",type:"compose_new"});f.get("passive")&&(t.dirty=1),t._initOpenMailButtons(),e.fire("FullCompose:fullComposeReady",{rte:t.editor,rteActive:t._isRTEActive()}),e.fire("compose-stat:fullComposeReady"),e.fire("read-stat:draftRendered"),!NeoConfig.smartscroll&&t.get("isQuickReply")&&t.compArea.setStyles({minHeight:"150px",maxHeight:t.maxHeight-parseInt(t.header.hdr.getStyle("height"),10)-b-6+"px"}),t.resizeRTE()}function V(){function i(){var t;if(r[e.rteTabIndex]==="#switchtext-plain"||r[e.rteTabIndex]==="#switchtext-rich")return n.one(r[e.rteTabIndex]);if(!e._isRTEActive()&&r[e.rteTabIndex]==="#attach-btn-menu a")return e.rteTabIndex=r.length-1,n.one(r[e.rteTabIndex]);do t=n.one(r[++e.rteTabIndex]);while(!t||t.ancestor().hasClass(h)||t.ancestor().getStyle("display")==="none");return t}function s(){var t;if(e.rteTabIndex===0)return n.one(r[e.rteTabIndex]);if(!e._isRTEActive()&&r[e.rteTabIndex]==="#switchtext-plain")return e.rteTabIndex=1,n.one(r[e.rteTabIndex]);do t=n.one(r[--e.rteTabIndex]);while(!t||t.ancestor().hasClass(h)||t.ancestor().getStyle("display")==="none");return t}function o(t){var n,r,o=e.baseNode.one(".attachments-pane");switch(t.keyCode){case 9:t.shiftKey||(n=e.baseNode.one(".attachments-well"),n&&!n.hasClass(h)?(r=n.one('li.attachmentVisible span.left a[tabIndex="0"]'),r||(r=n.one("li.attachmentVisible span.left a"),r&&r.set("tabIndex",0))):(t.target.blur(),e.setFocus("body"),t.halt()));break;case 13:t.target.simulate("click");break;case 32:t.target!==o?t.target._node.click():t.target.one("input")&&t.target.one("input")._node.click();break;case 37:t.target&&t.target.set("tabIndex",-1),r=s(),r&&(r.hasClass("attachments-pane")&&(r=r.one(".attachment-button-attach")),r.set("tabIndex",0),r.focus());break;case 39:t.target&&t.target.set("tabIndex",-1),r=i(),r&&r.set("tabIndex",0),r.focus();break;default:}}var e=this,t=e.handles,n=e.baseNode.one("div.rte-well-container"),r=[".attachments-pane",".icon-link"];t.push(n.delegate("keydown",o,'span[role="button"]'))}function $(t){var n=this,r=t.keyCode,i=(t.ctrlKey||t.metaKey)&&!t.altKey&&!t.shiftKey,s=e.UA.os,o=t.ctrlKey&&(s==="linux"||s==="windows"||s==="win")||t.metaKey&&(s==="macintosh"||s==="mac"),u;switch(r){case 85:o&&t.shiftKey&&!e.UA.ie&&(!e.UA.gecko||e.UA.gecko>1.92)&&(u=n.baseNode.one(".attachments-pane input"),u._node.click(),t.halt());break;case 13:if(o&&!t.altKey){var a={spid:"sent",append:{t1:"cmpsTb",actn:"keybrd",cmpsType:n.get("isQuickReply")?"QR":"fullCmps"},action:"tlbr_send"};return n.lastSendState&&(a.append.ltxt=n.lastSendState),e.fire("mt:click",a),n._handleSendAction(),t.frameEvent&&t.frameEvent.halt(),t.halt(),!0}if(t.target.get("nodeName")==="A")return t.target.simulate("click"),!0;break;case 65:i&&n._expandQuotedReply();break;case 83:if(i)return n._invokeSaveDraft(),t.frameEvent&&t.frameEvent.halt(),t.halt(),!0;break;case 89:if((t.ctrlKey||t.metaKey)&&t.shiftKey)return t.halt(),n.allowEdit&&n._cmdTextSwitch(),!0;break;case 219:case 221:e.fire("tabview:handleKeyDown",t);break;case 27:return n.header.neoFire("qrCancel"),!0;default:}return t.frameEvent&&(t.frameEvent.stopPropagation(),t.shiftKey&&r===9),i?!0:!1}function J(e){var t=this,n=t.baseNode.one("div.rte-well-container"),r,i=n.one(".attachments-well");t.rteTabIndex=0,i&&!i.hasClass(h)?(i.all("li.attachmentVisible span.left a").each(function(e){!r&&e.get("tabIndex")===0&&(r=e)}),r||(r=i.one("li.attachmentVisible span.left a"),r&&r.set("tabIndex",0))):(r=n.one(".attachments-pane"),r&&r.set("tabIndex",0)),r&&t.setFocus(r),e.frameEvent.halt()}function K(t){var n=e.Node.getDOMNode(t);return n!==null?n.tagName.toUpperCase()==="DIV":!1}function Q(){var e=this,t=e.cdo,n;e.handles||(e.handles=[]),n=e.handles,n.push(t.after("contentChange",function(t){e.contentChangeAfter(t)})),n.push(t.after("replyheaderChange",function(){e.replyheaderChangeAfter()})),n.push(t.after("replycontentChange"
,function(t){e.replyContentChangeAfter(t)})),n.push(t.after("originerrorChange",function(t){e._clearOriginTimers();var n=t.newVal;n.code!==o.net.Error.abort&&e._writeLoadingHtml("err")}))}function G(){var t=this,n=t.cdo,r=t.handles;r.push(n.on("CDO_ATTACHMENT_ADDED",function(e,n,r){t._setDirty(),r||(t.attachmentsLoading[n]=1),t.resizeRTE()})),r.push(n.on("CDO_ATTACHMENT_DELETED",function(n,r){t._setDirty(),t.attachmentsLoading[r]=0,e.UA.os==="macintosh"&&e.UA.chrome>=11?t.setFocus("body",0,1):t._restoreFocus(),t.resizeRTE()})),r.push(n.on("CDO_ATTACHMENT_PROCESSED",function(e,n){t._setDirty(),t.attachmentsLoading[n]=0,t.resizeRTE()})),r.push(n.on("CDO_ATTACHMENT_FILES_SELECTED",function(){var n=t.attachBtn;n&&n.blur(),e.UA.os==="macintosh"&&e.UA.chrome>=11?t.setFocus("body",0,1):t._restoreFocus(),t.resizeRTE()}))}function Y(){var t=this,n=t.cdo.attachments;t.handles.push(n.on("added",function(){t._setDirty(),t.attComposer.view.tray.scrollIntoView&&(t.attComposer.view.tray.scrollIntoView(),e.fire("attachmentsChanged",t.attComposer.view.tray)),t.resizeRTE()}),n.on("deleted",function(){t._setDirty(),setTimeout(function(){t.resizeRTE()},50)}),n.on("updated",function(e){t.resizeRTE();if(!e.isUploadDone())return;t._setDirty()}))}function Z(e){var t=this;e.uiUpdate||(e.newVal?t.editor.setContent(e.newVal,!e.textConvert):t.editor.setContent(t.cdo.get("content")))}function et(){var e=this,t=e.cdo,n=t.get("header"),r,i;i=t.get("origin"),e.header.setHeader(n),r=n.subject,e.neoFire("composeEvent",{action:"replyheaderLoad",subject:r})}function tt(e){var t=this,n=t.cdo.get("header");t._allowEditing(e.newVal,n.cc&&n.cc.length>0?n.cc:""),t.header.enableSwitchReplyButton(),t.dirty=!1}function nt(){var t=this;t.rtSwitch||(t.rtSwitch=t.baseNode.all("span.switchtext")),t.rtSwitch.each(function(n){t.handles.push(n.on("click",function(n){e.fire("mt:click",{action:"cmps_stchpt",append:{t1:"cmpsTb",ltxt:t._isRTEActive()?"plaintext":"richtext"}}),n.halt(!1),t.allowEdit&&t._cmdTextSwitch()}))})}function rt(e){function r(){t.editor.fire("beforeModeSwitch"),t.cdo.updateData({content:t.getContent()}),t._setDirty()}function s(){r(),t._expandQuotedReply(),i.toPlainText(t.cdo,t.editor.getContentAsPlainText()),t.resizeRTE(),t.setFocus("body"),t.editor.fire("afterModeSwitch")}var t=this,n;e=e||!1,t._isRTEActive()?t.editor.hasContent()&&!e?(n=!0,t.confirm(strings.str_rte_plaintext,strings.str_comp_conf_plainText,s)):s():(r(),i.toRichText(t.cdo),t.editor.fire("afterModeSwitch")),!n&&t.setFocus("body")}function it(){return!NeoConfig.low_bandwidth&&this.cdo.get("isRichText")}function st(){return this.spellCheckView&&this._isRTEActive()}function ot(e){return this.baseNode.one(".cm-"+e+" ul li")}function ut(){return this.editor.getContent()}function at(){return this.editor.getRTE()}function ft(t,n,r){var i=this,s=!0,o,u=i.editor.getRTE(),a,f,l,c;if(typeof t=="string"){o=i.baseNode.one(".compose-header");switch(t){case"to":case"cc":case"bcc":case"subject":o=i.baseNode.one(".compose-header"),t=o.one(".cm-"+t+"-field");break;case"body":t=u,s=r&&e.UA.os==="macintosh"&&e.UA.chrome>=11?0:i.editor.get("ready")}}s&&(t===u?(i.editor.setFocus(n),l=i.editor.rte.getInstance(),c=new l.EditorSelection,a=c.getCursor(),e.config.win.getSelection&&a&&a.item&&(a=a.item(0).getDOMNode(),f=window.getSelection(),f.selectAllChildren(a),f.collapseToStart())):t&&t.focus()),t&&i._registerFocus(t)}function lt(t,n){var r=this,i,s,o,u;n=n||"",r._clearOriginTimers(),r.header.enableHeader(!0),r.editor.showArea(),r.loadingArea.addClass(h);if(t)if(r.get("isQuickReply")&&r.cdo.oComposeData&&r.cdo.oComposeData.origin.action!=="forward"){r.isDraft||(u=e.UA.ie===9?"&nbsp;":e.Selection.CURSOR,t="<p>"+u+"</p>"+t),r.editor.setContent(t,!1);if(r.isDraft){i=r.cdo.get("yqtdPrefix");for(s=0;s<i.length;s++)o=r.getRTEDocNode().one("."+i[s]+"yahoo_quoted"),o&&o.setStyle("display","none")}else o=r.getRTEDocNode().one(".yahoo_quoted");o&&r.baseNode.one(".compose-quoted-text")&&r.baseNode.one(".compose-quoted-text").setStyle("display","block"),r.getRTEDocNode().one(".yahoo_quoted")&&r.getRTEDocNode().one(".yahoo_quoted").setStyle("display","none")}else r.editor.setContent(t,!r.isDraft);r.header.allowEditing(t,n),r.allowEdit=!0,r.fire("renderComplete")}function ct(e,t){var n=null;switch(e){case"fontname":n="userUIPref.composeFontFamily",t+="|1";break;case"fontsize":n="userUIPref.composeFontSize",t=parseInt(t,10),t=v[--t];break;default:}n&&t&&i.savePref(n,t)}function ht(){var t=this;t._formatPane||(t._formatPane=t.baseNode.one(".format-pane")),t.spellCheckBtn=t._formatPane.one('[data-action="spellcheck"]'),t.spellCheckMenuBtn=t.spellCheckBtn.next();var n=e.one("#menu-spell-langs");t.handles.push(t.spellCheckBtn.on("click",function(e){e.preventDefault(),t._isSpellCheckActive()?t.spellCheckView.destroy():t._doSpellCheck(n?n.one(".active").get("text"):null)}),t.spellCheckMenuBtn.on("click",function(e){e.preventDefault(),t._openSpellCheckMenu(e)}),t.on("SpellCheck:destroy",function(){t.spellCheckView=null,t.spellCheckBtn.removeClass("active")}))}function pt(e){var t=this;t.closeSrc="cancelBtn",e&&(t.dirty="ForceClose"),t.canClose()&&t.neoFire("composeEvent",{action:"closeAction"})}function dt(t){var n=!0,r={},s="",o=this;switch(t){case"send":r.spid="sent",o.lastSendState&&(s=o.lastSendState),o._handleSendAction();break;case"savedraft":o.blockSave=!0,o._invokeSaveDraft();break;case"cancelcompose":n=!1,o.cancelCompose();break;case"insertsignature":var u=o.cdo.get("isRichText"),a,f,l=i.getSignature(o.header.getHeader().from.email);l&&(a=o.assembleSendBody(),f=a.html,f=i.injectSignature(f,u,l),o.cdo.set("content",f,{textConvert:!0}))}n&&(r.append={t1:"cmpsTb",cmpsType:o.get("isQuickReply")?"QR":"fullCmps"},r.action="tlbr_"+t,s&&(r.append.ltxt=s),e.fire("mt:click",r))}function vt(n,r,s){var l=this,h=l.header.getHeader(),p=!0,d=!1,v,m,g,b,w,E=!0,S,x=l.getRTEDocNode(),T,N,C=!1,k;s=s||0;if(l.isSending){c({m:"another mail is being sent..."});return}k=function(e){l.allowSend=!0,e?l._restoreFocus
():l.setFocus("body",0,1)};if(!l.allowSend)return;if(l.baseNode.one(".file-attach .downloading:not(.hidden)")||NeoConfig.useAttComposerTT&&l.cdo.attachments.areAnyUploading&&l.cdo.attachments.areAnyUploading()){e.use("common-ui-dialog-helper",function(){c({m:"attachment uploading..."}),l.allowSend=!1,o.ui.DialogHelper.alert({hd:strings.str_comp_dialogheader,bd:strings.str_comp_still_uploading,suppressRestoreFocus:!0},{ok:{handler:k},cancel:{handler:k}})}),l.lastSendState="attInPrgrss";return}if(l.attView&&l.attView.checkOverLimit()){l.lastSendState="attOvrLmt",c({m:"Failure: attachment oversize"});return}NeoConfig.useAttComposerTT&&(p=l.cdo.attachments.areSendable(),d=l.cdo.attachments.areAnyInfected());if(!p){l._alertInvalidAttachments(d),l.lastSendState="attInvld",c({m:"Failure: attachment not valid"});return}if(typeof l.cdo.attachments=="object"&&!l.cdo.attachments.count()&&NeoConfig.attachAlert){var L=i.attachAlert(l.getContent(),l.cdo.get("content"));if(L){l.allowSend=!1;var A=strings.str_modal_send_msg_title,O='You mentioned "'+L+'" in your mail but there are no attachments! Send anyway?',M=strings.str_comp_send;l.confirm(A,O,function(){D()},function(){k()},M)}}if(!h.validAddress){var _=strings.str_comp_invalidAddressA+"<br><br>"+f(h.currentAddress)+"<br><br>";_+=a(strings.str_comp_invalidAddressB,null,null,null,strings),l._alertProblem(strings.str_comp_title_invalidAddr,_),l.lastSendState="addInvld",c({m:"Failure: invalid recipient email address"});return}if(h.to.length<1&&h.cc.length<1&&h.bcc.length<1){l._alertProblem(strings.str_comp_title_emptyToField,strings.str_comp_emptyToField),l._registerFocus(e.one("#to-field")),l.lastSendState="addEmpty",c({m:"Failure: recipient email address empty"});return}if(l.isSaving&&s<y){l.container.showComposeShim(!0),c({m:"set up send retry while save is in progress"}),e.later(1e3,l,vt,[n,r,s+1]);return}l.isSaving&&s>=y&&(C=!0),T=x.all("a"),T.each(function(e){var t;try{t=e.get("href")}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailcompose-message-composeview:3",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailcompose-message-composeview:3"),t=""}typeof t=="string"&&(t=t.replace(/&amp;/g,"&"),e.set("href",t))}),e.fire("SentStart"),S=new u.Stopwatch("SendConfirm","start"),v=l.assembleSendBody();var D=function(){var t=l.baseNode.one(".attachment-button-attach"),r=l.cdo.get("origin"),i,s,o={cmpsType:l.get("isQuickReply")?"QR":"fullCmps",count:h.to.length+h.cc.length+h.bcc.length},u={header:h,content:v.html,textcontent:v.text},a={draftMID:l.draftMID,noScroll:n,cid:r.oMsg&&r.oMsg.cid};l.isSending=!0,l._cancelSaveTimer(),l.dirty=!1,t&&t.fire("compose:close"),c({m:"Start Sending......",subject:u.header.subj}),l.cdo.updateData(u),l.cdo.fire("sending"),s=l.cdo.get("saveaction"),i=s&&s.isMailboxBusy||!1,l.container.invokeSend(l.cdo,a,S,{isSaveTimedOut:C,isMailboxBusy:i}),e.fire("mt:click",{action:"msg_send",append:o})};m=t(h.subj),g=t(v.text),l.getRTEDocNode().one("img")&&(E=!1),m.length<1&&g.length<1&&E&&(b=strings.str_modal_send_msg_title,w=strings.str_comp_invalidSubjectAndContent,N=strings.str_comp_send,l.lastSendState="sbCntInvld",c({m:"Warning: both subject and content are empty"})),l.allowSend&&(w?(l.allowSend=!1,l.confirm(b,w,function(){D()},function(){k(e.one("#subject-field"))},N)):D())}function mt(e){var t=this,n,r=t.baseNode.one(".attachment-button-attach");e?n=t.cdo.after("saveactionChange",function(e){if(e&&e.newVal&&e.newVal.state===1)return;n.detach(),t.neoFire("composeEvent",{action:"closeAction",forceClose:!0}),r.fire("compose:close")}):(r.fire("compose:close"),t.neoFire("composeEvent",{action:"closeAction",forceClose:!0}))}function gt(){}function yt(t){var n=this,s,o,u=n.getRTEDocNode(),a=u,f,l,c;f=t?n.editor.getContentOnSave():n.editor.getContent(),s=n.cdo.get("yqtdPrefix");if(u.one(".yahoo_quoted")&&u.one(".yahoo_quoted").getStyle("display")!=="block"||s){a=e.Node.create("<div>"+f+"</div>"),l=a.one(".yahoo_quoted"),t||n._insertEmptyLineBeforeQuotedText(a),l&&l.setStyle("display","block");if(s)for(o=0;o<s.length;o++)c=a.one("."+s[o]+"yahoo_quoted"),c&&c.setStyle("display","block");f=a.get("innerHTML")}return n._isSpellCheckActive()&&r.Controller.SpellCheck.removeAllMarkers(u,null),i.assembleSendBody(a,n.editor.richFontInfo,f)}function bt(){var e=this;if(e._isSpellCheckActive())return;e.spellCheckView===null&&(strings.str_tog_spellcheckEnabled?(e.spellCheckView=new r.ui.SpellCheckView(e,e.cdo),e.spellCheckBtn.addClass("active")):e.spellCheckView=!1)}function wt(t){var n=this;e.use("mail-ui-composeview-spellcheck",function(){n._activateSpellCheck(),n._isSpellCheckActive()&&(n.spellCheckView.doSpellCheck(t),n.setFocus("body"),n.neoFire("composeEvent",{action:"darlaEvent",type:"spell_chk"}))})}function Et(t){var n=this;e.use("mail-ui-composeview-spellcheck",function(){n._activateSpellCheck(),n._isSpellCheckActive()&&n.spellCheckView.showLangMenu(t)})}function St(){return this.editor.getRTE().getInstance()}function xt(){return this.editor.getDoc()}function Tt(e){var t=this,n,i=r.model.DataStore.Messages.getPermMidPart;if(e.flavor!==t.flavor)return!1;if(e&&e.oMsg&&t.draftMID)return i(t.draftMID)===i(e.oMsg.mid);if(!t._isOrigin())if(!e||!e.oMsg)return!0;return e&&e.oMsg?(n=t.cdo.get("origin"),e.action===n.action&&e.fid===n.fid&&e.oMsg.mid===n.oMsg.mid&&e.forwardAsAttachment===n.forwardAsAttachment):!1}function Nt(){var e=this,t;return t=e.cdo.get("origin"),t.action&&t.fid&&t.oMsg}function Ct(){var e=this,t;t=e.cdo.get("origin"),e._clearOriginTimers(),e._writeLoadingHtml(t.errInfo==="ok"?"pop":"slow")}function kt(){var e=this;e._writeLoadingHtml("start")}function Lt(e,t){this.editor.setContent(e,t)}function At(e){var t=this;t.loadingArea.hasChildNodes()&&t.loadingArea.get("children").remove().destroy(!0),t.loadingArea.appendChild(n(a(d.base,null,t.loadFormatters,e,strings,l)))}function Ot(){var e=this;e.slowOriginReqTimer&&clearTimeout(e.slowOriginReqTimer
),e.loadingTimer&&clearTimeout(e.loadingTimer)}function Mt(e){var t=this,n,r,i=t.baseNode.one(".save-draft-msg");n=function(){return e?strings.str_comp_saving_draft:t.lastSaveType===-1?a(strings.str_comp_saveasdraftfail,0,0,0,{autosave_time:t.lastSave}):t.lastSave?t.lastSaveType===1?a(strings.str_comp_autosave,0,0,0,{autosave_time:t.lastSave}):a(strings.str_comp_saved,0,0,0,{saved_time:t.lastSave}):""},r=n(),i.removeClass("hidden"),i.set("innerHTML",r),i.setAttribute("aria-label",r)}function _t(t){var n=this,r,i;n.allowSend?e.use("common-ui-dialog-helper",function(){n.allowSend=!1,r={hd:t?strings.str_rte_attachments_alert_virus_title:strings.str_comp_dialogtitle_invalidSendAttachments,bd:t?strings.str_rte_attachments_alert_virus:strings.str_comp_dialogbody_invalidSendAttachments,suppressRestoreFocus:!0},i=function(){n.allowSend=!0,n._restoreFocus()},o.ui.DialogHelper.alert(r,{ok:{handler:i},cancel:{handler:i}})}):n._restoreFocus()}function Dt(e,t){var n=this;t=t||!n.draftMID,n._invokeSaveDraft({forceSave:t,auto:!0})?n.once("compose:saveSuccess",function(){e(n.draftMID)}):n.draftMID&&e(n.draftMID)}function Pt(e){var t=e||this.getSaveNotification();if(!t)return;var n=this.baseNode&&this.baseNode.one(".bottomToolbar");n&&n.one(".save-draft-msg").setContent(t)}function Ht(){var e=this;return e.lastSaveType===-1?a(strings.str_comp_saveasdraftfail,0,0,0,{autosave_time:e.lastSave}):e.lastSave&&e.lastSaveType===1?a(strings.str_comp_saved_fresh,0,0,0,{saved_time:e.lastSave}):""}function Bt(t,n){function i(n){n&&e.use("mail-controller-messages",function(e){e.mail.Controller.Messages.get({fid:"Draft",msg:{mid:n},cachekey:"SaveMessage",noCache:!0},function(e){!e||!e.mid||!e.part||t(e)})})}var r=this;r.getMID(i,n)}function jt(t,n){function o(r){var o,u;if(!r.attachments||r.attachments.length!==i.count())return;u=r.attachments[i.order(t)];if(e.Lang.trim(u.filename)!==s)return;o={fid:"Draft",mid:r.mid,size:u.size,pid:u.partId,filename:u.filename},typeof u.tnefId!="undefined"&&(o.tnefid=u.tnefId),n(o)}var r=this,i=r.cdo.attachments,s=i.get(t).filename;r.attGetMsg(o)}function Ft(){var e=this,t;return t={bidi:NeoConfig.bidi,isRTL:NeoConfig.isRTL,isFullSSL:NeoConfig.isSSL,isRich:e._isRTEActive(),getDefaultFontInfo:i.getDefaultFontInfo,convertToPlain:i.convertToPlain,smartscroll:NeoConfig.smartscroll&&e.get("isQuickReply")},t}function It(){var e=this.cdo.get("header"),t=this.cdo.get("textcontent");return e.currentAddress||e.to&&e.to.length>0||e.cc&&e.cc.length>0||e.bb&&e.bcc.length>0||e.subject&&e.subject.trim()!==""||t&&t.trim()!==""}var t=e.Lang.trim,n=e.Node.create,r=e.mail,i=r.Controller.Compose,s=[],o=e.common,u=o.Utils,a=u.substitute,f=u.escapeHtml,l=e.ui.Templates,c=u.log,h="hidden",p="focus",d=l._shared_module_compose_loading,v=[10,13,16,0,24,32,48],m=2e3,g=7e3,y=30,b=67,w="offscreen",E="restore",S=function(t,n,i,s,o){var u=this,f;S.superclass.constructor.apply(u,arguments),u.spellCheckView=null,u.spellCheckLang=null,u.wordsToIgnore=[],u.scView=null,u.slowOriginReqTimer=null,u.keepHdrFocus=!1,u.formatShortcutTimer=null,u.mouseFocusEvent=!1,u.composeViewRendered=!1,u.rteTabIndex=0,u.type="fullCompose",u.handles=[],u.lastSendState=null,u.closeSrc="closeBtn",u.containerNode=o.containerNode,u.hasRTEFormatter=!0,u.flavor="compose",u.addAttrs({keydownHandler:{value:null},isQuickReply:{value:!1},noFocus:{value:!1}},o),o.maxHeightFn&&(u.maxHeightFn=o.maxHeightFn,u.maxHeight=u.maxHeightFn()),f=u._getEditorConfig(),u.editor=new r.RTEView(f),u.addChild(u.editor),u.loadFormatters={start:function(e,t){return t==="start"?a(d.start,null,null,null,strings):""},slow:function(e,t){return t==="slow"?a(d.slow,null,null,null,strings):""},error:function(e,t){return t==="err"?a(d.error,null,null,null,strings):""},populate:function(e,t){return t==="pop"?a(d.populate,null,null,null,strings):""}},NeoConfig.bidi&&e.use("comms-intl-bidihighlight"),u.neoEvent("composeEvent",{emitFacade:!0,broadcast:1});var l=t.get("origin");u.enableSaveDraft=l&&l.oMsg?!0:!1};e.extend(S,r.ui.MailComposeConv),e.mix(S.prototype,{NAME:"FullCompose",render:F,bindUI:A,_bindWellUIFresh:_,onKeyDown:$,onFocus:K,closeCompose:C,hasContent:It,getContent:ut,getRTE:at,getRTEInstance:St,getRTEDocNode:xt,getFirstNode:ot,setFocus:ft,contentChangeAfter:Z,replyheaderChangeAfter:et,replyContentChangeAfter:tt,updateSaveText:Mt,postRender:X,matchOrigin:Tt,setContent:Lt,addAttachMenuItems:z,_bindCDO:Q,_initOpenMailButtons:U,_addFocusListenersFresh:V,_handleShiftTabFresh:J,_handleSendAction:L,handleComposeAction:dt,_insertEmptyLineBeforeQuotedText:P,_intlBindUIRTE:gt,_allowEditing:lt,_isRTEActive:it,assembleSendBody:yt,_invokeSend:vt,_closeAfterWarning:mt,_activateWellFresh:j,_renderWellsFresh:B,_bindTextSwitchFresh:nt,_cmdTextSwitch:rt,_alertInvalidAttachments:_t,_initializeSpellCheck:ht,_activateSpellCheck:bt,_isSpellCheckActive:st,_doSpellCheck:wt,_openSpellCheckMenu:Et,_isOrigin:Nt,_handleSlowOriginRequest:Ct,_displayLoading:kt,_writeLoadingHtml:At,_clearOriginTimers:Ot,_setComposePreference:ct,_bindAttachments:G,_bindAttachmentsTT:Y,attGetMsg:Bt,attGetDownloadInfo:jt,attDownload:jt,getMID:Dt,_showSendBtn:O,_showDraftBtn:M,_expandQuotedReply:H,showComposeView:x,hideComposeView:T,getSubjectInfo:N,initializeRTEFormatter:D,getSaveNotification:Ht,setSaveNotification:Pt,cancelCompose:pt,resizeRTE:q,doResizeRTE:R,fixBottom:I,_getEditorConfig:Ft,_loadAtt:W,ondestroy:k},!0),e.namespace("mail"),r.ComposeViewConv=S},"1.0.0",{requires:["_shared_module_compose_fresh_conv","_shared_module_compose_loading","_shared_module_compose_reply","_shared_module_offscreen_bin_compose","_shared_module_offscreen_bin_compose_menu_indent","_shared_module_offscreen_bin_compose_menu_list","_shared_module_offscreen_bin_compose_menu_spellcheck","_shared_module_offscreen_bin_compose_menu_text_align","_shared_module_offscreen_bin_compose_modal_cancel_compose","_shared_module_rte_well_content_attachments_fresh","_shared_module_rte_well_content_emoticons_fresh","_shared_module_rte_well_content_fontnamesize_fresh"
,"_shared_module_rte_well_content_format_fresh","_shared_module_rte_well_tabs_compose_fresh","_shared_module_toolbar_compose_fresh","attachments-fresh_css","common-ui-menu-helper","common-ui-toolbar-base","comms-bidi-textentry","comms-editor-autobidi","comms-intl-bidi","contacts-api","contacts-api-utils","editor-base","editor-bidi","editor-br","editor-para","filter-contacts","mail-controller-compose-text","mail-model-compose","mail-ui-composeview-attach","mail-ui-mailcompose","mail-ui-messagepane-utils","mail-ui-rte-formatter","mail-ui-rteview","node","plugin","stylesheet"]});
YUI.add("_shared_module_compose_title",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_compose_title={base:"<span class='compose'><span>{{str_comp_title}}</span>{{compose_title}}</span>"};},"1.0.0");YUI.add("mail-ui-composeview-conv",function(E){var N=E.Node.create,T="hidden",H=E.common.Utils,R=H.substitute,X=H.log;var L=E.mail.ui.ConvComposeView=function(c,b,Y,e,d){var f=this;f.parent=Y;f.eventHandlers=d||{};f.initCompose(c,b,e);};function K(b,Y,c){var d=this;d.cdo=b.cdo||d.initComposeData(b,Y);d.subview=d.createComposeView(d.cdo,Y,b,c);d.bindComposeView();return d.subview;}function U(c,b){var d=this,Y;c&&c.cdo?Y=c.cdo:Y=E.mail.Controller.Compose.createCDO();if(b){d.setDraftOrigin(Y,c);d.setDraftFromAddress(Y);}else{d.setMessageFromAddress(Y);d.setMessageOrigin(Y,c);}if(c&&c.cbfn){Y.set("prePopulated",true);c.cbfn(Y,c);}if((!c||!c.action||!c.fid||!c.oMsg)&&!(c.cdo&&c.cdo.get("passive"))){E.mail.Controller.Compose.insertSignature(Y);}return Y;}function Z(Y,c,d,e){var f=this,b=null;if(d.flavor=="autocompose"){b=new E.mail.AutoComposeView(Y,c,f,d,e);}else{b=new E.mail.ComposeViewConv(Y,c,f,d,e);}f.composeView=b;b.neoFire("composeEvent",{action:"addChild","subview":b});b.neoFire("composeEvent",{action:"addSubview","subview":b});f.composeView.set("active",true);return b;}function Q(){var b=this,Y;if(b.parent){Y=this.parent.all(".compose-loading-wrapper");if(Y){Y.remove();}b.composeView.render(b.parent);X({"m":"finish compose initial rendering"});b.composeViewTainer=b.composeView.baseNode;X({"m":"finish compose post rendering"});}b.composeView.on("FullCompose:composeEvent",b.handleEvent,b);b.composeView.neoFire("composeEvent",{action:"bindComplete",ccv:b});}function M(b){var c=this,Y=b.action;if(c.eventHandlers&&c.eventHandlers[Y]){c.eventHandlers[Y](b);}}function B(Y){var b=Y.get("header");b.from=E.mail.Controller.Compose.getDefaultFromAddress();Y.set("header",b);}function G(Y,b){if(b&&b.action&&b.fid&&b.oMsg){Y.set("origin",{action:b.action,fid:b.fid,oMsg:b.oMsg,parentMsg:b.parentMsg,ctxReq:null});}}function P(Y){var c=Y.get("header"),b=Y.get("origin").oMsg;c.from=b.from?b.from:(b.header||{}).from;Y.set("header",c);}function V(Y,b){if(b&&b.action&&b.fid&&b.oMsg){Y.set("origin",{action:b.action,fid:b.fid,oMsg:b.oMsg,forwardAsAttachment:b.forwardAsAttachment,ctxReq:null});}}function D(Y){this.parent=Y;}function F(Y,e,b,c){var d=this;b&&b.start(1,"moduleLoad");E.use("mail-controller-sendconfirm","mail-ui-sendconfirmview-base-conv",function(g){var f=d.sendConfirmView?d.sendConfirmView.sdo:null;if(b){b.start(1,"prepareSend");b.action="normal";}f=g.mail.Controller.Compose.transformSend(Y,f,e,true);X({"m":"Create sdo based on cdo","misc":e});d.createSendConfirmView(f,Y);g.mail.Controller.SendConfirm.sendMessage(f,b,d.composeView.flavor,c);g.use("contacts-api-utils",function(){d.showSendConfirm(e.noScroll);});});}function J(d,Y){var h=this,g=Y.get("origin"),f=0,e=0,c=null,b=null;if(!!g&&g.action&&g.action==="reply_sender"||g.action==="reply_all"){f=1;}else{if(!!g&&g.action==="forward"){e=1;}}c=new E.mail.SendConfirmView({sdo:d,container:h,isReply:f,isForward:e});b=N('<div class="hidden">');b.addClass(T);c.render(b);h.parent.appendChild(b);c.postrender(b);c.neoFire("sendConfirmEvent",{action:"addChild","subview":c});h.sendConfirmView=c;c.neoFire("sendConfirmEvent",{action:"addSubview","subview":c});h.sendConfirmViewTainer=b;h.bindSendConfirmView();}function I(){var Y=this;Y.sendConfirmView.on("SendConfirmView:sendConfirmEvent",Y.handleEvent,Y);}function a(Y){this.composeView.neoFire("composeEvent",{action:"updateTitle",sending:Y});}function C(Y){var b=this;b.composeViewTainer.one(".composeshim")[Y?"removeClass":"addClass"]("hidden");if(Y){b.composeViewTainer.addClass("sending");}else{b.composeViewTainer.removeClass("sending");}b.updateSendingTabTitle(Y);}function W(){var b=this,Y=E.ui.Templates._shared_module_offscreen_bin_notification_notifications.send_abuse;b.notification=new E.common.ui.Notification({sticky:true,type:"fade",className:"top",parent:".nav-bar"});b.notification.notify(R(Y,null,null,null,strings));}function O(b){var c=this,Y=E.ui.Templates._shared_module_offscreen_bin_notification_notifications.send_error;if(b){E.use("common-ui-dialog-helper","_shared_module_offscreen_bin_modal_btn_generic",function(e){var f=H.substitute(e.ui.Templates._shared_module_offscreen_bin_modal_btn_generic.base,0,0,0,{btnID:"cancel","default":"default",btnLabel:strings.str_toolbar_back_to_message}),d={hd:b.title,bd:b.body,ft:f};e.common.ui.DialogHelper.createCommon(d,{cancel:{handler:function(){c.composeView.neoFire("composeEvent",{action:"switchToTab"});}}});});}else{c.notification=new E.common.ui.Notification({sticky:true,type:"fade",className:"top",parent:".nav-bar"});c.notification.on("clickEvent",function(d){if(d.action==="retry"){c.composeViewTainer.one("a[data-action=send]").simulate("click");c.showComposeShim(true);}});c.notification.notify(R(Y,null,null,null,strings));}}function S(){var Y=this;Y.showComposeShim(true);if(Y.notification){Y.notification.hide();Y.notification=null;}Y.composeActive=false;Y.subview=Y.sendConfirmView;}function A(Y){var b=this;b.composeView.isSending=false;b.composeView.resetSaveTimer();if(Y){b.composeView.dirty=true;b.composeView.allowSend=true;}b.composeActive=true;}L.prototype={initCompose:K,initComposeData:U,setMessageFromAddress:B,setDraftOrigin:G,setDraftFromAddress:P,setMessageOrigin:V,createComposeView:Z,bindComposeView:Q,setParent:D,invokeSend:F,createSendConfirmView:J,showSendConfirm:S,handleEvent:M,bindSendConfirmView:I,showCompose:A,showComposeShim:C,updateSendingTabTitle:a,notifyAbuse:W,notifyError:O};},"1.0.0",{requires:["mail-controller-base","mail-controller-compose","mail-ui-fullcompose","_shared_module_compose_title","_shared_module_offscreen_bin_notification_notifications","common-ui-notification"]});YUI.add("mail-ui-authorview-conv",function(F){var K=F.Node.create,p=F.common.Utils,AB=p.substitute,b=p.escapeHtml,e=p.unescapeHtml,A=p.log,R=F.ui.Templates,n=R._shared_module_toolbar_compose_fresh,j="[data-action='send']";var k=function(Y){var AG=this,AF;AG.keyCodes=[];AG.keyCodesL10N={};AG.parent=null;AG.subview=null;AG.subviews=[];AG.cdo=null;AG.composeView=null;AG.sendConfirmView=null;AG.sendConfirmViewTainer=null;AG.captchaView=null;AG.captchaViewTainer=null;AG.localCharCodes=[8,77,78,73,84];AG.composeActive=true;AG.type="author";AG.widgetType="compose";AG.keyCodesL10N[strings.str_cfg_sc_keycode_save_as_draft]=83;AG.keyCodesL10N[strings.str_cfg_sc_keycode_close_tab]=220;for(AF in AG.keyCodesL10N){AG.keyCodes.push(AF);}k.superclass.constructor.call(AG,Y);AG.set("charCodes","13,13+ctrl,13+meta,27,188+ctrl,190+ctrl,"+AG.keyCodes.join("+ctrl,")+"+ctrl,"+AG.keyCodes.join("+meta,")+"+meta");if(F.UA.ie){AG.set("localCharCodes",AG.localCharCodes.join());}AG.closeChgHandler=AG.on("closeChange",AG.handleCloseChange,AG);if(NeoConfig.hasConvView){AG.msgsRemoveHandler=F.on("ds:conv:remove",AG.handleConvRemove,AG);}else{AG.msgsRemoveHandler=F.on("ds:msg:remove",AG.handleMsgRemove,AG);}AG.updateTabTitle(AG.get("title"));AG.activeChangedHandler=AG.on("activeChange",AG.handleActiveChange);AG.tbFormatters={lastsaved:function(){return AG.subview.setSaveNotification();},isDirty:function(){return AG.subview.enableSaveDraft?"":AB(n.isDirty,null,null,null,strings);}};};function d(Y){var AF=this;if(Y.newVal){AF.updateToolbar();AF.subview.set("active",true);AF.subview.showComposeView(Y);}else{AF.subview.set("active",false);AF.subview.hideComposeView(Y);}}function P(Y){var AF=this;if(Y.newVal){AF.subview.closeCompose();}}function c(AL,Y,AH,AJ,AG){var AF,AI=Y||[],AK;if(AG&&AG.reason==="savedraft"){return;}if(AL!=="Draft"){return;}for(AF=0;AF<AI.length;AF++){AK=AI[AF];if(this.subview.draftMID===AK.mid){this.set("close",1);}}}function AE(AH,AI){var Y,AF=AI||[],AG;if(AH!=="Draft"){return;}for(Y=0;Y<AF.length;Y++){AG=AF[Y];if(AG.totalMsgs===1&&this.subview.draftMID===AG.recentmid){this.set("close",1);}}}function z(AF){var AG=this;var Y="str_comp_nosubject";AF=AF||strings[Y];AG.set("title",AF);}function v(Y){var AF=this;AF.set("direction",Y);}function w(AG){var AH=this,Y=AH.localCharCodes.length,AF;for(AF=0;AF<Y;AF++){if(AG===AH.localCharCodes[AF]){return true;}}return false;}function B(){var Y=this;if(Y.subview){return([Y.subview]);}}function H(Y){var AG=this,AF=Y.keyCode;AF=AG.keyCodesL10N[AF]||AF;switch(AF){case 220:if(!Y.altKey&&(Y.metaKey||Y.ctrlKey)){AG.set("close",1);return true;}break;case 27:if(AG.composeView){AG.composeView.closeSrc="escKey";}if(!(F.ACWidgetInst.handleEscape&&F.ACWidgetInst.handleEscape())){AG.set("close",1);}return true;}if(F.UA.ie&&AG.subview.onLocalKeyDown){if(!AG.subview.onLocalKeyDown(Y)){return false;}}if(AG.subview&&AG.subview.onKeyDown){return AG.subview.onKeyDown(Y);}else{return null;}}function g(Y){var AF=this;if(AF.subview.onFocus){return AF.subview.onFocus(Y);}else{return null;}}function q(){var Y=this;if(Y.subview.isDirty){return Y.subview.isDirty();}else{return true;}}function G(){return !this.isDirty()&&!this.subview.hasContent();}function C(){var Y=this;if(Y.subview.isSaved){return Y.subview.isSaved();}else{return false;}}function a(Y){var AF=this;if(AF.subview.matchOrigin){return AF.subview.matchOrigin(Y);}else{return false;}}function u(Y){var AF=this;AF.set("contentToolbar",Y);if(Y){AF.toolBarHandler=Y.on("itemSelected",N,AF);}}function N(AF){if(AF.item&&AF.item.ancestor().hasClass("disabled")){return;}var AG=this,Y=AF?AF.dataAction:0;if(F.UA.ie&&F.UA.ie<=9&&AF.item&&AF.item.hasClass("disabled")){return;}switch(Y){case"cancelcompose":AG.closeSrc="cancelBtn";AG.set("close",1);break;case"send":case"savedraft":case"insertsignature":AG.subview.handleComposeAction(Y,AF);break;default:break;}}function X(Y){this.subviews.push(Y);}function t(AG,AF){var AH=this,Y;AG.cdo&&AG.cdo.get("passive")?Y=AG.cdo:Y=F.mail.Controller.Compose.createCDO();if(AF){AH.setDraftOrigin(Y,AG);AH.setDraftFromAddress(Y);}else{AH.setMessageFromAddress(Y);AH.setMessageOrigin(Y,AG);}if(AG&&AG.cbfn){Y.set("prePopulated",true);AG.cbfn(Y,AG);}if((!AG||!AG.action||!AG.fid||!AG.oMsg)&&!(AG.cdo&&AG.cdo.get("passive"))){F.mail.Controller.Compose.insertSignature(Y);}return Y;}function h(AF,Y){var AG=this;AG.cdo=AG.initComposeData(AF,Y);AG.subview=AG.createComposeView(AG.cdo,Y,AF).subview;AG.subviews.push(AG.subview);if(AF&&AF.postRender){AG.subview.handles.push(AG.subview.on("renderComplete",function(){AF.postRender(AG,AF);}));}if(AF&&AF.oMsg&&AF.oMsg.header){AF.oMsg.header.subject=F.mail.Controller.Compose.seedSubject(AF);}return AG.subview;}function T(Y,AF){if(AF&&AF.action&&AF.fid&&AF.oMsg){Y.set("origin",{action:AF.action,fid:AF.fid,oMsg:AF.oMsg,forwardAsAttachment:AF.forwardAsAttachment,ctxReq:null});}}function V(Y){var AF=Y.get("header");AF.from=F.mail.Controller.Compose.getDefaultFromAddress();Y.set("header",AF);}function Z(Y,AF){if(AF&&AF.action&&AF.fid&&AF.oMsg){Y.set("origin",{action:AF.action,fid:AF.fid,oMsg:AF.oMsg,ctxReq:null});}}function i(Y){var AG=Y.get("header"),AF=Y.get("origin").oMsg;AG.from=AF.from?AF.from:(AF.header||{}).from;Y.set("header",AG);}function M(Y,AG,AH){var AI=this,AF=null;if(Y){AH.cdo=Y;}A({"m":"start creating ConvComposeView"});AF=new F.mail.ui.ConvComposeView(AH,AG,AI.get("parentNode"),{keydownHandler:F.bind(AI.onKeyDown,AI)},AI.getEventBindings());AF.handles=[];AI.composeView=AF;return AF;}function AA(Y){Y.action=Y.type;this.fire("darlaEvent",Y);}function y(){var Y=this;Y.parent=Y.get("parentNode");Y.composeView.setParent(Y.parent);Y.composeView.bindComposeView();}function f(AF){var AG=this,Y=F.one(AF);AG.set("parentNode",Y);AG.set("rootNode",Y.one("div.compose"));return;}function x(){return;}function L(Y){var AF=this;AF.composeView.composeViewTainer&&this.composeView.composeViewTainer.one(".composeshim")[Y?"removeClass":"addClass"]("hidden");AF.disableToolbar(Y);if(Y){AF.tab&&AF.tab.elTab.addClass("sending");
}else{AF.tab&&AF.tab.elTab.removeClass("sending");}}function U(Y){var AG=this,AF=AG.get("contentToolbar").get("content");AF.all(".btn")[Y?"addClass":"removeClass"]("disabled");}function W(){var AF=this,Y=AF.subview.getSubjectInfo();if(Y.subjectVal){AF.updateTabTitle(b(e(Y.subjectVal)));if(Y.subjectDir){AF.updateTabDirection(Y.subjectDir);}}else{AF.updateTabTitle(AF.subview.title);if(Y.subjectDir){AF.updateTabDirection("");}}}function m(){var Y=this;Y.msgsRemoveHandler&&Y.msgsRemoveHandler.detach();Y.closeChgHandler&&Y.closeChgHandler.detach();Y.toolBarHandler&&Y.toolBarHandler.detach();k.superclass.ondestroy.call(Y,arguments);}function AD(Y){var AF=this;AF.updateTabTitle(b(e(Y.subject)));if(NeoConfig.bidi){AF.updateTabDirection(F.Intl.detectDirection(Y.subject));}}function Q(Y){var AF=this;return(AF.subview.canClose(Y));}function l(Y){var AF=this;if(Y.forceClose){AF.set("forceClose",1);}AF.set("close",1);}function O(Y){var AF=this;AF.set("focusNode",Y.focusNode);}function r(){if(this.tab!==F.mail.Tabs.getActiveTab()){F.mail.Tabs.switchToTab(this.tab);}}function AC(Y){var AF=this;if(AF.tab!==F.mail.Tabs.getActiveTab()){F.mail.Tabs.switchToTab(AF.tab,Y.sdcbk());}else{Y.sdcbk();}}function E(AG){var AH=this,AF=AH.get("contentToolbar"),Y=AF&&AF.root.one(j);if(AG.action==="showSendBtn"){Y&&Y.removeClass("disabled");}else{Y&&Y.addClass("disabled");}}function s(AG){var AH=this,AF=AH.get("contentToolbar"),Y=AF&&AF.root.one(".savedraft");if(AG.action==="showDraftBtn"){Y&&Y.removeClass("disabled");}else{Y&&Y.addClass("disabled");}}function J(AF){var AH=this,AG,Y=AH.get("contentToolbar");if(Y&&(AG=Y.root.one(".lastsave"))){AG.set("innerHTML",AF.statusText);}}function o(){var AI=this,Y,AG,AF,AH;if(AI.isSending){return;}Y=K(AB(n.base,{},AI.tbFormatters,0,strings,R));AG=AI.get("contentToolbar");AF=AG&&AG.root.one(j);AH=AF&&!AF.hasClass("disabled");if(AH){Y.one(j).addClass("disabled");}AI.attachToolbar(new F.mail.ui.Toolbar({root:Y}));}function I(Y){var AF=this;AF.once("activeChange",function(AG){if(AG.newVal){AF.composeView.sendConfirmView.showCaptcha(Y);}});}function S(Y){var AF=this;if(Y.sending){AF.tab&&AF.tab.elTab.addClass("sending");}else{AF.tab&&AF.tab.elTab.removeClass("sending");if(Y.title){AF.updateTabTitle(Y.title);}else{AF.setSubjectAsTitle();}}}function D(){var AF=this,Y={"showSendBtn":F.bind(AF.showSendBtn,AF),"hideSendBtn":F.bind(AF.showSendBtn,AF),"setSaveNotification":F.bind(AF.setSaveNotification,AF),"showDraftBtn":F.bind(AF.showDraftBtn,AF),"hideDraftBtn":F.bind(AF.showDraftBtn,AF),"updateSubject":F.bind(AF.setSubjectAsTitle,AF),"closeAction":F.bind(AF.closeAction,AF),"qrCancel":F.bind(AF.closeAction,AF),"replyheaderLoad":F.bind(AF.replyheaderLoad,AF),"setFocusNode":F.bind(AF.setFocusNode,AF),"showSaveDialog":F.bind(AF.showSaveDialog,AF),"showCompose":F.bind(AF.showCompose,AF),"addSubview":F.bind(function(AG){this.addSubview(AG.subview);},AF),"addChild":F.bind(function(AG){this.addChild(AG.subview);},AF),"removeChild":F.bind(function(AG){this.removeChild(AG.subview);},AF),"showCaptcha":F.bind(function(AG){this.showCaptcha(AG.fault);},AF),"updateTitle":F.bind(AF.updateTitle,AF),"switchToTab":F.bind(AF.switchToTab,AF),"darlaEvent":F.bind(AF.fireDarlaEvent,AF)};return Y;}F.extend(k,F.mail.ui.BaseWidget);F.mix(k.prototype,{NAME:"AuthorView",ondestroy:m,onKeyDown:H,onFocus:g,bindUI:x,render:f,initCompose:h,initComposeData:t,createComposeView:M,bindComposeView:y,isLocalCharCode:w,isDirty:q,isClean:G,isSaved:C,matchOrigin:a,setMessageOrigin:T,setMessageFromAddress:V,setDraftOrigin:Z,setDraftFromAddress:i,attachToolbar:u,updateTabTitle:z,updateTabDirection:v,handleCloseChange:P,showComposeShim:L,getComposeWidgets:B,disableToolbar:U,setSubjectAsTitle:W,showSendBtn:E,showDraftBtn:s,setSaveNotification:J,setFocusNode:O,showSaveDialog:AC,_canClose:Q,closeAction:l,handleActiveChange:d,updateToolbar:o,replyheaderLoad:AD,getEventBindings:D,addSubview:X,showCaptcha:I,updateTitle:S,switchToTab:r,handleConvRemove:AE,handleMsgRemove:c,fireDarlaEvent:AA},true);F.namespace("mail.ui");F.mail.ui.AuthorViewConv=k;},"1.0.0",{requires:["mail-controller-base","mail-controller-compose","mail-ui-composeview-conv","_shared_module_compose_title","_shared_module_offscreen_bin_notification_notifications","_shared_module_toolbar_compose_fresh"]});