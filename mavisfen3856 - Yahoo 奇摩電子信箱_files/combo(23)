YUI.add("_shared_module_offscreen_bin_notification_tae_text",function(e){e.namespace("ui.Templates"),e.ui.Templates._shared_module_offscreen_bin_notification_tae_text={base:"{{tae_nf_text_generic}}{{contact_us}}{{contact_us_sbc}}",fix_internet:"<a href=\"#\" class='fix-internet expand-inline' data-action=\"expand-inline\"> <span class='icon nf-inline collapse'></span> {{fix_internet}} </a> ",hidden_text_mid:"<div class='nf-inline collapse'>{{hidden_text_mid}}</div> ",external_help:'<a href="{{url}}" target="_blank" class="external-help">{{external_help}}</a> ',more:'<a href="#" data-action="expand-inline" class="more expand-inline"> <span class=\'icon nf-inline collapse\'></span> {{more}} </a> ',hidden_text_end:"<div class='nf-inline collapse'>{{hidden_text_end}}</div> ",tae_nf_text_generic:'<div class="nf-hd">{{tae_hd}}</div> <div class="nf-bd">{{tae_bd}} {{fix_internet}} {{hidden_text_mid}} </div> <div class="nf-ft"> {{external_help}} {{more}} {{hidden_text_end}} <div class="tae-num">{{tae_num}}</div> </div>',contact_us:'<div class="contact-us"> {{str_tae_stillneedhelp}} <a href="https://{{lang_help_link}}.yahoo.com/kb/{{partner_id}}{{page_id}}.html?impressions=true" target="_blank">{{str_tae_contactus}}</a> </div>',contact_us_sbc:'<div class="contact-us"> {{str_tae_stillneedhelp}} <a href="{{url}}" target="_blank">{{str_tae_contactus}}</a> </div>'}},"1.0.0");
YUI.add("mail-errormap",function(e){e.namespace("mail.Errormap");var t=e.common.net.Error,n={BatchItemError:{},AccountVerificationRequired:{tae:0,message:"AccountVerificationRequired"},ComposeErrorBadFrom:{tae:0,message:"BadFrom"},InvalidFromAddress:{tae:0,message:"BadFrom"},ComposeErrorBadRecipient:{tae:0,message:"BadRecipient"},InvalidRecipientAddress:{tae:0,message:"BadRecipient"},MessageContentReject:{tae:0,message:"ContentRejected"},ExceededMaxDailyMessages:{tae:0,message:"DailyLimitExceeded"},FolderNameNotAllowed:{tae:0,message:"folder_name_is_reserved"},FolderNameTooLong:{tae:0,message:"folder_name_too_long"},FolderNameExists:{tae:0,message:"FolderAlreadyExists"},FolderIdIsSystemFolder:{tae:0,message:"FolderIdIsSystemFolder"},FolderNameIllegalCharacter:{tae:0,message:"FolderNameIllegalCharacter"},ExceededMaxHourlyMessages:{tae:0,message:"ExceededMaxHourlyMessages"},WrongInput:{tae:0,message:"HumanVerificationFailed",suppressStat:!0},HumanVerificationRequired:{tae:0,message:"HumanVerificationRequired",suppressStat:!0},ExceededMaxBcc:{tae:0,message:"MaxBCCAddressesExceeded"},ExceededMaxCc:{tae:0,message:"MaxCCAddressesExceeded"},ExceededMaxTo:{tae:0,message:"MaxToAddressesExceeded"},ExceededMaxRecipients:{tae:0,message:"MaxTotalAddressesExceeded"},MessageTooLarge:{tae:0,message:"MessageToLarge"},MessageTooLargeSomeRecipients:{tae:0,message:"MessageTooLargeForSomeRecipients"},NoRecipientsSpecified:{tae:0,message:"MissingRecipients"},NicknameExpansionFailed:{tae:0,message:"NicknameExpansionFailed"},NoSenderSpecified:{tae:0,message:"NoSenderSpecified"},TooManyFolders:{tae:0,message:"TooManyFolders"},ExceededAttachmentLimit:{tae:0,message:"uploadNumFiles"},ParentalControlsNoAttachments:{tae:0,message:"ypcUploadDisallowed"},GetUserDataFailed:{tae:1,message:"UserDataFetchFailed"},FarmNameNotFound:{tae:1,message:"FarmNameNotFound"},UserOpenFailed:{tae:1,message:"ServerError"},SetUserDataFailed:{tae:1,message:"SetUserDataFailed"},UserDataFetchFailed:{tae:1,message:"UserDataFetchFailed"},MaxAttempts:{tae:12,message:"HumanVerificationFailed"},SendMessageAttachmentFailed:{tae:13,message:"SendAttachmentFailed"},SendMessageFailed:{tae:13,message:"SendMessageFailed"},SendMessageFailedSomeRecipients:{tae:13,message:"SendMessageFailedForSomeRecipients"},ComposeErrorBadMIME:{tae:14,message:"BadMime"},ComposeErrorAttachment:{tae:14,message:"ComposeAttachFailed"},ComposeErrorMessage:{tae:14,message:"ComposeError"},ComposeErrorServiceError:{tae:14,message:"ComposeError"},ComposeErrorUnknown:{tae:14,message:"ComposeError"},ComposeFailed:{tae:14,message:"ComposeFailed"},EmptyFolderFailed:{tae:14,message:"EmptyFolderFailed"},FolderEmptyFailed:{tae:14,message:"EmptyFolderFailed"},FolderCreateFailed:{tae:14,message:"FolderCreateFailed"},FolderFetchFailed:{tae:14,message:"FolderFetchFailed"},FolderIdDoesntExist:{tae:14,message:"FolderIdDoesntExist"},FolderNameIllegalCharset:{tae:14,message:"FolderNameIllegalCharacter"},FolderRemoveFailed:{tae:14,message:"FolderRemoveFailed"},FolderRenameFailed:{tae:14,message:"FolderRenameFailed"},InputTooEarly:{tae:14,message:"HumanVerificationFailed"},InvalidYID:{tae:14,message:"HumanVerificationFailed"},TimedOut:{tae:14,message:"HumanVerificationFailed"},WrongUser:{tae:14,message:"HumanVerificationFailed"},MissingApplicationID:{tae:14,message:"MissingApplicationID"},MissingCredentials:{tae:14,message:"MissingCredentials"},ServerError:{tae:14,message:"ServerError"},FailedDependency:{tae:14,message:"ServerError"},SpamReportingFailed:{tae:14,message:"SpamReportingFailed"},SpamTrainingFailed:{tae:14,message:"SpamTrainingFailed"},TooManyCallsBatched:{tae:14,message:"TooManyCallsBatched"},TooManyMessagesRequested:{tae:14,message:"TooManyMessagesRequested"},ComposeError:{tae:14,message:"ComposeError"},CannotSendThisMessage:{tae:19,message:"CannotSendThisMessage"},UserSuspended:{tae:19,message:"UserSuspended"},UserOverQuota:{tae:19,message:strings.str_cfg_tog_hasUnlimitedStorage?"UserTempSuspended":"UserOverQuota"},TooManyUserRequests:{tae:19},UserAbuseDetected:{tae:1,message:"UserTempSuspended"},SetMetaData:{tae:2,message:"BadRequest"},"ListMessagesFailed.SearchMessages":{tae:2,message:"error_searching_messages"},FolderListFetchFailed:{tae:2,message:"FolderListFetchFailed"},ListMessagesFailed:{tae:2,message:"ListMessagesFailed"},MailboxOpenFailed:{tae:2,message:"MailboxOpenFailed"},MailboxUnreachable:{tae:2,message:"MailboxOpenFailed"},MailboxNotFound:{tae:2,message:"MailboxOpenFailed"},MessageDeleteFailed:{tae:2,message:"MessageDeleteFailed"},MessageSaveFailed:{tae:2,message:"MessageSaveFailed"},MetaDataMissingPath:{tae:2,message:"MetaDataMissingPath"},ResetSpamFilterFailed:{tae:2,message:"ResetSpamFilterFailed"},SaveMessageFailed:{tae:2,message:"SaveMessageFailed"},MetaDataFetchFailed:{tae:2,message:"ServerError"},MetaDataSaveFailed:{tae:2,message:"ServerError"},MetaDataTooLarge:{tae:2,message:"ServerError"},UserPreferenceFetchFailed:{tae:2,message:"UserPreferenceFetchFailed"},SearchProgramFailed:{tae:20,message:"error_searching_messages"},ServiceTemporarilyUnavailable:{tae:21},OperationNotAllowedCurrently:{tae:24,message:"OperationNotAllowedCurrently"},GetMessageInvalidId:{tae:4,message:"GetMessageInvalidId"},GetCidsInvalidMids:{tae:4,message:strings.str_msg_deleted_error,suppressNotification:!0,suppressStat:!0},MessageIdsDeleted:{tae:4,message:strings.str_msg_deleted_error,suppressNotification:!0,suppressStat:!0},MessageNotFoundInNonBulk:{tae:4,message:strings.str_msg_deleted_error,suppressNotification:!0,suppressStat:!0},MessageFetchFailed:{tae:4,message:"MessageFetchFailed"},MessageIdsNotFound:{tae:4,message:"MessageIdsNotFound"},MessageNotFound:{tae:4,message:"MessageNotFound"},ERROR:{tae:4,message:"MessageFetchFailed"},MessageSelectionNotFound:{tae:4,message:"MessageSelectionNotFound"},MoveMessagesInvalidId:{tae:4,message:"MoveMessagesInvalidId"},MalformedConvId:{tae:46,message:"MoveMessagesInvalidId"},ConvIdCouldNotBeFound:{tae:46,message:"MoveMessagesInvalidId"},InvalidConvId
:{tae:46,message:strings.str_msg_deleted_error},"MailboxOpenFailed.Busy":{tae:5,message:"MailboxBusy"},BadCharset:{tae:6,message:"download_message_viewing_error"},GetDisplayMessageFailed:{tae:6,message:"GetDisplayMessageFailed"},GetPartContentFailed:{tae:6,message:"GetDisplayMessageFailed"},GetMessageFailed:{tae:6,message:"GetMessageFailed"},EmptyPostBody:{tae:8,message:"BadRequest"},InvalidRequest:{tae:8,message:"BadRequest"},InputInvalid:{tae:8,message:"ServerError"},"EC-4001":{tae:8,message:"BadRequest",suppressNotification:!0,overrides:{GetDisplayMessage:{suppressStat:!0}}},"EC-4002":{tae:8,message:"BadRequest",suppressNotification:!0},"EC-4004":{tae:8,message:"BadRequest",suppressNotification:!0},"EC-4005":{tae:8,message:"BadRequest",suppressNotification:!0},"EC-4006":{tae:8,message:"BadRequest",suppressNotification:!0},"EC-4007":{tae:8,message:"BadRequest",suppressNotification:!0},"EP-4010":{tae:19,suppressNotification:!0},"EC-4999":{tae:14,message:"ServerError",suppressNotification:!0},"EP-5000":{tae:14,message:"ServerError"},"EP-5001":{tae:8,message:"BadRequest",suppressNotification:!0},"EP-5002":{tae:8,message:"BadRequest",suppressNotification:!0},"ET-5003":{tae:1,message:"UserDataFetchFailed"},"ET-5004":{tae:4,message:"MessageFetchFailed"},"ET-5005":{tae:2,message:"ServerError"},"ET-5006":{tae:14,message:"ServerError"},"EP-5007":{tae:19,message:strings.str_cfg_tog_hasUnlimitedStorage?"UserTempSuspended":"UserOverQuota"},"ET-5008":{tae:2,message:"MailboxOpenFailed"},"ET-5009":{tae:5,message:"MailboxBusy"},"ET-5010":{tae:5,message:"MailboxBusy"},"ET-5011":{tae:2,message:"MailboxOpenFailed"},"ET-5012":{tae:14,message:"ServerError"},"ET-5013":{tae:14,message:"ServerError"},999:{tae:19},429:{tae:19},2:{tae:18,message:"Offline",title:"OfflineTitle"},conn:{tae:18,message:"Connect"},"Malformed-unk":{tae:14},"Malformed-mail":{tae:14},"HTMLResponse-unk":{tae:14},"HTMLResponse-mail":{tae:14},"NoResponse-unk":{tae:14},"NoResponse-mail":{tae:14},"EmptyResponse-mail":{tae:14},"EmptyResponse-unk":{tae:14},MalformedFault:{tae:14},timeout:{tae:18},invalidwssid:{tae:14},loginfail:{tae:14},unknown:{tae:14},timeoutClient:{tae:18},virusDetected:{tae:0,suppressNotification:!0},batchCaptcha:{tae:0,suppressNotification:!0,suppressStat:!0}};e.mix(e.mail.Errormap,{getNfTemplate:function(t){var n=e.ui.Templates._shared_module_offscreen_bin_notification_tae_text,r=e.common.Utils.substitute,i,s;switch(t.length){case 5:s={tae_hd:t[0],tae_bd:t[1],tae_num:t[3],more:r(n.more,{more:t[2]},null,null,null,strings),hidden_text_end:r(n.hidden_text_end,{hidden_text_end:t[4]},null,null,null,strings)};break;case 6:s={tae_hd:t[0],tae_bd:t[1],external_help:r(n.external_help,{url:t[2],external_help:t[3]},null,null,null,strings),tae_num:t[4],url_help_tae19:t[5]};break;case 7:s={tae_hd:t[0],tae_bd:t[1],fix_internet:r(n.fix_internet,{fix_internet:t[2]},null,null,null,strings),hidden_text_mid:r(n.hidden_text_mid,{hidden_text_mid:t[6]},null,null,null,strings),external_help:r(n.external_help,{url:t[3],external_help:t[4]},null,null,null,strings),tae_num:t[5]};break;default:return}return i=r(n.tae_nf_text_generic,s,null,null,null,strings),i},getNotificationText:function(t){var n=e.common.Utils.substitute,r=e.common.Utils.settings,i=r.value("langHelpUrl")?r.value("langHelpUrl"):"help",s=r.value("partnerHelpUrl")?r.value("partnerHelpUrl"):"",o=e.ui.Templates._shared_module_offscreen_bin_notification_tae_text,u={1:"SLN3538",2:"SLN3554",4:"SLN3560",5:"SLN3561",6:"SLN3562",8:"SLN3564",13:"SLN22329",14:"SLN3543",15:"SLN3549",18:"SLN3552",19:"SLN3553",20:"SLN3555",21:"SLN3556",46:"SLN22331"},a="https://"+i+".yahoo.com/kb/"+s+"mail-for-desktop/browser-troubleshooting-steps-sln3223.html",f="http://www.att.com/esupport/article.jsp?sid=KB401516",l="https://"+i+".yahoo.com/kb/"+s+"yahoo-mail-system-requirements-sln3257.html",c="http://www.att.com/esupport/article.jsp?sid=KB401516",h="https://"+i+".yahoo.com/kb/"+s+"web-browsers-cache-cookies-sln4525.html",p="http://www.att.com/esupport/article.jsp?sid=KB401516",d="https://"+i+".yahoo.com/kb/"+s+"SLN3552.html?impressions=true",v="https://"+i+".yahoo.com/kb/"+s+"mail-for-desktop/SLN2080.html?impressions=true",m="https://"+i+".yahoo.com/kb/"+s+"mail-for-desktop/SLN3553.html?impressions=true",g="https://"+i+".yahoo.com/kb/"+s+"mail-for-desktop/search-messages-yahoo-mail-sln16065.html?impressions=true",y={list_start_1:'<ol class="tae-steps-ol">',list_end_1:"</ol>",item_start:"<li>",item_end:"</li>",url_help_browser:s==="sbc"?c:l,url_help_cache:s==="sbc"?p:h},b={list_start_2:'<ul class="tae-steps-ul">',list_end_2:"</ul>",item_start:"<li>",item_end:"</li>"},w={page_id:u[t],lang_help_link:i,partner_id:s},E="http://www.att.com/esupport/article.jsp?sid=KB415047",S={menu_start:"<b>",menu_end:"</b>",gt:">",line_start:'<div class="tae-dialog network-help">',line_end:"</div>"},x={menu_start:"<b>",menu_end:"</b>",list_start:"<ol>",list_end:"</ol>",item_start:"<li>",item_end:"</li>",line_start:"<div>",line_end:"</div>"},T={url_browser_trblshoot:s==="sbc"?f:a},N=strings.str_tae_issuewillresolveitself+"&nbsp"+strings.str_tae_thesestepssolvefaster,C=n(strings.str_tae_fourstepsolution,y,null,null,null,strings),k=n(o.contact_us,w,null,null,null,strings),L=n(o.contact_us_sbc,{url:E},null,null,null,strings),A=N+C+(s==="sbc"?L:k),O=e.UA.userAgent,M,_,D="error";switch(t){case 1:case 2:case 8:case 14:case 15:case 21:_=[strings.str_techglitch,strings.str_tae_waitandreload,strings.str_tae_stillcannotaccess,strings["str_tae"+t],A];break;case 4:_=[strings.str_tae_unabletoloadmsg,strings.str_tae_clickoutoffolder,strings.str_tae_stillcannotviewmessage,strings.str_tae4,A],D="attention";break;case 6:_=[strings.str_tae_unabletoloadmsg,strings.str_tae_waitandreload,strings.str_tae_stillcannotviewmessage,strings.str_tae6,A];break;case 46:_=[strings.str_tae_unabletoloadmsgs,strings.str_tae_tryviewagain,strings.str_tae_stillcannotviewmessage,strings.str_tae46,A],D="attention";break;case 18:O.indexOf("Win")!==-1&&O.indexOf("NT 5.")!==-1?
A=n(strings.str_tae_winxpnetworkresolution,x,null,null,null,null):O.indexOf("Win")!==-1&&O.indexOf("NT 6.0")!==-1?A=n(strings.str_tae_winvistanetworkresolution,S,null,null,null,null):O.indexOf("Win")!==-1?A=n(strings.str_tae_win7networkresolution,S,null,null,null,null):O.indexOf("Mac")!==-1&&(A=n(strings.str_tae_macnetworkresolution,S,null,null,null,null)),D="attention",_=[strings.str_tae_unabletoconnect,strings.str_tae_checkinternetorreload,strings.str_tae_howdoIfixinternet,s==="sbc"?E:d,strings.str_tae_connectedcannotaccess,strings.str_tae18,A];break;case 5:A=n(strings.str_tae_accountaccessedfrommultipleplaces,null,null,null,null,strings)+n(strings.str_tae_accessplaceList,b,null,null,null,null)+strings.str_tae_thesestepssolvefaster+C+k,_=[strings.str_tae_mailtemplocked,strings.str_tae_multiplelocationsLock,strings.str_tae_howdoiunlock,strings.str_tae5,A];break;case 13:A=strings.str_tae_programspreventRTE+n(strings.str_tae_plaintextsteps,y,null,null,null,null)+n(strings.str_tae_continuefollowsteps,T,null,null,null,null)+k,D="attention",_=[strings.str_tae_unabletosendmsg,strings.str_tae_waittrysendagain,strings.str_tae_stillcannotsend,strings.str_tae13,A];break;case 19:_=[strings.str_tae_accounttempLocked,strings.str_tae_templockwaitreloadcontactUs,s==="sbc"?E:v,strings.str_tae_tipsonaccountsecure,strings.str_tae19,s==="sbc"?E:m];break;case 20:_=[strings.str_tae_searchtempunavailable,strings.str_tae_waitandsearchagain,s==="sbc"?E:g,strings.str_tae_learnmoreaboutsearch,strings.str_tae20,""],D="attention";break;default:return}return M=this.getNfTemplate(_),{nfText:M,type:D}},normWSError:function(e){var t=e&&(e.match(/Client\.([\w\W]+)$/)||e.match(/Server\.([\w\W]+)$/));return t&&t[1]||e},normHttpError:function(e){var n,r=new RegExp(t.base+"([\\w\\W]+)$");return(n=e.match(r))&&n[1]||e},getNormalizedErrorCode:function(e){var n=t.isHttp(e);return n?this.normHttpError(e):this.normWSError(e)},getErrorInfo:function(n){var r=n.code,i=this.getNormalizedErrorCode(r),s={},o={},u=n.method,a=this.errorMap[i]||{},f=a.overrides||{},l=e.common.Utils.features,c=l.enabled("TaeNotification");return s=e.merge(a,f[u]),o.tae=typeof s.tae!="undefined"?s.tae:t.isHttp(r)?18:14,o.message=strings["str_error_"+s.message]||n.message||"",s.title=strings["str_error_"+s.title]||n.title||"",o.suppressStat=n.suppressStat||s.suppressStat||!1,o.suppressNotification=n.suppressNotification||s.suppressNotification||!1,c&&(o.nfInfo=this.getNotificationText(o.tae)),o},errorMap:n})},"1.0.0",{requires:["common-utils","mail-common-utils-features","json-stringify","common-net-error","_shared_module_offscreen_bin_notification_tae_text","mail-common-utils-settings"]});
YUI.add("_shared_module_offscreen_bin_modal_launch_error_rollup",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_modal_launch_error_rollup={base:'<p>{{error_message}}</p><ul> <li><a href="{{link_goto_latest}}" class="more">{{str_refresh_page}}</a></li> <li><a href="{{link_goto_tae_help}}" class="more" target="_blank">{{str_rough_visit_help_page}}</a></li> </ul> <br/><span>{{str_rough_errlaunch_troubleshoot}}</span>'};},"1.0.0");YUI.add("mail-error",function(B){var H=B.common.net.Error,M=B.common.Utils,R=B.mail.Errormap,K=B.JSON.stringify,G="45",F=46;B.namespace("mail.Error");function D(V,X){var W=null;if(/SendMessage/.test(X)||/SendMessage/.test(V.postdata)){W=B.clone(V);W.postdata="<filtered>";}else{if(/SaveMessage/.test(X)||/SaveMessage/.test(V.postdata)){W=B.clone(V);W.postdata=W.postdata.replace(/"html":.*","attachment"/g,'"attachment"');}}return W||V;}function Q(W,X){var Z=W.fault&&W.fault.code,V=W.status,Y=[401];function a(b){return(Z.toString().search(b)!==-1)||((V+"")===b);}return H.suppress(X.suppressCodes,Y.concat(X.exceptCodes||[]),a);}function J(V){V.suppressStat=true;V.suppressNotification=true;}function N(Y,W){var b=W.fault,X=b.code,d=W.callback||{},V=d.method,c=this.isErrorSuppressed(W,d),Z=R.getErrorInfo({code:X,method:V,suppressNotification:c||d.suppressNotification,suppressStat:c||d.suppressStat}),f={yid:NeoConfig.loginId||"",tae:Z.tae,method:V,request:this.filterRequest(Y.request,V),response:W.responseText||W.responseTextBatch||"",headers:W.allHeadersText||W.allHeadersTextBatch||"",fault:X,nfInfo:Z.nfInfo||"",message:Z.message||b.message||"",title:Z.title,suppress:c,suppressStat:Z.suppressStat,suppressNotification:Z.suppressNotification,http:[W.status,W.statusText].join(" "),duration:Y.end?(Y.end-Y.start):"X",ua:navigator.userAgent,conv:NeoConfig.hasConvView?1:0,pp:NeoConfig.previewPanePref?1:0,host:NeoConfig.hostName};try{if(!f.response){B.fire("MailLog",{m:"Invalid error detail response",detail:f});return f;}f.response=B.JSON.parse(f.response);}catch(a){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-error:1",a,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-error:1");f.response=f.response;}return f;}function I(b){var Y=B.common.Utils.features,V=Y.enabled("TaeNotification"),W,a,Z,X,c;if(V&&b.nfInfo&&b.nfInfo.nfText){W=b.nfInfo;c="nf-multiline tae-info tae"+b.tae;B.common.ui.NotificationV2.notify(W.nfText,{type:W.type,closeOnExternalClick:true,close:true,customClass:c,speed:"show-medium"});B.fire("util:ymstats",{name:"tae_notifications",tags:{action:"invoked"}});return;}if(strings.str_tog_TAESupported){if(b.tae===G&&strings["str_cfg_url_yahoo_mail_help_tae"+G]){Z=strings["str_cfg_url_yahoo_mail_help_tae"+G];}else{Z=strings.str_cfg_url_TAEHelpPages+"mltamtae"+b.tae+".html";}}else{Z=strings.str_cfg_url_contact_customer_care;}a={error_message:b.message||strings.str_rough_errlaunch_message,link_goto_latest:"launch?reason=ignore&rs=1",launch_error_code:b.tae,link_goto_tae_help:Z};X=M.substitute(B.ui.Templates._shared_module_offscreen_bin_modal_launch_error_rollup.base,a,null,null,strings);H.show(null,X,strings.str_error_MailErrorTitle,{modal_classes:"lg"});}function U(){return(NeoConfig.mailEnv==="prod")?NeoConfig.hostName.split(".")[3]:"";}function O(a){var Z=/"id":"(.*?)",/g,W={},Y=[],V;while((V=Z.exec(a))!==null){W[V[1].replace(/[0-9]|_/g,"")]=1;}for(var X in W){Y.push(X);}return Y;}function S(c,X){var Z,V,a=c.method,Y,W,b={"convpane":"CONVREAD","messagepane":"MESSAGEREAD","search":"SEARCH","convlist":"CONVLIST","messagelist":"MESSAGELIST"};V=B.mail.Tabs.getActiveTab().widgetType;Z=b[V]?b[V]:V;W=this.getColo();if(a==="BatchExecute"&&X.request.postdata){Y=this.extractBatchMethods(X.request.postdata);if(Y.length){a+="_"+Y.join("_");}}if(c.suppressStat){B.fire("util:ymstats",{"name":"client_error","tags":{"api":a,"tae":c.tae,"code":(c.customCode||X.code||c.fault),"farm":NeoConfig.farm.substr(1),"colo":W,"httpStatusCode":X.status}});B.fire("stat:webservice_fail",{"tab":Z,"tae":c.tae,"api":a,"message":(X.code||c.fault),"visible":"no"});}else{B.fire("util:ymstats",{"name":"ue_client_error","tags":{"api":a,"tae":c.tae,"code":(c.customCode||X.code||c.fault),"farm":NeoConfig.farm.substr(1),"colo":W,"httpStatusCode":X.status}});B.fire("stat:webservice_fail",{"tae":c.tae,"tab":Z,"api":a,"message":(X.code||c.fault),"visible":"yes"});}}function E(a,V){var W=(a.suppressStat?"":"UE_")+"DEBUG_TAE:"+(a.tae||"null")+":"+(a.method||"null")+":"+(a.fault||"null")+":"+NeoConfig.farm+" ",Z=new Date().getTime(),X;this.stat(a,V);if(a.tae===0){return;}try{a.tid=Z;if(NeoConfig.sessionTracer){if(a.tae===2||a.tae===4||a.tae===13){B.mail.model.DataStore.Sessions.log(Z);}}if(V.status!==13030&&!/Credentials/.test(a.fault)&&parseInt(NeoConfig.log_error_response,10)!==1){delete a.response;}X={m:W,api:(a.method||"null")+" ",reason:(a.fault||"null")+" ",errinfo:a};if(B.UA.chrome>0){X.online=navigator.onLine;}B.fire("MailLog",X,1,"tae"+a.tae);}catch(Y){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-error:2",Y,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-error:2");}}function A(V,W){return W.indexOf("Client.FailedDependency")!==-1||(V>0&&W==="EC-4001");}function T(V){var W;if(!V){return"UNKNOWN";}if(V.match(/Error getting attachment:/g)){W="ERROR_GETTING_ATTACHMENT";}else{if(V.match(/Failed to fetch message ID:/g)){W="FAILED_TO_FETCH_MESSAGE_ID";}else{if(V.match(/Failed to get msg/g)){W="FAILED_TO_GET_MSG";}else{if(V.match(/Error deleting previous copy of message/g)){W="ERROR_DELETING_PREVIOUS_COPY_OF_MESSAGE";}else{if(V.match(/Error saving message when calling appendMsg/g)){W="ERROR_SAVING_MESSAGE_WHEN_CALLING_APPENDMSG";}else{if(V.match(/Error opening mailbox/g)){W="ERROR_OPENING_MAILBOX";}else{if(V.match(/fetchBody error/g)){W="FETCHBODY_ERROR";}else{if(V.match(/Error fetching message list/g)){W="ERROR_FETCHING_MESSAGE_LIST";}else{if(V.match(/folder id(.*)doesn't exist/g)){W="FOLDER_ID_DOESNOT_EXIST";}else{if(V.match(/Error sending message/g)){W="ERROR_SENDING_MESSAGE";}else{W="UNKNOWN";}}}}}}}}}}return W;}function C(AA,m,o,n){function x(e,AC,i){AA.callDefault(e,AC,i);}o.fault.code+="";M.assert(o.fault);try{var f=o.fault,r=o.status,V=f.code,t=V==="BatchItemError",b,s,z=o.callback||{},W=z.method,p,h,X=/xhrsend/.test(V),j,Y,c,Z,a=o.callback,q=a.retry?"1":"0",l=f&&f.message&&f.message.match("Content-Length:0"),g,w,AB,v,d=z.retryCodes||[],k={"Server.Malformed-mail":true,"Client.EmptyPostBody":true};
if(NeoConfig.hasConvV3&&r===400&&!o.body){o.body=B.JSON.parse(o.responseText);V=o.body.error.code;j=o.body.error.message;}if(k[V]||l||d.indexOf(V)!==-1){if(!a.retry){B.mix(a,{retry:true});Y=o.request;Z=B.common.net.SessionMgr;c=Z.request(Y.url,Z.formatQueryParams(Y.urlparams,Y.enc),a,Y.mthd,Y.enc,null,m.multipart);if(Y.mthd==="POST"){c.request.post=Y.postdata;}c.send();if(V==="Server.Malformed-unk"){B.fire("util:ymstats",{name:"malformed_retry"});}return;}else{if(V==="Server.Malformed-unk"){B.fire("util:ymstats",{name:"malformed_retry_failed"});}}}if(t){for(var u=0;u<f.detail.length;u++){h=f.detail[u];h.code+="";h.allHeadersTextBatch=o.allHeadersText||"";h.responseTextBatch=o.responseText||"";if(!this.isDependencyFailure(u,h.code)){this.handle(AA,m,h,z);}}return;}p=this.getErrorInfo(m,o);g=K(p.response)||"";M.assert(z.service==="mail");if(g&&(p.tae===2||p.tae===13)){if(p.method==="SaveMessage"||p.method==="SendMessage"){p.customCode=this.getSendSaveCustomErrorCode(g);}}if(p.tae===46||p.method==="GetDisplayMessage"){w=m.request.url;AB=p.fault.substr(p.fault.lastIndexOf(".")+1);if(/prime=/.test(w)){if(/prime=0/.test(w)){this.forceSuppressError(p);p.prime="0";}else{if(/prime=1/.test(w)){p.prime="1";}}}if(/InvalidConvId/.test(V)||p.prime==="0"){this.forceSuppressError(p);}}if(r===429){x(429,f.detail&&f.detail.token);}if(r===404){this.forceSuppressError(p);}if(r===307){if(o.responseText){v=JSON.parse(o.responseText).error.code;if(v==="EP-4009"){x(401,{msg:b,url:"https://mail.yahoo.com",stat:V+"_"+W});}}}if(r===500||t||r===400||r===590||f.partialFault){if(/SessionIdReissue/.test(V)||V==="EC-4003"||/Reissuing session ID/.test(j)){x(402);}else{if(/Credentials/.test(V)||V==="EC-4008"||/Credentials/.test(j)){x(401,{stat:V+"_"+W});}else{if(/ClientRedirect/.test(V)||/ClientRedirect/.test(j)){b=M.substitute(strings.str_error_reload_account_migrated,null,null,null,strings);if(/HostCorrection/.test(V)||/HostCorrection/.test(j)){x(401,{msg:b,url:"https://mail.yahoo.com",stat:V+"_"+W});}else{x(310,{msg:b,stat:V+"_"+W});}}else{if(/999/.test(V)||/999/.test(j)){x(999,f.detail&&f.detail.token);}else{if((/ServiceTemporarilyUnavailable/.test(V)||/ServiceTemporarilyUnavailable/.test(j))&&f.detail&&f.detail.displayUrl){window.location=f.detail.displayUrl;return;}if(!p.suppressNotification&&!(n&&n.suppressNotification)&&!f.partialFault){if(!z||!z.taeUiCbk||!z.taeUiCbk(p)){this.showTae(p);}}}}}}}else{if(V.indexOf("-unk")>-1){s={};s.message=strings.str_error_Unk;s.title=strings.str_error_Unk_title;x(null,s,X);}else{if(!p.suppress){s={};s.message=p.message;s.title=p.title;x(null,s,X);}}}if(p.tae===46){p.convOrigin=z.convOrigin;if(z.openedFrom){p.openedFrom=z.openedFrom;}}if(!AA.retry){this.log(p,o);}}catch(y){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-error:3",y,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-error:3");M.assert(0,"mail:controller:error - "+y.message);}if(!AA.isdone()){AA.done();}}function L(W){var X={},V;for(V in W){if(W.hasOwnProperty(V)){X[V]=B.Escape.html(W[V]);}}return X;}function P(Y){var W,X="",V="";M.netError("FetchExternalAccount Error"+K(Y));for(W=0;W<Y.length;W++){V=Y[W].status;X=strings["str_error_extFetch_"+Y[W].status];if(!X){X=strings.str_error_extFetch_unknownError;}X=M.substitute(X,L(Y[W]));X+="<br/><br/>";}H.showConfirm(function(){B.fire("openOptions",B.mix(this,{params:{section:"accounts"}}));},0,X);}B.mix(B.mail.Error,{handle:C,extFetchError:P,extractBatchMethods:O,stat:S,log:E,showTae:I,getColo:U,isDependencyFailure:A,getSendSaveCustomErrorCode:T,isErrorSuppressed:Q,getErrorInfo:N,filterRequest:D,forceSuppressError:J});B.fire("mailerrormodule:loaded");},"1.0.0",{requires:["common-net-error","mail-common-utils-features","mail-errormap","ymma-stats","json-stringify","escape","_shared_module_offscreen_bin_modal_launch_error_rollup","common-ui-notification-v2"]});YUI.add("mail-ui-log",function(F){var B=15*1000,G=F.common.Utils,T=G.ymmastats,L=200,P=1000;function J(Y){Y=Y||{};this._sessionLogger=F.comms.log4js.getLogger("_sessionLogger",1,"ajax",{jsonReq:true});this._logger=[];this._logTimer={};this.FLUSH_LIMIT=Y.FLUSH_LIMIT||L;this.LOG_LIMIT=Y.LOG_LIMIT||P;this.events=Y.events||{},this.tid=NeoConfig.loginId+G.rand(1000000);this._lastFlushed=0;this._index=0;}function D(){var Y=this;F.each(Y.events,function(b,c){F.on(c,function(){try{b.apply(Y,arguments);}catch(d){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-mail-debug-maillog:1",d,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-debug-maillog:1");Y.add({m:"Logger Exception"},1,"JSException");}});});}function N(Y){var b=new Date();if(this._logger.length===this.LOG_LIMIT){this._logger.shift();this._lastFlushed=this._lastFlushed-1>0?this._lastFlushed-1:0;}this._logger.push(F.JSON.stringify({t:b.toTimeString().substr(0,8)+":"+b.getMilliseconds(),d:Y}));}function O(Y,b){var c=this;c._logTimer[Y.key]&&c._logTimer[Y.key].cancel();c._logTimer[Y.key]=F.later(Y.time||B,Y.context,function(){var d=false;if(Y.onTimeout){d=!Y.onTimeout.apply(Y.context||null);}if(!d){c.add(Y.data);T.stat("TimeoutError","reason=>"+Y.key.split(":")[0]);c.flush(Y.key);}b&&b.detach();});}function a(){this._logger=[];this._lastFlushed=0;this._index=0;}function A(){var Y=window.open("","","width=650,height=700,resizable"),b=Y.document;b.open();b.write("<html>"+"<body>"+'<div id = "reason"></div>'+'<div id = "extraInfo"></div>'+'<div id = "logs"></div>'+"</body>"+"</html>");return Y;}function V(){var Y=window.open("","","width=650,height=700,resizable"),b=Y.document;b.open();b.write("<html>"+"<body>"+'<textarea id = "hardetails" rows="50" cols="80"></textarea>'+"</body>"+"</html>");return Y;}function M(){var Y=window.open("","","width=1000,height=700,resizable"),b=Y.document;b.open();b.write("<html><head>"+"<script>"+"function createWF(res) {"+'var _yr= "https://s.yimg.com/zz/combo?os/mit/media/p/content/'+NeoConfig.yaft_report_js_version+'",_yrs = document.createElement("script");'+'_yrs.src = _yr; _yrs.type ="text/javascript";'+"_yrs.onload = function(){ YAFT_REPORT.drawWaterfall(res); };"+"document.body.appendChild(_yrs);"+"}"+"<\/script>"+"</head><body></body></html>");return Y;}function I(){var b=this._prepareLog("Console Print"),f,c="getElementById",e,Y="";if(!(this.logW&&this.logW.opener&&!this.logW.opener.closed)){this.logW=this._createUI();}f=this.logW.document;f[c]("reason").innerHTML=b.reason;f[c]("extraInfo").innerHTML=F.JSON.stringify(b.info);for(e=0;e<b.logs.length;e++){Y+="<div>"+b.logs[e]+"</div>";}f[c]("logs").innerHTML=Y;}function X(){var b=this,Y={tid:b.tid,yid:NeoConfig.loginId,browser:NeoConfig.browser,build:NeoConfig.buildNumber,url:location.toString(),hasConv:NeoConfig.hasConvView,mailplus:!NeoConfig.hasAds?"1":"0",bucket:NeoConfig.expBucketId};return Y;}function R(Y){if(NeoConfig.log_error_yapache){var b=this;Y=Y||"MailLog";b._sessionLogger.log(F.JSON.stringify(b._prepareLog(Y,b.FLUSH_LIMIT)));b._lastFlushed=b._logger.length;}}function C(Y){var c=this;var b=F.on(Y.event,function(){if(Y.condition.apply(Y.context||null,arguments)){c._logTimer[Y.key]&&c._logTimer[Y.key].cancel();b.detach();}});c._addTimer(Y,b);}function E(f,b){var h=this,d,c=[],e,g,Y=h._logger.length;if(!b){g=0;}else{if(Y-h._lastFlushed<b){g=h._lastFlushed;}else{g=Y-b;}if(g<0){g=0;}}for(d=g;d<Y;d++){c.push(this._logger[d]);}e={reason:f,info:this._getExtraLogInfo(),logs:c,index:h._index};h._index=h._index+c.length;return e;}function S(){if(!(this.waterFallW&&this.waterFallW.opener&&!this.waterFallW.opener.closed)){this.waterFallW=M();}this.waterFallW.createWF(YAFT.data);}function H(){if(!(this.harW&&this.harW.opener&&!this.harW.opener.closed)){this.harW=V();}this.harW.document.getElementById("hardetails").value=F.JSON.stringify(YAFT.data.har);}function Z(){var Y=NeoConfig.launchPVID.replace(/[^a-zA-Z]/g,""),d=Y.length,c,b="";for(c=8;c<d;c++){if(c%2==0){b+=Y.charAt(c);}}return b;}function Q(Y){YAFT.init({modules:["shellnavigation-inner","storm-listnav","shellcontent","nav","yucs-top-bar","yucsHead","slot_"],modulesExclude:["yucs-",(NeoConfig.ccAb&&Z())||"slot_MB"],canShowVisualReport:0,generateHAR:true,maxWaitTime:200},function(c,b){if(!b){YAFT.data=c;Y();}});}function K(c){if(window.YAFT!==undefined&&window.YAFT_REPORT!==undefined&&window.YAFT.data!==undefined){c();}else{var b="https://s.yimg.com/zz/combo?os/mit/media/p/content/"+NeoConfig.yaft_js_version+"&os/mit/media/p/content/"+NeoConfig.yaft_report_js_version,Y=document.createElement("script");Y.src=b;Y.type="text/javascript";Y.onload=function(){Q(c);};document.body.appendChild(Y);}}function W(){K(S);}function U(){K(H);}F.mix(J.prototype,{flush:R,print:I,printWaterfall:W,printHAR:U,bindEvents:D,add:N,addFlow:C,reset:a,_createUI:A,_addTimer:O,_getExtraLogInfo:X,_prepareLog:E});F.namespace("mail.ui").MailLog=J;},"1.0.0",{requires:["ymma-stats","comms-log4js","common-utils"]});YUI.add("mail-ui-log-events",function(C){var M=C.mail.ui.MailLog;function V(b,Y,a){this.add(b);if(Y&&a){this.flush(a);}}function S(){this.print();}function B(Y){Y&&Y(this._prepareLog());}function W(b,Y,a){this.reset();V.call(this,b,Y,a);}function L(b,Y){var a=[];C.each(Y,function(c){a.push(c.mid);});this.add({m:"Load Message Cards Start",cid:b.cid,fid:b.fid,mids:a.join(", ")});}function H(a){var b=this,Y;if(!a){return;}Y={m:"Mail open",fid:a.fid,subject:a.message.subject};if(a.message.cid){Y.cid=a.message.cid;}else{Y.mid=a.message.mid;}b.add(Y);if(NeoConfig.hasConv&&a.message.cid!==""){b.addFlow({event:"MessagePane:rendered",key:"mailOpenFail:"+Y.cid,condition:function(c,d){b.add({m:"MessagePane rendered",fid:d.fid,subject:d.subject,cid:d.cid});return d.cid===Y.cid;},data:{m:"TimeoutError: Mail open failed for "+Y.cid+":"+Y.subject}});}}function O(a){var b=this,Y=a.mid;b.add({m:"Expand Click Start",mid:a.mid});b.addFlow({event:"MessagePane:messageExpandDone",key:"msgExpandFail"+Y,time:5000,condition:function(c){return Y===c.mid;},data:{m:"TimeoutError: Expand message failed"}});}function Q(a){var Y=[];C.each(a,function(b){Y.push(b.mid);});this.add({m:"Load Message Success Start",mids:Y.join(", ")});}function G(a){var Y=[];C.each(a,function(b){Y.push(b.mid);});this.add({m:"Message Controller getMultipleMessages",mids:Y.join(", ")});}function I(a){var Y=[];C.each(a,function(b){Y.push(b.mid);});this.add({m:"Message Controller getMultipleMessagesSuccess",mids:Y.join(", ")});}function K(a,Y){this.add({m:"Set pending request variable",pending:a,reason:Y});if(a===1){this.addFlow({event:"BaseController:pending",key:"pendingReq",time:31*1000,condition:function(b){return b?false:true;},data:{m:"TimeoutError: Pending is still set to 1 after 31 seconds"}});}}function N(c,d,b){var e=[],Y=[],a;for(a=0;a<c.length;a++){e.push(c[a].method);}if(d){for(a=0;a<b.length;a++){if(b[a].method){Y.push(b[a].method);}}this.add({m:"Not executing batch request",methods:e.join(", "),waitingMethods:Y});}else{this.add({m:"Executing batch request",methods:e.join(", ")});}}function Z(Y,d){var c=this,b=Y.cid,a;if(Y.totalUnread!==d.totalUnread&&(Y.totalUnread===0||d.totalUnread===0)){if(Y.totalUnread===0){c.add({m:"Conversation changing state from read to unread in ConvStore",cid:b});a=false;}else{if(d.totalUnread===0){c.add({m:"Conversation changing state from unread to read in ConvStore",cid:b});a=true;}}c.addFlow({event:"MessagePane:markConvRead",key:"markConvReadInPane:"+b,condition:function(f,e){c.add({m:"Conversation getting marked as "+(e?"Read":"Unread")+" in the ConvPane UI",cid:f.cid});return f.cid===b&&e===a;},onTimeout:function(){var e=C.mail.model.ConvStore.Conversations.getPermCidPart,h=e(b),f,i,g=C.mail.Tabs.iterateTabs(function(j){if(j.widgetType==="convlist"||j.widgetType==="convpane"){if(j.widget&&j.widget.msgPane&&j.widget.msgPane.message){f=j.widget.msgPane.message.cid;i=e(f);if(b===f||b===i||h===f||h===i){return true;}}}});return g?true:false;},time:1000,data:{m:"TimeoutError: Conversation couldn't get marked as "+(a?"Read":"Unread")+" in the ConvPane UI",cid:b}});c.addFlow({event:"listview:itemUpdate",key:"markConvReadInList:"+b,condition:function(f,e){var g=f.one(".list-view-item").hasClass("unread")?false:true;c.add({m:"Conversation getting marked as "+(g?"read":"unread")+" in ConvList UI",cid:b});return e.cid===b&&g===a;},time:1000,data:{m:"TimeoutError: Conversation couldn't get marked as "+(a?"Read":"Unread")+" in the ConvList UI",cid:b}});}}function A(c,d,Y){if(Y.indexOf("appid=YahooMailNeo")>-1&&Y.indexOf("SetMetaData")===-1){var a=c.request.postdata,b;if(Y.indexOf("SendMessage")>-1||Y.indexOf("SaveMessage")>-1||Y.indexOf("BatchExecute")>-1&&a.indexOf("SaveMessage")>-1||Y.indexOf("BatchExecute")>-1&&a.indexOf("SendMessage")>-1){a=a.replace(/"message":{.*}/,'"message":{<filtered>},');}b={m:"Request Sent",url:Y,post:a};if(C.UA.chrome>0){b.online=navigator.onLine;}this.add(b);}}function U(d,b){var c=this,Y,a;a=F(d);Y={m:"Initiating delete action",fid:b};Y[NeoConfig.hasConv?"cids":"mids"]=a.join(", ");this.add(Y);if(NeoConfig.hasConv){c.addFlow({event:"convops:movecbk",key:"removeMailFail:"+a[0],condition:function(e){a=a.sort();e=e.sort();return(a.join(",")===e.join(","));},time:30000,data:{m:"TimeoutError: Mail couldn't be deleted",ids:a.join(", ")}});}}function E(c,a){var Y,b=[];C.each(a,function(d){b.push(P(c[d]));});Y={m:"Removing mails from listmodel"};Y[NeoConfig.hasConv?"cids":"mids"]=b.join(", ");this.add(Y);}function R(Y){this.add({m:"Finished syncing listview",syncReason:Y});}function T(b,a){var c=P(a),Y;Y={m:"Updating single item in the list",subject:a.subject};Y[NeoConfig.hasConv?"cid":"mid"]=c;this.add(Y);}function F(a){var Y=[];C.each(a,function(b){Y.push(P(b));});return Y;}function P(Y){return NeoConfig.hasConv?Y.cid:Y.mid;}function J(){this.printWaterfall();}function D(){this.printHAR();}var X=new M({events:{"MailLog":V,"MailLogClean":W,"printLog":S,"extractLogs":B,"printWaterfall":J,"printHAR":D,"MessagePane:inception":H,"MessagePane:expandClick":O,"MessagePane:loadMessageCardsStart":L,"MessagePane:loadMessageSuccessStart":Q,"MessageController:getMultipleMessages":G,"MessageController:getMultipleMessagesSuccess":I,"BaseController:pending":K,"BaseController:execute":N,"ConvStore:calcConvSummary":Z,"net:start":A,"mailEvents:removeMails":U,"listmodel:remove":E,"listview:sync":R,"listview:itemUpdate":T}});X.bindEvents();},"1.0.0",{requires:["mail-ui-log"]});/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("jsonp",function(e,t){function r(){this._init.apply(this,arguments)}var n=e.Lang.isFunction;r.prototype={_init:function(t,r){this.url=t,this._requests={},this._timeouts={},r=n(r)?{on:{success:r}}:r||{};var i=r.on||{};i.success||(i.success=this._defaultCallback(t,r)),this._config=e.merge({context:this,args:[],format:this._format,allowCache:!1},r,{on:i})},_defaultCallback:function(){},send:function(){function u(e,r){return n(e)?function(n){var o=!0,u="_requests";r?(++t._timeouts[s],--t._requests[s]):(t._requests[s]||(o=!1,u="_timeouts"),--t[u][s]),!t._requests[s]&&!t._timeouts[s]&&delete YUI.Env.JSONP[s],o&&e.apply(i.context,[n].concat(i.args))}:null}var t=this,r=e.Array(arguments,0,!0),i=t._config,s=t._proxy||e.guid(),o;return i.allowCache&&(t._proxy=s),t._requests[s]===undefined&&(t._requests[s]=0),t._timeouts[s]===undefined&&(t._timeouts[s]=0),t._requests[s]++,r.unshift(t.url,"YUI.Env.JSONP."+s),o=i.format.apply(t,r),i.on.success?(YUI.Env.JSONP[s]=u(i.on.success),e.Get.js(o,{onFailure:u(i.on.failure),onTimeout:u(i.on.timeout,!0),timeout:i.timeout,charset:i.charset,attributes:i.attributes,async:i.async}).execute(),t):t},_format:function(e,t){return e.replace(/\{callback\}/,t)}},e.JSONPRequest=r,e.jsonp=function(t,n){var r=new e.JSONPRequest(t,n);return r.send.apply(r,e.Array(arguments,2,!0))},YUI.Env.JSONP||(YUI.Env.JSONP={})},"3.16.0",{requires:["get","oop"]});
/*
YUI 3.16.0 (build 3.16.0-ym15)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("jsonp-url",function(e,t){var n=e.JSONPRequest,r=e.Object.getValue,i=function(){};e.mix(n.prototype,{_pattern:/\bcallback=(.*?)(?=&|$)/i,_template:"callback={callback}",_defaultCallback:function(t){var n=t.match(this._pattern),s=[],o=0,u,a,f;if(n){u=n[1].replace(/\[(['"])(.*?)\1\]/g,function(e,t,n){return s[o]=n,".@"+o++}).replace(/\[(\d+)\]/g,function(e,t){return s[o]=parseInt(t,10)|0,".@"+o++}).replace(/^\./,"");if(!/[^\w\.\$@]/.test(u)){a=u.split(".");for(o=a.length-1;o>=0;--o)a[o].charAt(0)==="@"&&(a[o]=s[parseInt(a[o].substr(1),10)]);f=r(e.config.win,a)||r(e,a)||r(e,a.slice(1))}}return f||i},_format:function(e,t){var n=/\{callback\}/,r,i;return n.test(e)?e.replace(n,t):(r=this._template.replace(n,t),this._pattern.test(e)?e.replace(this._pattern,r):(i=e.slice(-1),i!=="&"&&i!=="?"&&(e+=e.indexOf("?")>-1?"&":"?"),e+r))}},!0)},"3.16.0",{requires:["jsonp"]});
YUI.add("comet",function(D){D.namespace("Comet");function B(E){B.superclass.constructor.apply(this,arguments);}var C={};var A="comet:ready";D.initComet=function(G,F){var E=G.replace(/https:/,"http:");if(E.substr(-1)==="/"){E=E.substring(0,E.length-1);}if(!C[E]){D.publish(A);C[E]=new B();C[E].clearListeners();}if(F){C[E].addListener("/meta/handshake",F);}C[E].initBayeux(G,function(H){if(H.successful){D.fire(A,{message:H});}});return C[E];};B.NAME="Comet";B.ATTRS={uri:{value:null,setter:function(G){if(G===null){return;}var E=window.location.protocol;if(E.indexOf("https")!==-1){G=G.replace(/http:/,"https:");}else{if(E.indexOf("http")!==-1){G=G.replace(/https:/,"http:");}}var F=G.toLowerCase();if(F.indexOf("https://")!==-1){this.set("protocol","https://");}else{if(F.indexOf("http://")!==-1){this.set("protocol","http://");}}return G;}},protocol:{value:"https://"},meta:{value:{handshake:{channel:"/meta/handshake",version:"1.0",supportedConnectionTypes:["long-polling"]},connect:{channel:"/meta/connect",connectionType:"long-polling"},subscribe:{channel:"/meta/subscribe"},unsubscribe:{channel:"/meta/unsubscribe"},publish:{},disconnect:{channel:"/meta/disconnect"},ack:{channel:"/meta/ack"}}},ioCfg:{value:{method:"POST",headers:{"Content-Type":"application/json","Accept":"*/*"}}},ext:{value:{all:{},handshake:{},subscribe:{"Comet-api-version":"1.1","Comet-subscriber-auth-info":null},unsubscribe:{"Comet-api-version":"1.1","Comet-subscriber-auth-info":null},connect:{},publish:{"Comet-api-version":"1.1","Comet-registration-id":"make-up","Comet-opaque-id":"markup","Comet-acknowledge-URI":"www.yahoo.com/ack","Comet-acknowledge-type":"All"},disconnect:{}}}};D.extend(B,D.Base,{_clientState:"unconnected",_advice:{},_connected:false,_config:{backoffIncrement:1000,maxBackoff:10000,maxNetworkDelay:300000,delayedSendMaxCount:10,advice:{timeout:60000,interval:0,reconnect:"retry"},subscribe:{jsonpTimeout:5000}},_delayedSendCount:0,_urlOrigin:"",_backoff:0,_isLongpollingConnect:false,_isSendingQueue:false,_isShutdown:false,_clientId:null,_token:null,_lastMessageId:0,_outgoing:[],_subscribeChannel:{},_queue:new D.AsyncQueue(),_ioQueue_c2s:D.io.queue,_ioQueue_s2c:D.io.queue,_jsonp:null,_listeners:{},initializer:function(E){this.setClientState("unconnected");D.on("beforeunload",D.bind(function(){if(this.getClientState()!=="unconnected"){this.disconnect();}},this),window);},config:function(E,F){D.Object.setValue(this._config,E,F);},_Queue_send:function(F){var E=this;E._batch(F);if(!E.getClientId()){return;}if(E._isSendingQueue){return;}if(E._outgoing.length<=0){return;}D.each(E._outgoing,function(G){G=E._patchMessage(G);});E._IO_send(true,E._outgoing);E._outgoing=[];},_nextQueueSend:function(){this._Queue_send();},_IO_send:function(G,F){var E=this;if(!E.get("uri")){return;}if(G){if(E._isSendingQueue||!F){return;}E._IO_Queue_Send(F);}else{if(!E.getClientId()){return;}if(E._isLongpollingConnect||!F){return;}E._IO_Longpolling_Send(F);}},_IO_Queue_Send:function(F){var E=this;E.setTokenHeader(E._token);var G=D.merge(E.get("ioCfg"),{context:E,timeout:E._config.maxNetworkDelay,data:D.JSON.stringify(F),xdr:{credentials:true},on:{success:function(H,K){try{var I=D.JSON.parse(K.responseText);E._handleResponse(I);}catch(J){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-cometd-yui3:1",J,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-cometd-yui3:1");E._handleFailure(F,"json parse error");return;}},failure:function(H,I){E._handleFailure(F,"500::io failed");},start:function(){E._isSendingQueue=true;},complete:function(){E._isSendingQueue=false;E._nextQueueSend();}}});if(E._isShutdown){return;}E._ioQueue_c2s.stop();E._ioQueue_c2s(E.get("uri"),G);E._ioQueue_c2s.start();},_IO_Jsonp_Send:function(F){var E=this;if(!E.get("uri")){return;}var H=E.get("uri")+"?callback={callback}";var G=encodeURIComponent(D.JSON.stringify(F));H=H+"&data="+G;E._jsonp=new D.JSONPRequest(H,{on:{success:function(I){E._handleResponse(I);},timeout:function(I){E._handleFailure(F,"408:"+E._config.subscribe.jsonpTimeout+":jsonp timeout");},failure:function(){E._handleFailure(F,"500::jsonp failed");}},timeout:E._config.subscribe.jsonpTimeout});E._jsonp.send();},_IO_Longpolling_Send:function(F){var E=this;E.setTokenHeader(E._token);var G=D.merge(E.get("ioCfg"),{context:E,timeout:E._config.maxNetworkDelay,xdr:{credentials:true},data:D.JSON.stringify(F),on:{success:function(H,K){try{var I=D.JSON.parse(K.responseText);E._handleResponse(I);}catch(J){typeof globals!=="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-cometd-yui3:2",J,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-cometd-yui3:2");E._handleFailure(F,"json parse error");return;}},failure:function(H,I){E._handleFailure(F,"500::io failed");},start:function(){E._isLongpollingConnect=true;},complete:function(){E._isLongpollingConnect=false;}}});if(E._isShutdown){return;}E._ioQueue_s2c.stop();E._ioQueue_s2c(E.get("uri"),G);E._ioQueue_s2c.start();},_handleResponse:function(E){if(E===undefined||E===null){return;}var F=this;D.each(E,function(H){F._updateAdvice(H.advice);H.originalURI=F._urlOrigin;var G=H.channel;switch(G){case"/meta/handshake":F._handshakeResponse(H);break;case"/meta/connect":F._connectResponse(H);break;case"/meta/disconnect":F._disconnectResponse(H);break;case"/meta/subscribe":F._subscribeResponse(H);break;case"/meta/shutdown":F._shutdownResponse(H);break;case"/meta/unsubscribe":F._unsubscribeResponse(H);break;default:F._messageResponse(H);break;}});},_updateAdvice:function(E){if(E){this._advice=this._mixin(false,{},this._config.advice,E);}else{this._advice=this._config.advice;}},_handshakeResponse:function(F){var E=this;if(F.successful){E.setClientState("connected");E._clientId=F.clientId;if(E._advice.VIP){E.set("uri",E.get("protocol")+E._advice.VIP+"/comet");}E._notifyListeners("/meta/handshake",F);E._Queue_send();var G=E._isDisconnected()?"none":E._advice.reconnect;
switch(G){case"retry":E._resetBackoff();E._delayedConnect();break;case"handshake":E.setClientState("unconnected");E._resetBackoff();E._delayedHandshake();break;case"none":E._disconnect(false);break;}}else{E._failHandshake(F);}},_failHandshake:function(G){var F=this;F.setClientState("unconnected");F._clientId=null;F._notifyListeners("/meta/handshake",G);F._notifyListeners("/meta/unsuccessful",G);var E=(F._advice.reconnect!=="none");if(E){F._increaseBackoff();F._delayedHandshake();}else{F._disconnect(false);}},_delayedHandshake:function(){var E=this;this._delayedSend(function(){E._handshake();});},_subscribeResponse:function(E){if(E.successful){if(this._subscribeChannel[E.subscription]&&this._subscribeChannel[E.subscription]===true){}else{this._subscribeChannel[E.subscription]=true;}if(E["ext"]["Comet-auth-token"]){this._token=E["ext"]["Comet-auth-token"];}this._notifyListeners("/meta/subscribe",E);}else{this._failSubscribe(E);}},_failSubscribe:function(E){this._notifyListeners("/meta/subscribe",E);this._notifyListeners("/meta/unsuccessful",E);},_connectResponse:function(F){var E=this;if(E._isDisconnected()){return;}E._connected=F.successful;if(E._connected){E.setClientState("connected");E._notifyListeners("/meta/connect",F);var G=E._isDisconnected()?"none":E._advice.reconnect;switch(G){case"retry":E._resetBackoff();E._delayedConnect();break;case"handshake":E.setClientState("unconnected");E._resetBackoff();E._delayedHandshake();break;case"none":E._disconnect(false);break;}}else{E._failConnect(F);}},_failConnect:function(F){var E=this;E._notifyListeners("/meta/connect",F);E._notifyListeners("/meta/unsuccessful",F);var G=E._isDisconnected()?"none":E._advice.reconnect;switch(G){case"retry":E._delayedConnect();E._increaseBackoff();break;case"subscribe":E._delayedConnect();E._increaseBackoff();break;case"handshake":E.setClientState("unconnected");E._resetBackoff();E._delayedHandshake();break;case"none":E._disconnect(false);break;}},_delayedConnect:function(){var E=this;this._delayedSend(function(){E._connect();});},_disconnectResponse:function(E){if(E.successful){this._disconnect(false);this._notifyListeners("/meta/disconnect",E);}else{this._failDisconnect(E);}},_shutdownResponse:function(E){this._disconnect(true);this._isShutdown=true;this._notifyListeners("/meta/shutdown",E);},_failDisconnect:function(E){this._disconnect(true);this._notifyListeners("/meta/disconnect",E);this._notifyListeners("/meta/unsuccessful",E);},_unsubscribeResponse:function(E){if(E.successful){if(this._subscribeChannel[E.subscription]&&this._subscribeChannel[E.subscription]===true){delete this._subscribeChannel[E.subscription];}this._notifyListeners("/meta/unsubscribe",E);}else{this._failUnsubscribe(E);}},_failUnsubscribe:function(E){this._notifyListeners("/meta/unsubscribe",E);this._notifyListeners("/meta/unsuccessful",E);},_messageResponse:function(E){if(E.successful===undefined){if(E.data){this._notifyListeners(E.channel,E);if(E.id){this._ackMessage({msgId:E.id,msgChannel:E.channel});}}else{this._notifyListeners("/meta/unsuccessful",E);}}else{if(E.successful){this._notifyListeners("/meta/publish",E);}else{this._failMessage(E);}}},_ackMessage:function(E){var F=this._createMessage("ack",E);this._Queue_send(F);},_failMessage:function(E){this._notifyListeners("/meta/publish",E);this._notifyListeners("/meta/unsuccessful",E);},_delayedSend:function(E){var H=this;var F=H._advice.interval+H._backoff;if(H._config.maxBackoff<=H._backoff){H._delayedSendCount++;}else{H._delayedSendCount=0;}if(H._delayedSendCount>H._config.delayedSendMaxCount){var G=H.get("uri");H.set("uri",H._urlOrigin);if(G===H.get("uri")){return;}H._resetBackoff();H._delayedSendCount=0;}H._queue.add({fn:E,timeout:F});H._queue.run();},_handshakeFailure:function(F,E){this._failHandshake({successful:false,failure:true,channel:"/meta/handshake",request:F,advice:{reconnect:"retry",interval:this._backoff},error:E||"",ext:F.ext||{},id:F.id||""});},_connectFailure:function(F,E){this._connected=false;this._failConnect({successful:false,failure:true,channel:"/meta/connect",request:F,advice:{reconnect:"retry",interval:this._backoff},clientId:F.clientId||"",error:E||"",ext:F.ext||{},id:F.id||""});},_disconnectFailure:function(F,E){this._failDisconnect({successful:false,failure:true,channel:"/meta/disconnect",request:F,advice:{reconnect:"none",interval:0},clientId:F.clientId||"",error:E||"",ext:F.ext||{},id:F.id||""});},_subscribeFailure:function(F,E){this._failSubscribe({successful:false,failure:true,channel:"/meta/subscribe",request:F,advice:{reconnect:"none",interval:0},clientId:F.clientId||"",subscription:F.subscription||"",error:E||"",ext:F.ext||{},id:F.id||""});},_unsubscribeFailure:function(F,E){this._failUnsubscribe({successful:false,failure:true,channel:"/meta/unsubscribe",request:F,advice:{reconnect:"none",interval:0},clientId:F.clientId||"",subscription:F.subscription||"",error:E||"",ext:F.ext||{},id:F.id||""});},_messageFailure:function(F,E){this._failMessage({successful:false,failure:true,channel:F.channel,request:F,advice:{reconnect:"none",interval:0},clientId:F.clientId||"",subscription:F.subscription||"",error:E||"",ext:F.ext||{},id:F.id||""});},_handleFailure:function(I,E){var H,G,F;for(F=0;F<I.length;++F){H=I[F];G=H.channel;switch(G){case"/meta/handshake":this._handshakeFailure(H,E);break;case"/meta/connect":this._connectFailure(H,E);break;case"/meta/disconnect":this._disconnectFailure(H,E);break;case"/meta/subscribe":this._subscribeFailure(H,E);break;case"/meta/unsubscribe":this._unsubscribeFailure(H,E);break;default:this._messageFailure(H,E);break;}}},_notifyListeners:function(I,H){this._notify(I,H);var J=I.split("/");var G=J.length-1,F=0;for(F=G;F>0;--F){var E=J.slice(0,F).join("/")+"/*";if(E!==I){this._notify(E,H);}}},_notify:function(G,F){var E=this._listeners[G];if(E){D.each(E,function(H){if(D.Lang.isFunction(H.listener)){H.listener(F);}});}},_isDisconnected:function(){return this._clientState==="unconnected";},_resetBackoff:function(){this._backoff=0;
},_nextMessageId:function(){return ++this._lastMessageId+"";},_increaseBackoff:function(){if(this._backoff<this._config.maxBackoff){this._backoff+=this._config.backoffIncrement;}},_createMessage:function(G,F){F=F||{};var J=(new Date()).valueOf();var I=window.location.host;var E=[];var H=D.merge(this.get("ext").all,this.get("ext")[G],F.ext||{},{"timestamp":J,"host":I||""});switch(G){case"handshake":E.push(D.merge({id:this._nextMessageId(),ext:H},this.get("meta")[G]));break;case"connect":E.push(D.merge({id:this._nextMessageId(),ext:H},this.get("meta")[G],{clientId:this.getClientId()}));break;case"subscribe":E.push(D.merge({id:this._nextMessageId(),ext:H},this.get("meta")[G],{clientId:this.getClientId(),subscription:F.channel}));break;case"unsubscribe":E.push(D.merge({id:this._nextMessageId(),ext:H},this.get("meta")[G],{clientId:this.getClientId(),subscription:F.channel}));break;case"publish":E.push(D.merge({id:this._nextMessageId(),ext:H},this.get("meta")[G],{clientId:this.getClientId(),channel:F.channel,data:F.data}));break;case"disconnect":E.push(D.merge({id:this._nextMessageId(),ext:H},this.get("meta")[G],{clientId:this.getClientId()}));break;case"ack":E.push(D.merge({id:this._nextMessageId(),ext:H,msgId:F.msgId,msgChannel:F.msgChannel},this.get("meta")[G],{clientId:this.getClientId()}));break;}return E;},_handshake:function(E){var H=this;if(H.getClientState()!=="unconnected"){if(H.getClientState()==="connected"){var G={successful:true,channel:"/meta/handshake",clientId:H._clientId,originalURI:H._urlOrigin};H._notifyListeners("/meta/handshake",G);}return;}if(E&&E.listener){H._addListener(E,false);}H._clientId=null;H._token=null;H.resetTokenHeader();H._clearSubscriptions();H._updateAdvice(H._config.advice);var F=H._createMessage("handshake",E);H._IO_send(true,F);H.setClientState("connecting");},_connect:function(E){var G=this;if(G.getClientState()!=="connected"){return;}if(G._isLongpollingConnect){return;}var F=G._createMessage("connect",E);G._IO_send(false,F);},_subscribeJSONP:function(E){if(!(E&&E.channel)){return;}if(!this.getClientId()){return;}if(this._subscribeChannel[E.channel]&&this._subscribeChannel[E.channel]===true){return;}if(E.listener){this._addListener(E,true);}var F=this._createMessage("subscribe",E);this._IO_Jsonp_Send(F);},_unsubscribe:function(E){if(!this.getClientId()){return;}if(E&&E.channel){this.removeListeners(E.channel);}if(E&&E.channel){var F=this._createMessage("unsubscribe",E);this._Queue_send(F);}},_disconnect:function(F){var G=this;if(F){G._ioQueue_c2s.stop();G._ioQueue_s2c.stop();}G.setClientState("unconnected");G._clientId=null;G._resetBackoff();G._queue.stop();if(G._outgoing.length>0){var E=G._outgoing;G._outgoing=[];G._handleFailure(E,"500::canceled after disconnect");}G._clearSubscriptions();},_patchMessage:function(E){if(!E.id){E.id=this._nextMessageId();}E.clientId=this.getClientId();if(E.channel==="/meta/handshake"){delete E.clientId;}return E;},_batch:function(){D.each(arguments,function(E){if(E&&D.Lang.isArray(E)){var F=0;for(F=0;F<E.length;++F){this._outgoing.push(E[F]);}}else{if(E){this._outgoing.push(E);}}},this);},_clearSubscriptions:function(){D.each(this._listeners,function(E){if(E){D.each(E,function(G,F,H){if(G&&G.isSub){H.splice(F);}});}});this._subscribeChannel={};},_reDoSubscriptions:function(){D.each(this._subscribeChannel,function(E,F){if(E){this._subscribeChannel[F]=false;this._subscribeJSONP({channel:F});}},this);},isDuplicatedListener:function(E,G){var F=0;for(F=0;F<G.length;++F){var H=G[F];if(H&&H.listener&&H.listener.toString()===E.toString()){return true;}}return false;},_addListener:function(E,F,G){if(E&&E.listener&&D.Lang.isFunction(E.listener)){if(this._listeners[E.channel]){if(G||!this.isDuplicatedListener(E.listener,this._listeners[E.channel])){this._listeners[E.channel].push({listener:E.listener,isSub:F});}}else{this._listeners[E.channel]=[{listener:E.listener,isSub:F}];}}},_mixin:function(K,I,L){var G,H;var M=I||{};for(G=2;G<arguments.length;++G){var F=arguments[G];if(F===undefined||F===null){continue;}for(H in F){var E=F[H];var J=M[H];if(E===I){continue;}if(E===undefined){continue;}if(K&&typeof E==="object"&&E!==null){if(E instanceof Array){M[H]=this._mixin(K,J instanceof Array?J:[],E);}else{M[H]=this._mixin(K,{},E);}}else{M[H]=E;}}}return M;},destructor:function(){},getClientState:function(){return this._clientState;},setClientState:function(E){this._clientState=E;},getClientId:function(){return this._clientId;},initBayeux:function(E,F){this._urlOrigin=E;this.set("uri",E);this._handshake({channel:"/meta/handshake",listener:F});},subscribe:function(E,F){this._subscribeJSONP({channel:E,listener:F});},unsubscribe:function(E){this._unsubscribe({channel:E});},disconnect:function(G){var F=this;if(G){F._addListener({channel:"/meta/disconnect",listener:G},false);}if(F.getClientState()==="unconnected"){return;}if(!F.getClientId()){return;}var E=F._createMessage("disconnect");F._Queue_send(E);},publishMsg:function(F,H){if(F&&H){var E={channel:F,data:H};var G=this._createMessage("publish",E);this._Queue_send(G);}},clearListeners:function(){this._listeners={};},addListener:function(E,G,F){F=F||false;if(!G&&D.Lang.isFunction(G)){return;}this._addListener({channel:E,listener:G},false,F);},removeListeners:function(E){if(this._listeners[E]){delete this._listeners[E];}},setUserInfo:function(F,E){if(F&&E){var G=this.get("ext");G.subscribe["Comet-subscriber-auth-info"]={"uid":F,"user_type":"yahoo","user_cred":E};}},setUserInfoWithCookie:function(F,E){if(F){var G=this.get("ext");G.subscribe["Comet-subscriber-auth-info"]={"uid":F,"user_type":"yahoo","user_cred":"Any Value"};}},setTokenHeader:function(E){if(E){var F=this.get("ioCfg");F["headers"]["Authorization"]="Basic token="+E;}},resetTokenHeader:function(){var E=this.get("ioCfg");E["headers"]["Authorization"]="Basic token=";},setYcaHeader:function(E,F){if(E){var H=this.get("ioCfg");H["headers"]["Yahoo-App-Auth"]=E;}if(F){var G=this.get("ext");G.publish["Comet-opaque-id"]=F;}}});D.Comet=B;},"3.4.1",{requires:["base","io","json","async-queue","cookie","jsonp","jsonp-url"]});
YUI.add("mail-ui-shopping-utils",function(e){e.namespace("mail.ui.Shopping");var t={};e.mix(t,{normalizeProductName:function(t){var n=e.common.Utils.settings.value("shoppingStrings")||[],r=t;return e.Array.each(n,function(e){var t="\\b"+e.join("\\b|\\b")+"\\b";r=r.replace(new RegExp(t,"ig"),"")}),r.replace(new RegExp(":","i")," "),r=r.replace(/[(\[{].*?[)\]}]/g,""),r=r.replace(/\S*[^a-z\-\s]\S*/ig,""),r=r.replace(/(?![a-z])-(?![a-z])/ig,""),r=r.replace(/\s+/g," "),r=r.replace(/^\s+|\s+$/g,""),r},getColo:function(){var e=NeoConfig.hostName||"",t=NeoConfig.mailEnv==="dev"?/.corp\.([^\.]+)\.yahoo.com$/i:/.mail\.([^\.]+)\.yahoo.com$/i,n="",r;return r=e.match(t),r&&r[1]&&(n=r[1]),n},getGender:function(){var e="n";switch(parseInt(NeoConfig.comscoreGender,10)){case 0:e="f";break;case 1:e="m"}return e},flattenArray:function(e){var t=[];return t=t.concat.apply(t,e),e=t,e},shuffleArray:function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[n],e[n]=r}return e}}),e.mail.ui.Shopping.Utils=t},"1.0.0",{requires:[]});
YUI.add("mail-ui-shopping-model",function(e){var t;t=function(){function o(){var t=this,n=[],i,s,o,a,f=5,l=4,c=NeoConfig.purchasedItems||[],h=e.common.Utils.settings.settings;r.AdsModel.predictCount=0,c=c.slice(0,f),c.forEach(function(e,r){s="/neo/sherpa?item="+e+"&sampleId="+NeoConfig.expBucketId,n[r]=t.getXHRPromise(s)}),r.AdsModel.affAdDoneTimer=e.later(1e4,t,function(){e.fire("util:ymstats",{name:"shopping_aff_event_not_fired",tags:{bkt:NeoConfig.expBucketId}})},[],!1),n.forEach(function(n,f){n.then(function(e){try{a=JSON.parse(e),a.forEach(function(e,n){if(n>l)return;o=h.predictedItemEndPoint?h.predictedItemEndPoint:"/neo/shopping",o+="?item="+e+"&sampleId="+NeoConfig.expBucketId,r.AdsModel.predictCount++,i=t.getXHRPromise(o),u(i)})}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-shoppingads-shoppingAdsModel:1",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-shoppingads-shoppingAdsModel:1")}},function(t){e.fire("MailLog",{m:"storm_jsexception_shoppingads",bkt:NeoConfig.expBucketId,brwsr:NeoConfig.browser,err:t.message,url:s},1,"JSException")})})}function u(t){var n=this,s,o;o=i.getColo(),NeoConfig.shoppingAds=[],t.then(function(t){try{r.AdsModel.predictCount--,s=JSON.parse(t),s.length?NeoConfig.shoppingAds.push(s):e.fire("util:ymstats",{name:"shopping_predicted_offers_empty",tags:{bkt:NeoConfig.expBucketId,colo:o}}),r.AdsModel.predictCount===0&&e.fire("affAd:done")}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-shoppingads-shoppingAdsModel:2",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-shoppingads-shoppingAdsModel:2")}},function(t){r.AdsModel.predictCount--,e.fire("MailLog",{m:"storm_jsexception_shoppingads",bkt:NeoConfig.expBucketId,brwsr:NeoConfig.browser,err:t.message},1,"JSException"),r.AdsModel.predictCount===0&&e.fire("affAd:done")})}function a(){var t=this,n=s.settings.value("topItemEndPoint")+NeoConfig.expBucketId,r,i;r=t.getXHRPromise(n),r.then(function(e){try{i=JSON.parse(e),i.length&&(NeoConfig.shoppingAds=i)}catch(t){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-shoppingads-shoppingAdsModel:3",t,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-shoppingads-shoppingAdsModel:3")}},function(t){e.fire("MailLog",{m:"storm_jsexception_shoppingads",bkt:NeoConfig.expBucketId,brwsr:NeoConfig.browser,err:t.message},1,"JSException")})}function f(t){var n=s.settings.value("affTimeout")*1e3;return new Promise(function(r,i){e.io(t,{on:{success:function(e,t){r(t.responseText)},failure:function(n,r){var s=t&&t.match("^/neo/[a-zA-z]*");s=s&&s[0]&&s[0].substr(5),e.fire("util:ymstats",{name:"shopping_request_failed",tags:{endpoint:s,status:r.status,statusText:r.statusText,responseText:r.responseText}}),i(Error(r.statusText))}},timeout:n})})}var n,r=e.mail.ui.Shopping,i=e.mail.ui.Shopping.Utils,s=e.common.Utils;e.mix(this,{getXHRPromise:f,getAffiliateAds:o,makeShoppingCalls:u,getTopItems:a}),e.augment(t,e.EventTarget)},e.namespace("mail.ui.Shopping").AdsModel=new t},"1.0.0",{requires:["mail-ui-shopping-utils","common-utils","event-base"]});
YUI.add("shopping-ads-ult",function(e){e.mix(e.common.Utils.RapidCM,{affiliate_ad:["msgLst","inbxTb","msgLst","aflAd"],affiliate_ad_left:["msgLst","inbxTb","msgLst","aflAdLft"],affiliate_ad_center:["msgLst","inbxTb","msgLst","aflAdMid"],affiliate_ad_right:["msgLst","inbxTb","msgLst","aflAdRt"],rr_affiliate_ad_MON:["msgLst","inbxTb","msgLst","aflAdRrM"],rr_affiliate_ad_SKY:["msgLst","inbxTb","msgLst","aflAdRrS"],rr_affiliate_ad_LREC:["msgLst","inbxTb","msgLst","aflAdRrL"]}),e.mix(e.common.Utils.RapidVM,{shopping_ad_one_item:["affiliate_ad"],shopping_ad_three_items:["affiliate_ad_left","affiliate_ad_center","affiliate_ad_right"],rr_affiliate_ad_MON:["rr_affiliate_ad_MON"],rr_affiliate_ad_SKY:["rr_affiliate_ad_SKY"],rr_affiliate_ad_LREC:["rr_affiliate_ad_LREC"]})},"1.0.0",{requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap"]});
YUI.add("mail-ui-shopping-view",function(e){var t=e.common.Utils,n=function(){};n.extend=function(t){var r=function(){};return e.extend(r,this,t),r.extend=n.extend,r},n.prototype={init:function(){this.shoppingAds=[],this.evts=[],this.timers=[],this.adListIdx=0,this.AdsUtils=e.mail.ui.Shopping.Utils,this.refreshTime=t.settings.value("ad_refresh_time"),this.shoppingModel=e.mail.ui.Shopping.AdsModel,this.bindEventHandlers(),t.features.enabled("predictedAdsShopping")&&this.shoppingModel.getAffiliateAds()},bindClickHandlers:function(){if(!this.container)return;this.clickHandler&&this.clickHandler.detach("click"),this.clickHandler=this.container.delegate("click",this.handleAdClicks,this.elClass,this)},handleAdClicks:function(t){var n,r=t.currentTarget,i=!1,s=(new Date).getHours(),o=e.mail.ui.Shopping.Utils.getGender();for(var u=0;u<this.adChoicesClasses.length;u++)r.hasClass(this.adChoicesClasses[u])&&(i=!0);i?(t.halt(!0),window.open(strings.str_cfg_url_about_adchoices,"_blank")):this.fireClickStat(t)},render:function(){var t="",n,r;t=this.getAdHtml(),this.container=this.getContainer(),this.container.setHTML(t),r=this.rootNodeSelector&&e.one(this.rootNodeSelector),this.insertNode(r),this.applyStyle(r)},getAdList:function(e){var n=[],r;for(var i=0;i<e&&this.adListIdx<this.shoppingAds.length;)r=this.shoppingAds[this.adListIdx],r&&r.clickUrl&&r.displayTitle&&r.seller&&(r.image||r.images&&r.images.length)?(!r.image&&r.images&&r.images.length&&(r.image=r.images[0]),n.push(r),this.adListIdx=NeoGV.mbToggle?++this.adListIdx:++this.adListIdx%this.shoppingAds.length,i++):(this.shoppingAds.splice(this.adListIdx,1),this.adListIdx=NeoGV.mbToggle?this.adListIdx:this.adListIdx%this.shoppingAds.length),t.features.enabled("mbBackfill")&&this.adListIdx===this.shoppingAds.length&&(NeoGV.mbToggle=!1);return n},getRatingTmpl:function(e){var n=(Math.round(e.sellerRating*2)/2).toFixed(1),r;if(n>3){switch(n){case"3.5":e.fourthstar="half",e.fifthstar="off";break;case"4":e.fifthstar="off";break;case"4.5":e.fifthstar="half";break;default:}r=t.substitute(this.template.avgRating,e),e.avgRating=r}else e.avgRating="";return e},applyStyle:function(e){},fireRapidStat:function(t,n,r){e.fire(t,{action:n,append:r})}},e.namespace("mail.ui.Shopping"),e.mail.ui.Shopping.affView=n},"1.0.0",{requires:["io","common-utils","mail-ui-shopping-model","shopping-ads-ult","comms-utils","mail-ui-shopping-utils"]});
YUI.add("minty_module_shoppingads_rr_img_three_items",function(e){e.namespace("ui.Templates"),e.ui.Templates.minty_module_shoppingads_rr_img_three_items={base:'<div id="aff_{{rrAdPosition}}"> <div class="affiliate-ad right-rail-affiliate-ad {{shoppingBucket}}"> <div class="rr-header"> <div class="rr-sponsored rr-ad-item-click">{{shopping_sponsored_text}}</div> <div class="rr-mb-right rr-ad-item-click"> <i class="icon mb-icon adchoices mb-sponsored mb-logo-left shopping-mb-icon"></i> </div> </div> {{item}} </div></div>',maxPriceDiff:'<div class="rr-ad-item-price">{{minPrice}}&nbsp;-&nbsp;{{maxPrice}}</div> ',maxPriceDiff_else:'<div class="rr-ad-item-price">{{maxPrice}}</div> ',avgRating:'<div class="rating"> <div class="rating-star"> <div class="rating-star-yellow"></div><div class="rating-star-icon"><span class="icon icon-star"></span></div> </div> <div class="rating-star"> <div class="rating-star-yellow"></div><div class="rating-star-icon"><span class="icon icon-star"></span></div> </div> <div class="rating-star"> <div class="rating-star-yellow"></div><div class="rating-star-icon"><span class="icon icon-star"></span></div> </div> <div class="rating-star {{fourthstar}}"> <div class="rating-star-yellow"></div><div class="rating-star-icon"><span class="icon icon-star"></span></div> </div> <div class="rating-star {{fifthstar}}"> <div class="rating-star-yellow"></div><div class="rating-star-icon"><span class="icon icon-star"></span></div> </div> </div> ',item:'<div class="rr-ad-item"> <div class="rr-ad-item-body"> <a class="rr-ad-item-click" target="_blank" href="{{clickUrl}}" data-click-url="{{clickUrl}}" data-min-price="{{minPrice}}" data-seller-rating="{{sellerRating}}" data-category="{{catId}}" data-title="{{title}}" data-cpc="{{cpc}}" data-adpos="{{adpos}}" data-istop="{{isTop}}" data-item-name="{{itemName}}"i data-product-id="{{productId}}" data-seller="{{seller}}" data-product-yid="{{uniqueId}}"> <div> <img class="rr-ad-item-image" src="{{image}}" border="0"> </div> <div class="rr-ad-item-content"> <div class="rr-ad-item-title" title="{{title}}">{{title}}</div> {{maxPriceDiff}} {{maxPriceDiff_else}} <div class="rr-ad-item-seller" title="{{seller}}">{{seller}}</div> {{avgRating}} </div> </a> </div> </div> '}},"1.0.0");
YUI.add("mail-ui-shopping-rr-view",function(e){var t,n=e.common.Utils,r=n.settings.value("aff_min_num_ads")||3;e.mail.ui.Shopping.RRView=e.mail.ui.Shopping.affView.extend({template:e.ui.Templates.minty_module_shoppingads_rr_img_three_items,rootNodeSelector:"#theAd",elClass:".rr-ad-item-click",containerId:"slot_affRightRail",adChoicesClasses:["rr-sponsored","rr-mb-right","rr-mb-left"],affDarlaEvent:"",bindEventHandlers:function(){n.features.enabled("predictedAdsShopping")?e.on("affAd:done",function(){this.shoppingAds=this.AdsUtils.flattenArray(NeoConfig.shoppingAds),this.shoppingAds=this.AdsUtils.shuffleArray(this.shoppingAds)},this):this.shoppingAds=this.AdsUtils.flattenArray(NeoConfig.AffiliateFallback),e.on("darla:blankAdLoaded:affiliate",this.onDarlaEvent,this)},onDarlaEvent:function(e,t){this.affDarlaEvent=e,this.adPosition=t.rightRailAdPos,this.render(),this.bindClickHandlers()},fireClickStat:function(t){var n=e.mail.ui.Shopping.RRView.adPosition,r=t.currentTarget,i="rr_affiliate_ad_"+n,s="rr_affiliate_ad_clicked_"+n,o=(new Date).getHours(),u=e.mail.ui.Shopping.Utils.getGender(),a=r.getData("adpos").charAt(0),f={};f["mClkUrl"+a]=r.getData("click-url"),f["mnPrice"+a]=r.getData("min-price"),f["mxPrice"+a]=r.getData("max-price"),f["mCatId"+a]=r.getData("category"),f["mTitle"+a]=r.getData("title"),f["mSellr"+a]=r.getData("seller"),f["mCpc"+a]=r.getData("cpc"),f["mIsTop"+a]=r.getData("istop"),f["mUsrHr"+a]=o,f["mBkt"+a]=NeoConfig.expBucketId,f["mGender"+a]=u,f["mProdId"+a]=r.getData("product-id"),f["mYId"+a]=r.getData("product-yid"),f["mItem"+a]=r.getData("item-name"),f["mThm"+a]=NeoConfig.theme.id,this.fireRapidStat("mt:click",i,f),e.fire("util:ymstats",{name:s,tags:{pos:n,uh:o,bkt:NeoConfig.expBucketId,thm:NeoConfig.theme.id}})},getAdHtml:function(){var t,i,s,o,u=3,a={},f=this.getAdList(u),l=(new Date).getHours(),c="rr_affiliate_ad_"+this.adPosition,h="rr_affiliate_ad_viewed_"+this.adPosition,p="";if(f&&f.length!==u||this.shoppingAds.length<r)return e.fire(this.darlaAPI.blankAdLoadedDefaultEvent,this.affDarlaEvent,{rightRailAdPos:this.adPosition}),this.clean(),p;for(var d=0;d<f.length;d++){switch(d){case 0:f[d].adpos="Top";break;case 1:f[d].adpos="Middle";break;case 2:f[d].adpos="Bottom"}o=f[d].adpos.charAt(0),f[d]=this.getRatingTmpl(f[d]),f[d]=this.applyBucketLogic(f[d]),p+=n.substitute(this.template.item,f[d]),a["mnPrice"+o]=f[d].minPrice,a["mxPrice"+o]=f[d].maxPrice,a["mCatId"+o]=f[d].catId,a["mTitle"+o]=f[d].displayTitle,a["mSellr"+o]=f[d].seller,a["mCpc"+o]=f[d].cpc,a["mUsrHr"+o]=l,a["mBkt"+o]=NeoConfig.expBucketId,a["mGender"+o]=this.AdsUtils.getGender(),a["mProdId"+o]=f[d].productId,a["mYId"+o]=f[d].uniqueId,a["mItem"+o]=f[d].itemName,a["mThm"+o]=NeoConfig.theme.id}return this.fireRapidStat("mt:view",c,a),e.fire("util:ymstats",{name:h,tags:{uh:l,bkt:NeoConfig.expBucketId,thm:NeoConfig.theme.id}}),p=n.substitute(this.template.base,{item:p,shopping_sponsored_text:"Sponsored",rrAdPosition:this.adPosition}),p},getContainer:function(){var t;return t=e.one("#"+this.containerId),t||(t=e.Node.create('<div id="'+this.containerId+'">')),t},applyBucketLogic:function(e){return e.minPrice!==e.maxPrice?e.maxPriceDiff=n.substitute(this.template.maxPriceDiff,e):e.maxPriceDiff_else=n.substitute(this.template.maxPriceDiff_else,e),e},insertNode:function(e){e&&(e.all(".ch_mod").addClass("hidden"),e.append(this.container))},clean:function(){var t=e.one("#"+this.containerId);t&&t.get("parentNode").removeChild(t)}}),e.namespace("mail.ui.Shopping")},"1.0.0",{requires:["io","common-utils","mail-ui-shopping-view","mail-ui-shopping-model","shopping-ads-ult","minty_module_shoppingads_rr_img_three_items","comms-utils","mail-ui-shopping-utils"]});
YUI.add("mail-ui-shopping-rr-controller",function(e){var t,n=e.mail.ui.Shopping;t=function(){function t(t){this.yutils=e.common.Utils,NeoConfig.hasAds&&(this.view=new n.RRView,this.view.init(),this.view.darlaAPI=t,e.on(["adReturned:LREC","adReturned:MON","adReturned:SKY","showTrendingModule"],function(){this.view.clean()},this))}e.mix(this,{init:t})},e.namespace("mail.ui.Shopping"),e.mail.ui.Shopping.RRController=new t},"1.0.0",{requires:["io","mail-ui-shopping-model","mail-ui-shopping-view","mail-ui-shopping-rr-view"]});
YUI.add("mail-ui-rr-backfill-controller",function(e){var t;t=function(){function a(){e.on("darlaEvent:change",function(e){u=e},this),window.postMessage&&(window.addEventListener?window.addEventListener("message",f,!1):window.attachEvent("onmessage",f)),t.features.enabled("sidekick")&&e.use("mail-ui-sidekick-controller",function(e){e.mail.ui.sidekickController.init({blankAdLoadedDefaultEvent:n})}),(t.features.enabled("trending")||t.features.enabled("newsFeedTab"))&&e.use("mail-ui-trending-controller",function(e){e.mail.ui.trendingController.init({blankAdLoadedDefaultEvent:n,adPosition:o})}),t.features.enabled("affRightRail")&&e.use("mail-ui-shopping-rr-controller",function(e){e.mail.ui.Shopping.RRController.init({blankAdLoadedDefaultEvent:n,adPosition:o})})}function f(e){var t;e=e||window.event;if(e&&e.data)switch(e.data){case"rmx:no-ad-tl1":l("darla:blankAdLoaded:TL1");break;case"rmx:no-ad-mbrightrail":NeoGV&&NeoGV.ads&&NeoGV.ads[t]&&NeoGV.ads[t].bookId&&c({name:"rmx_noad_mbrightrail",tags:{bookingId:NeoGV.ads[t].bookId}});case"rmx:no-ad":l(i),c({name:"righrail_backfill_total",tags:{event:i,bkt:NeoConfig.expBucketId}});break;case"rmx:no-ad-mbbackfill":l("darla:blankAdLoaded"),c({name:"righrail_moneyball_backfill_total",tags:{bkt:NeoConfig.expBucketId}});break;case"rmx:no-ad-trendingnow":l("darla:blankAdLoaded:trending"),c({name:"righrail_trending_backfill_total",tags:{bkt:NeoConfig.expBucketId}});break;case"rmx:no-ad-sidekick":l("darla:blankAdLoaded:sidekick"),c({name:"righrail_sidekick_backfill_total",tags:{bkt:NeoConfig.expBucketId}});break;case"rmx:no-ad-aff-rightrail":l("darla:blankAdLoaded:affiliate")}}function l(t){var n;if(!t&&!s&&!s.getEligibleRightRailAdPos)return;n=s.getEligibleRightRailAdPos(),e.fire(t,u,{rightRailAdPos:n})}function c(t){if(!t)return;var n=t.name||"",r=t.tags||{};e.fire("util.ymstats",{name:n,tags:r})}var t=e.common.Utils,n="darla:blankAdLoaded",r=t.features.enabled("trending")?"darla:blankAdLoaded:trending":n,i=t.features.enabled("sidekick")?"darla:blankAdLoaded:sidekick":r,s=e.mail.ui.darla,o=s.getEligibleRightRailAdPos(),u={};e.mix(this,{init:a,messageReceived:f})},e.namespace("mail.ui"),e.mail.ui.RRBackfillController=new t,e.mail.ui.RRBackfillController.init()},"1.0.0",{requires:["mail-ui-darla","mail-ui-shopping-rr-controller"]});
YUI.add("mail-ui-backbutton",function(C){var I,G=C.common.Utils,B=C.mail.Tabs,H=C.Node.one("#theAd"),E,F=0,D=0,A={};I=function(){function K(){var N,P,O=C.mail.FoldersView;window.onhashchange=function(S){if(typeof S.newURL==="string"){if((S.newURL.indexOf("#")>0&&S.oldURL.indexOf("#")>0)||(S.newURL.slice(-1)==="#")){return false;}}N=B.tabs;if(N[0].NAME.indexOf("INBOX")!==-1&&O.get("fid").fid==="Inbox"){B.switchToTab(B.tabs[0]);window.history.state&&window.history.go(-1);}else{if(N[N.length-2].widgetType==="search"&&NeoConfig.backButtonSearch){var Q=B.getActiveTab();Q.set("close",1);}else{var R={fid:"Inbox",forceRefresh:"",name:"Inbox",mailboxId:"Inbox",smartFolder:""};O.set("fid",R);C.fire("navigation:switch","none");}}if(typeof window.history.pushState==="function"&&typeof window.history.state!=="undefined"){if(window.history.state!==null){window.history.state.id=0;}}return false;};}function L(){var N=C.mail.Tabs,P,O=C.mail.FoldersView;window.onclick=function(Q){if(Q.button!==2&&Q.target.getAttribute("href")==="#"){Q.preventDefault();}};window.onhashchange=function(Q){if(typeof Q.newURL==="string"){if((Q.newURL.indexOf("#")>0&&Q.oldURL.indexOf("#")>0)||(Q.newURL.slice(-1)==="#")){return false;}}};window.onpopstate=function(){if(window.location.href.slice(-1)==="#"){return false;}P=A[window.location.hash.slice(1)];if(!P&&window.location.hash.length){return;}if(!P){N.switchToTab(N.tabs[0]);return false;}if(typeof P==="object"){var Q={fid:P.fid.fid,bb:true};O.set("fid",Q);}else{N.switchToTab(N.tabs[P||0],0,0,0,0,1);}C.fire("util:ymstats",{"name":"browsernav","tags":{"type":"switch"}});return false;};}function J(P){var O=false;C.fire("util:ymstats",{"name":"browsernav","tags":{"type":"init"}});if(!NeoConfig.backButtonFull){if(NeoConfig.backButton&&(typeof window.history.pushState==="function")){if(!window.history.state||!window.history.state.id){window.history.pushState({id:"1"},document.title,window.location.pathname+window.location.search);}if(!window.location.hash.length){window.history.replaceState({id:"1"},document.title,"#mail");}}return;}E=Math.ceil(Math.random()*Math.pow(10,10));var N;window.history.pushState({id:E},document.title,"#"+E);N=P?P.id:B.getActiveTab().cfg.label;switch(N){case"Contacts":A[E]=1;O=true;break;case"Calendar":A[E]=2;O=true;break;case"Notepad":A[E]=3;O=true;break;default:if(P.fid&&P.fid.length>1){A[E]={};A[E].tab=0;A[E].fid=P;}else{A[E]=B.getActiveTabIndex();}O=true;break;}F++;return O;}function M(){var N=window.location.hash.slice(1);if(A[N]){delete A[N];}}if(NeoConfig.backButtonFull){L();}else{if(NeoConfig.backButton){K();}}C.on("initPage",J);C.on("removePage",M);C.mix(this,{initPage:J,removePage:M});};C.namespace("mail.ui").BackButton=new I();},"1.0.0",{});YUI.add("mail-common-precache-thread",function(E){E.namespace("mail.ui");var A=E.mail,B=A.ui.ConvList,D=A.model.ConvStore.Conversations,C="unreadConv";NeoConfig.preCacheAlgorithm=C;B.getNeighbors=function(R,N,T,H,M){if(!(R&&R.length&&N>=-1&&N<=R.length-1&&NeoConfig.hasConvView)){return;}var P=M,F=[],L=[],S=[],O=1,I=0,G=0,K=M||2,J=1;function Q(U){var V;if((V=R[U])&&!D.isCached(H,V.cid)){if(V&&V.totalUnread>0){F.push(V);}else{L.push(V);}return 1;}return 0;}while(O){if(G<K&&!Q(N-J)){G++;}if(I<K&&!Q(N+J)){I++;}O=((F.length+L.length)<P)&&!(G===K&&I===K);J++;if(J>100){break;}}S=F.concat(L);S=S.splice(0,S.length>=P?P:S.length);for(J=0;J<S.length;J++){T.push(S[J]);}};},"1.0.0",{requires:["mail-ui-convlist-base"]});