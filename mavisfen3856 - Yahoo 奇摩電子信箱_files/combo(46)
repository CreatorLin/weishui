YUI.add("mail-controller-contact-processor",function(e){function o(){}var t=e.contacts,n=t.config,r=t.api,i=t.utils,s=e.common.persist.UserData;e.mix(o.prototype,{addContacts:function(t){var i=[],s,o,u=function(){},a,f;try{s=this.getUnknownAddresses(t),s.length>0&&(o={guid:NeoConfig.neoguid,requestFn:e.common.net.SessionMgr.requestProxy,wspath:NeoConfig.socdirProxyPath,success:u,failure:u},n.setAttrs(o),e.Array.each(s,function(t){a=e.Lang.trim(t.name),f=t.email,e.Lang.isObject(a)&&(a=a.name),a!=""&&a!=undefined&&f?i.push({fields:[{type:"name",value:{givenName:a}},{type:"email",value:f}]}):f&&i.push({fields:[{type:"email",value:f}]})}),r.saveContacts(i))}catch(l){}},getUnknownAddresses:function(t){var n=[],r,o,u,a=[t.to,t.cc,t.bcc],f=[],l,c=function(e){f.push(e)};for(r=0,u=a.length;r<u;r++)e.Array.each(a[r],c);for(o=0,u=f.length;o<u;o++){l=(i.getContactsByEmail(f[o].email)||[])[0];if(l&&l.id>=0||s.isUsersEmailAddress(f[o].email))continue;n.push(f[o])}return n}}),e.namespace("mail.Controller").ContactProcessor=new o},"1.0.0",{requires:["mail-models-draft","comms-utils","common-persist-user-data","contacts-api-utils","common-net-sessionmgr","contacts-api","contacts-api-config"]});
